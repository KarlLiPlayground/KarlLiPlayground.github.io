var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(r,n){function _(t){try{a(o.next(t))}catch(e){n(e)}}function s(t){try{a(o["throw"](t))}catch(e){n(e)}}function a(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(_,s)}a((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return o([t,e])}}function o(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(_=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(_=_.call(n,i[1])).done)return _;switch(n=0,_&&(i=[0,_.value]),i[0]){case 0:case 1:_=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(_=a.trys,!(_=_.length>0&&_[_.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!_||i[1]>_[0]&&i[1]<_[3])){a.label=i[1];break}if(6===i[0]&&a.label<_[1]){a.label=_[1],_=i;break}if(_&&a.label<_[2]){a.label=_[2],a.ops.push(i);break}_[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(o){i=[6,o],n=0}finally{r=_=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,n,_,s,a={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},ns_sirius;!function(t){var e=function(){function t(){this._is_destroyed=!1}return t.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},t.prototype._before_destroy=function(){},t}();t.sirius_base_object=e,__reflect(e.prototype,"ns_sirius.sirius_base_object",["ns_sirius.Isirius_base_object"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e.mark_as_fullfill(),console.log("[ "+e.constructor.name+" ] ALLOC"),e}return __extends(e,t),e.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},e.prototype._before_destroy=function(){console.log("[ "+this.constructor.name+" ] destroy"),this._view_before_destroy(),this.remove_all_children(),this.remove_from_parent(),this.init_param=null,this.pair_vm=null},e.prototype.view_pre_init=function(t,e,i){this.init_param=t,this.pair_vm=e,this._sirius=i.sirius_public,this._view_before_init()},e.prototype.view_init=function(){this._view_start_init()},e.prototype.attached_to_display_tree=function(t){},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e.prototype.remove_all_children=function(){this.removeChildren()},e.prototype.remove_from_parent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.update_visible=function(t){this.visible=t},e.prototype.mark_as_fullfill=function(){this.percentWidth=100,this.percentHeight=100,this.x=0,this.y=0},e.prototype.set_bg_color=function(t,e){void 0===e&&(e=1);var i=new eui.Rect;return this.addChildAt(i,0),i.fillColor=t,i.percentWidth=100,i.percentHeight=100,i.alpha=e,i},e}(eui.Component);t.sirius_module_view=e,__reflect(e.prototype,"ns_sirius.sirius_module_view",["ns_sirius.Isirius_view_base","ns_sirius.Isirius_base_object"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return console.log("[ "+e.constructor.name+" ] ALLOC"),e.pair_view=null,e.init_param=null,e}return __extends(e,t),e.prototype._before_destroy=function(){console.log("[ "+this.constructor.name+" ] destroy"),this._vm_before_destroy(),this.init_param=null,this.pair_view=null},e.prototype.vm_pre_init=function(t,e,i){this.init_param=t,this.pair_view=e,this._sirius=i.sirius_public,this._vm_before_init()},e.prototype.vm_init=function(){this._vm_start_init()},e.prototype._vm_before_init=function(){},e.prototype._vm_start_init=function(){},e.prototype._vm_before_destroy=function(){},e}(t.sirius_base_object);t.module_vm_base=e,__reflect(e.prototype,"ns_sirius.module_vm_base")}(ns_sirius||(ns_sirius={}));var AppModuleViewBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.attached_to_display_tree=function(t){},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e}(ns_sirius.sirius_module_view);__reflect(AppModuleViewBase.prototype,"AppModuleViewBase");var AppModuleVMBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._vm_before_init=function(){},e.prototype._vm_start_init=function(){},e.prototype._vm_before_destroy=function(){},e}(ns_sirius.module_vm_base);__reflect(AppModuleVMBase.prototype,"AppModuleVMBase");var PopupVMBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(PopupVMBase.prototype,"PopupVMBase");var PopupViewBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.set_bg_color(0,.4),this._create_module_background()},e.prototype.static_title_name=function(){return"Base"},e.prototype._create_module_background=function(){var t=this,e=sirius.device_info.popup_width,i=sirius.device_info.popup_height,o=22,r=sirius.device_info.popup_con_width,n=sirius.device_info.popup_con_height,_=new eui.Group;_.width=e,_.height=i,_.top=.21*sirius.device_info.safe_height,_.horizontalCenter=0;var s=new eui.Label;s.width=e,s.height=o,s.textAlign=egret.HorizontalAlign.CENTER,s.verticalAlign=egret.VerticalAlign.MIDDLE,s.size=22,s.textColor=1513239,s.text=this.static_title_name(),this.containGroup=new eui.Group,this.containGroup.width=r,this.containGroup.height=n,this.containGroup.top=o,this.containGroup.horizontalCenter=0;var a=new eui.Image;a.width=e,a.height=.43*i,a.source="battleSettlement_panel_02";var l=new eui.Image;l.width=e,l.height=.25*i,l.bottom=.33*i,l.source="battleSettlement_panel_02";var c=new eui.Image;c.width=e,c.height=.34*i,c.bottom=0,c.source="battleSettlement_panel_03";var u=new eui.Image;u.width=.092*e,u.height=.065*i,u.right=0,u.top=-20,u.source="common_button_close",u.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("click close"),t.destroy()},this),_.addChildAt(s,1),_.addChildAt(a,0),_.addChildAt(l,0),_.addChildAt(c,0),_.addChildAt(u,4),_.addChildAt(this.containGroup,3),this.addChildAt(_,1)},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e}(AppModuleViewBase);__reflect(PopupViewBase.prototype,"PopupViewBase");var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._machine=null,e}return __extends(e,t),e.prototype._before_destroy=function(){this._machine=null},e.prototype.state_init=function(t,e){this._machine=t,this._convert_context(e),this._behaviors_init(),this._after_state_init()},e.prototype._convert_context=function(t){},e.prototype._behaviors_init=function(){},e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return 0},e.prototype.state_str=function(){return""},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e.prototype.state_update=function(){},e}(t.sirius_base_object);t.GP_StateBase=e,__reflect(e.prototype,"ns_sirius.GP_StateBase")}(ns_sirius||(ns_sirius={}));var GamePlayEntityBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._destroy_arr=function(t){if(t)for(var e=t.length,i=0;e>i;i++)t[i]&&t[i].destroy()},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(ns_sirius.sirius_base_object);__reflect(GamePlayEntityBase.prototype,"GamePlayEntityBase");var GC_Ele_BaseView=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e}return __extends(e,t),e.prototype._destroy_arr=function(t){if(t)for(var e=t.length,i=0;e>i;i++){var o=t[i];o.destroy()}},e.prototype.destroy=function(){this._before_destroy(),this.parent&&this.parent.removeChild(this),this._is_destroyed=!0},e.prototype._before_destroy=function(){},e.prototype.set_bg_color=function(t,e){void 0===e&&(e=1);var i=new eui.Rect;return this.addChildAt(i,0),i.fillColor=t,i.percentWidth=100,i.percentHeight=100,i.alpha=e,i},e.prototype.remove_from_parent=function(){this.parent&&this.parent.removeChild(this)},e}(eui.Group);__reflect(GC_Ele_BaseView.prototype,"GC_Ele_BaseView");var ConfigurationView=function(t){function e(){var e=t.call(this)||this;return e.layout_gap=-15,e.arr=[],e.addEventListener(eui.UIEvent.COMPLETE,e.onComplete,e),e.skinName="resource/ZL/skins/configuration/configuration.exml",e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),this.scroller.horizontalScrollBar.autoVisibility=!1,this.scroller.horizontalScrollBar.visible=!1,this._scroll_bounds=new egret.Rectangle,this._buffer_touch_pos=new egret.Point,setTimeout(function(){e.scroller.getBounds(e._scroll_bounds)},1e3),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this._touch_move,this),this.reset.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resetClick,this),this.save.addEventListener(egret.TouchEvent.TOUCH_TAP,this.saveClick,this),this.timer=new egret.Timer(300,0),this.setChildIndex(this.group_title,this.numChildren-1)},e.prototype.initList=function(t){var e=new eui.HorizontalLayout;e.gap=this.layout_gap,this.list.layout=e,this.EUIArr=new eui.ArrayCollection(t),t.length<=11?this.more.visible=!1:this.more.visible=!0,this.list.dataProvider=this.EUIArr,this.list.itemRenderer=ConfigurationListItem,this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTapHandler,this),this.list.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onListBegin,this),this.list.addEventListener(egret.Event.CHANGE,this.change,this)},e.prototype.change=function(){for(var t=0;t<this.arr.length;t++)this.arr[t].isSelected=t===this.list.selectedIndex;this.EUIArr.replaceAll(this.arr),this.list.dataProvider=this.EUIArr},e.prototype.onListBegin=function(){this.timer.reset(),this.timer.start()},e.prototype.onItemTapHandler=function(t){egret.log(t.item),egret.log(t.itemRenderer),egret.log(t.itemIndex),console.log(this.list.selectedIndex),this.timer.currentCount<2?this.itemClick(t):this.itemLongClick(t),this.timer.stop()},e.prototype._touch_move=function(t){console.log("=======_bottom_touch_move"),this.scroller.globalToLocal(t.stageX,t.stageY,this._buffer_touch_pos),this._scroll_bounds.containsPoint(this._buffer_touch_pos)?(this.scroller.scrollPolicyH=eui.ScrollPolicy.ON,t.stopPropagation()):this.scroller.scrollPolicyH=eui.ScrollPolicy.OFF},e.prototype.onClose=function(){sirius.view_manager.pop_top_module()},e.prototype.onComplete=function(){console.log("onComplete")},e.prototype._view_before_init=function(){console.log(this.init_param)},e.prototype._view_start_init=function(){},e.prototype.resetClick=function(){},e.prototype.saveClick=function(){},e.prototype.setTitleVisible=function(t){this.group_title.visible=t},e.prototype.setTitle=function(t){this.setChildIndex(this.group_title,this.numChildren-1),this.setTitleVisible(!0),this.label_title.text=t},e.prototype.setArr=function(t){this.arr=t,this.initList(this.arr)},e.prototype.itemClick=function(t){},e.prototype.itemLongClick=function(t){},e}(AppModuleViewBase);__reflect(ConfigurationView.prototype,"ConfigurationView");var Character_Behavior=function(t){function e(e,i){var o=t.call(this)||this;return o._character=e,o._s=i,o}return __extends(e,t),e.prototype._before_destroy=function(){this._character=null,this._s=null,t.prototype._before_destroy.call(this)},e}(GamePlayEntityBase);__reflect(Character_Behavior.prototype,"Character_Behavior");var CharacterStateBase=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._character=null,t.prototype._before_destroy.call(this)},e.prototype._convert_context=function(t){this._character=t},e.prototype.state_update=function(){this._syn_character_pos()},e.prototype._syn_character_pos=function(){this._syn_pos_with_room()},e.prototype._syn_pos_with_room=function(){var t=this._character.current_room();t.layout_info.get_slot_3dpos_by_slot(this._character.get_slot_pos(),this._character._buffer_new_pos_3d,this._character._buffer_new_pos_2d),this._character._sm_modify_pos(this._character._buffer_new_pos_3d,t.layout_info.d3_scale,this._character._buffer_new_pos_2d)},e}(ns_sirius.GP_StateBase);__reflect(CharacterStateBase.prototype,"CharacterStateBase");var GC_ProcessBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._localmd=function(){return this._weak_md},e.prototype.get_metadata=function(){return this._weak_md},e.prototype._before_destroy=function(){this._weak_md=null,this.clear_output(),this.output=null,this._binded_character=null,this._binded_skill=null},e.prototype.process_init=function(t,e,i){this._weak_md=i,this._binded_character=t,this._binded_skill=e,this.output=Object.create(null),this._init(i)},e.prototype._find_siblings=function(t){return this._binded_skill.find_process(t)},e.new_process=function(t){var e=t.type,i=null;switch(e){case GC_Process_Metadata.GC_ProcessType.dmg:i=new GC_Process_Dmg;break;case GC_Process_Metadata.GC_ProcessType.ik:i=new GC_Process_Instant_Kill;break;case GC_Process_Metadata.GC_ProcessType.heal:i=new GC_Process_Heal;break;case GC_Process_Metadata.GC_ProcessType.character_modify:break;case GC_Process_Metadata.GC_ProcessType.se_modify:break;case GC_Process_Metadata.GC_ProcessType.se_add:i=new GC_Process_SE_Add;break;case GC_Process_Metadata.GC_ProcessType.se_remove:i=new GC_Process_SE_Remove;break;case GC_Process_Metadata.GC_ProcessType.se_modify_quick:i=new GC_Process_SEMQ;break;case GC_Process_Metadata.GC_ProcessType.cd_modify:break;case GC_Process_Metadata.GC_ProcessType.cd_terminate:break;case GC_Process_Metadata.GC_ProcessType.cd_modify_quick:i=new GC_Process_CD_Modify_Self;break;case GC_Process_Metadata.GC_ProcessType.selector:i=new GC_Process_Selector;break;case GC_Process_Metadata.GC_ProcessType.probability:i=new GC_Process_Probability;break;case GC_Process_Metadata.GC_ProcessType.dmg_modifier:i=new GC_Process_DmgCoe}return i},e}(GamePlayEntityBase);__reflect(GC_ProcessBase.prototype,"GC_ProcessBase");var TableViewBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._create_table()},e.prototype.stactic_table_name=function(){var t=[];return t.push("One"),t.push("Two"),t.push("Three"),t.push("Four"),t},e.prototype._create_table=function(){var t=[];t=this.stactic_table_name();var e=t.length,i=this.containGroup.width,o=new eui.Group;o.width=i,o.height=22;var r=i/e,n=o.height;for(var _ in t)o.addChild(this._create_title_name(r,n,t[_],parseInt(_)*r,_));this.containGroup.addChild(o),this.tabContainGroup=new eui.Group,this.tabContainGroup.width=this.containGroup.width,this.tabContainGroup.height=this.containGroup.height-o.height,this.tabContainGroup.top=o.height,this.containGroup.addChild(this.tabContainGroup);var s=new eui.Label;s.width=this.tabContainGroup.width,s.height=this.tabContainGroup.height,s.background=!0,s.backgroundColor=16777215,console.log("====width"+this.tabContainGroup.width),console.log("====height"+this.tabContainGroup.height),this.tabContainGroup.addChild(s)},e.prototype.touchClick=function(t){},e.prototype._create_title_name=function(t,e,i,o,r){var n=this,_=new eui.Label;return _.width=t,_.height=e,_.left=o,_.textAlign=egret.HorizontalAlign.CENTER,_.verticalAlign=egret.VerticalAlign.MIDDLE,_.size=18,_.text=i,_.background=!0,_.backgroundColor=1513239,_.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.touchClick(r)},this),_},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e}(PopupViewBase);__reflect(TableViewBase.prototype,"TableViewBase");var TableVMBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(PopupVMBase);__reflect(TableVMBase.prototype,"TableVMBase");var GameActor=function(t){function e(){var i=t.call(this)||this;return i.actor_uid=0,i._is_dead=!1,e._actor_counter++,i.actor_uid=e._actor_counter,i}return __extends(e,t),e.prototype.is_dead=function(){return this._is_dead},e.prototype.sentence_to_death=function(){this._is_dead=!0},e.prototype.frame_update=function(){},e._actor_counter=0,e}(GamePlayEntityBase);__reflect(GameActor.prototype,"GameActor");var GC_SkillBase=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._localmd=function(){return this._weak_md},e.prototype.get_metadata=function(){return this._weak_md},e.prototype._before_destroy=function(){this._p_exec_sequence.destroy(),this._p_exec_sequence=null,this._weak_md=null,this._weak_self=null,this._weak_focus=null,t.prototype._before_destroy.call(this)},e.prototype.skill_init=function(t,e,i,o){return void 0===o&&(o=null),this.index=t,this.cached_skill_no=i.skill_no,this._weak_md=i,this._weak_self=e,o?this._weak_focus=o:this._weak_focus=e,this._init_parts(e,i),this._init(i),!0},e.prototype._init_parts=function(t,e){this._p_exec_sequence=new SkillPart_ExecSequence,this._p_exec_sequence.part_init(t,this,e)},e.prototype.find_process=function(t){return this._p_exec_sequence.find_process(t)},e}(GamePlayEntityBase);__reflect(GC_SkillBase.prototype,"GC_SkillBase");var ns_sirius;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._s_default=new t.GP_State_Default,i._current_state=new t.GP_State_Default,i._listener=null,i._ctx=null,i}return __extends(i,e),i.prototype._before_destroy=function(){this._ctx=null,this._listener=null,this._current_state=null,this._s_default.destroy(),this._s_default=null},i.prototype.get_current_state=function(){return this._current_state},i.prototype.get_current_state_str=function(){return this._current_state.state_str()},i.prototype.get_current_state_enum=function(){return this._current_state.state_enum()},i.prototype.machine_initialize=function(t,e,i){void 0===i&&(i=null),this._listener=t,this._ctx=e,this._s_default.state_init(this,e),this._states_init(e)},i.prototype._states_init=function(t){},i.prototype.get_state_by_enum=function(t){return null},i.prototype.state_change=function(t,e){void 0===e&&(e=null);var i=this.get_state_by_enum(t);i||console.log("invalid game machine enum "+t);var o=this._current_state;this._current_state=i,this._listener.sm_state_changed(o,i,e),o.state_leave(i,e),i.state_enter(o,e)},i.prototype.machine_update=function(){this._current_state.state_update()},i}(t.sirius_base_object);t.GP_StateMachine=e,__reflect(e.prototype,"ns_sirius.GP_StateMachine")}(ns_sirius||(ns_sirius={}));var SkillPart_Base=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(GamePlayEntityBase);__reflect(SkillPart_Base.prototype,"SkillPart_Base");var CharacterMachineState=function(){function t(){}return t.DEFAULT=0,t.BORN=1,t.MOVING=2,t.DYING=4,t.BATTLE_ASSAULTER=5,t.BATTLE_DEFENDER=6,t.ERROR=99,t}();__reflect(CharacterMachineState.prototype,"CharacterMachineState");var CharacterMachine=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._states_init=function(t){this._s_born=new Character_State_BORN,this._s_born.state_init(this,t),this._s_dying=new Character_State_DYING,this._s_dying.state_init(this,t),this._s_error=new Character_State_ERROR,this._s_error.state_init(this,t)},e.prototype.get_state_by_enum=function(t){switch(t){case CharacterMachineState.BORN:return this._s_born;case CharacterMachineState.DYING:return this._s_dying;case CharacterMachineState.ERROR:return this._s_error;default:return this._s_default}},e.prototype._before_destroy=function(){this._s_born.destroy(),this._s_born=null,this._s_dying.destroy(),this._s_dying=null,this._s_error.destroy(),this._s_error=null,t.prototype._before_destroy.call(this)},e}(ns_sirius.GP_StateMachine);__reflect(CharacterMachine.prototype,"CharacterMachine");var MonsterVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(MonsterVM.prototype,"MonsterVM");var TrapView=function(t){function e(){var e=t.call(this)||this;return e.arr_test=[{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1},{source:"Common_Icon_Block_01_png",isSelected:!1}],e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),this.setArr(this.arr_test),this.view_back.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.item_info&&(e.list.selectedIndex=-1,e.change(),e.removeChild(e.item_info),e.item_info=null),e.item_info2&&(e.removeChild(e.item_info2),e.item_info2=null),e.setTitleVisible(!1)},this)},e.prototype.showInfo=function(){this.item_info&&(this.removeChild(this.item_info),this.item_info=null),this.item_info=new TrapInfo,this.addChild(this.item_info),this.item_info.left=65,this.item_info.top=15,this.setTitle("请选择要布置的房间")},e.prototype.showInfo2=function(){var t=this;this.item_info&&(this.removeChild(this.item_info),this.item_info=null),this.item_info2&&(this.removeChild(this.item_info2),this.item_info2=null),this.item_info=new TrapInfo,this.addChild(this.item_info),this.item_info.left=65,this.item_info.top=15,this.item_info2=new TrapInfo,this.addChild(this.item_info2),this.item_info2.left=300,this.item_info2.top=15,this.item_info.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.setChildIndex(t.item_info,t.numChildren-2)},this),this.item_info2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.setChildIndex(t.item_info2,t.numChildren-2)},this),this.setTitle("请选择要替换或者强化的房间")},e.prototype._touch_move=function(e){t.prototype._touch_move.call(this,e),this.item_info&&e.stopPropagation()},e.prototype._view_before_init=function(){console.log(this.init_param)},e.prototype._view_start_init=function(){},e.prototype.resetClick=function(){},e.prototype.saveClick=function(){var t=this,e=new ConfirmDialog;e.setInfo("还有房间未布置，保存后未布置的房间将会消失，是否结束布置？"),e.setCallBack(function(){t.onClose()}),sirius.view_manager.show_alert(e)},e.prototype.itemClick=function(t){return console.log("====短按"),2===t.itemIndex?void this.showInfo2():void this.showInfo()},e.prototype.itemLongClick=function(t){console.log("====长按")},e}(ConfigurationView);__reflect(TrapView.prototype,"TrapView");var TrapVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(TrapVM.prototype,"TrapVM");var MWN_State_Base=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._gpcore=null,t.prototype._before_destroy.call(this)},e.prototype._convert_context=function(t){this._gpcore=t},e}(ns_sirius.GP_StateBase);__reflect(MWN_State_Base.prototype,"MWN_State_Base");var TestModuleVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._vm_before_init=function(){},e.prototype._vm_start_init=function(){},e.prototype._vm_before_destroy=function(){},e}(AppModuleVMBase);__reflect(TestModuleVM.prototype,"TestModuleVM");var GameWinView=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.onComplete,e),e.skinName="resource/YXY/game_skins/win/battle_Win_Skin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),console.log("createChildren"),this.win_group_bg_1.width=sirius.device_info.popup_width,this.win_group_head.width=.684*this.win_group_bg_1.width,this.win_group_name.width=.27*this.win_group_bg_1.width,this.win_group_center.width=this.win_group_bg_1.width,this.win_close.width=.092*this.win_group_bg_1.width,this.win_facility_label.text=appm.lm.s("gamewin","facility","YXY"),this.win_monster_label.text=appm.lm.s("gamewin","monster","YXY"),this.win_reward_label.text=appm.lm.s("gamewin","reward","YXY"),this.win_exp_label.text=appm.lm.s("gamewin","exp","YXY"),this.win_btn.labelDisplay.text=appm.lm.s("gamewin","jump","YXY"),this.win_processbar_facility.value=60,this.win_processbar_monster.value=50,this.EXPValue=2,this.win_processbar_exp.value=this.EXPValue,this.win_processbar_exp.label.text="80/100 (80%)";var i=new egret.Timer(500,1);i.addEventListener(egret.TimerEvent.TIMER,function(){e.win_processbar_exp.setPosition(e.win_processbar_exp.thumb.width,e.EXPValue),i.stop(),i=null},this),i.start(),this.win_icon1.common_icon_text.text="x 10",this.win_icon2.common_icon_text.text="x 2",this.win_icon3.common_icon_text.text="x 1",this.win_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.win_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},e.prototype.onClose=function(){sirius.view_manager.pop_top_module(),sirius.view_manager.show_popup_text_msg("你销毁了模块")},e.prototype.onComplete=function(){console.log("onComplete")},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e}(AppModuleViewBase);__reflect(GameWinView.prototype,"GameWinView");var GameCharacterType=function(){function t(){}return t.Default=0,t.Defender=1,t.Assaulter=2,t.Boss=999,t}();__reflect(GameCharacterType.prototype,"GameCharacterType");var GameCharacter=function(t){function e(){var e=t.call(this)||this;return e._buffer_new_pos_3d=new egret.Point,e._buffer_new_pos_2d=new egret.Point,e._current_pos_3d=new egret.Point,e._current_pos_2d=new egret.Point,e._current_scale_3d=new egret.Point,e._buffer_new_slot_pos=new MapRoomSlotPosition,e._buffer_new_slot_pos.type=GameCharacterType.Assaulter,e.md_battle=new Character_RPPS_Battle,e._room_pos=new MapRoomPosition,e._slot_pos=new MapRoomSlotPosition,e._events_init(),e._flying_parts=new ns_sirius.doubly_linked_list,e}return __extends(e,t),e.prototype.is_boss=function(){return!1},Object.defineProperty(e.prototype,"current_pos_3d",{get:function(){return this._current_pos_3d},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"current_pos_2d",{get:function(){return this._current_pos_2d},enumerable:!0,configurable:!0}),e.prototype._before_destroy=function(){this._is_dead=!0,this._flying_parts&&this._flying_parts.destroy(),this._destroy_arr(this._evts),this._evts=null,this._binded_view&&(this._binded_view.destroy(),this._binded_view=null),this._machine&&(this._machine.destroy(),this._machine=null),this.skillm_active.destroy(),this.skillm_active=null,this.skillm_passive.destroy(),this.skillm_passive=null,this.skillm_se.destroy(),this.skillm_se=null,this.md_battle.destroy(),this.md_battle=null,t.prototype._before_destroy.call(this)},e.prototype.get_room_pos=function(){return this._room_pos},e.prototype.get_slot_pos=function(){return this._slot_pos},e.prototype.current_room_uindex=function(){return this._room_pos?this._room_pos.unique_index:null},e.prototype.current_room=function(){return this._room_pos?gp_core.map.get_room_by_pos(this._room_pos):null},e.prototype.skill_hierarchy_establish=function(t){this.skillm_active=new ActiveSkillManager,this.skillm_active.manager_init(this,t),this.skillm_passive=new PassiveSkillManager,this.skillm_passive.manager_init(this,t),this.skillm_se=new SEManager,this.skillm_se.manager_init(this,t)},e.prototype.put_on_the_map_and_run=function(t,e){this._room_pos.copyp(t),this._slot_pos.copyp(e),this._machine_init(),this._set_machine_initial_state()},e.prototype.prepare_to_die=function(){this.distribute_event(GC_Skill_Metadata.Process_Trigger_Event.Dead),this._machine&&this._machine.state_change(CharacterMachineState.DYING)},e.prototype.heal=function(t){if(!(0>=t||this._is_dead)){this.md_battle.is_immortal||(this.md_battle.current_life+=t);var e=this.md_battle.current_life/this.md_battle.total_life;0>e&&(e=0),this._binded_view.update_health(e),this._binded_view.play_heal_anim(t),this.md_battle.current_life<=0&&this.prepare_to_die()}},e.prototype.instant_kill=function(){this._is_dead||this.prepare_to_die()},e.prototype.deduct_life=function(t,e,i){if(!(0>=t||this._is_dead)){this.md_battle.is_immortal||(this.md_battle.current_life-=t);var o=this.md_battle.current_life/this.md_battle.total_life;0>o&&(o=0),this._binded_view.update_health(o),this._binded_view.play_dmg_anim(t,e),this.md_battle.current_life<=0?this.prepare_to_die():i&&this._binded_view.start_vibration_anim()}},e.prototype.dodge_attack=function(){this._binded_view.play_dodge()},e.prototype.get_battle_behavior=function(){return this._machine?this._machine.get_battle_behavior():null},e.prototype.get_facing_enemy=function(){if(this._machine){var t=this._machine.get_battle_behavior();if(t)return t.get_target_character()}},e.prototype.active_battle_behavior=function(t){if(this._machine){var e=this._machine.get_battle_behavior();e&&e.active(t)}},e.prototype.deactive_battle_behavior=function(){if(this._machine){var t=this._machine.get_battle_behavior();t&&t.deactive()}},e.prototype.execute_current_skill=function(){this.skillm_active.execute_current_skill()},e.prototype.sm_state_changed=function(t,e,i){e.state_enum()==CharacterMachineState.MOVING?this._binded_view.change_state(GC_CharacterAnimState.MOVING):e.state_enum()==CharacterMachineState.BATTLE_DEFENDER?this._binded_view.change_state(GC_CharacterAnimState.IDLE):e.state_enum()==CharacterMachineState.BATTLE_ASSAULTER?this._binded_view.change_state(GC_CharacterAnimState.IDLE):e.state_enum()==CharacterMachineState.DYING&&this._binded_view.change_state(GC_CharacterAnimState.DYING)},e.prototype._sm_modify_pos=function(t,e,i){this._current_pos_3d.x=t.x,this._current_pos_3d.y=t.y,this._current_scale_3d.x=e.x,this._current_scale_3d.y=e.y,this._current_pos_2d.x=i.x,this._current_pos_2d.y=i.y},e.prototype._sm_modify_view_orientation=function(t){this._binded_view.change_direction(t)},e.prototype.bind_view=function(t){this._binded_view=t},e.prototype.frame_update=function(){t.prototype.frame_update.call(this),this._machine_update(),this._view_update_pos(),this._view_update_frame()},e.prototype._machine_update=function(){this._machine&&this._machine.machine_update()},e.prototype._view_update_pos=function(){this._binded_view.x=this._current_pos_3d.x,this._binded_view.y=this._current_pos_3d.y;var t=gp_core.layout_config.character_global_scale;this._binded_view.scaleX=this._current_scale_3d.x*t,this._binded_view.scaleY=this._current_scale_3d.y*t},e.prototype._view_update_frame=function(){this._binded_view.update_frame()},e.prototype._events_init=function(){var t=GC_Skill_Metadata.Trigger_Event_Count;this._evts=new Array(t);for(var e=0;t>e;e++)this._evts[e]=new GC_TriggerEvent,this._evts[e].evt_init(this,e)},e.prototype.distribute_event=function(t){var e=this.current_room();if(e){var i=this._evts[t];e.post_trigger_event(i)}},e.prototype.post_trigger_event=function(t){this.skillm_passive.post_trigger_event(t),this.skillm_se.post_trigger_event(t)},e.prototype.register_flying_part=function(t){this._flying_parts.push(t)
},e.prototype.recevie_part_arrived=function(t){var e=t.dmg;this._flying_parts.remove(t),this.deduct_life(e,GC_Process_Metadata.Dmg_Element.fire,!0)},e}(GameActor);__reflect(GameCharacter.prototype,"GameCharacter",["ns_sirius.IGP_StateMachineListener"]);var GameWinVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(GameWinVM.prototype,"GameWinVM");var BattleBehavior=function(t){function e(e,i){var o=t.call(this,e,i)||this;o._is_focusing=!1;var r=200;return o._character.is_boss()&&(r=120),o._interval=ns_sirius.anim_clock.frame_to_ms(r),o._timer=new ns_sirius.timer_rtime_based(o),o}return __extends(e,t),e.prototype.get_target_character=function(){return this._target_character},e.prototype._before_destroy=function(){this._timer.destroy(),this._timer=null,this._character=null,this._target_character=null,t.prototype._before_destroy.call(this)},e.prototype.behavior_active=function(){this._timer.timer_active()},e.prototype.behavior_deactive=function(){this._timer.timer_deactive()},e.prototype._start_new_attack_round=function(){this._character.character_type()==GameCharacterType.Defender?this._timer.start(this._interval,0,.5*this._interval):this._timer.start(this._interval,0)},e.prototype.active=function(t){this._target_character=t,this._is_focusing||this._start_new_attack_round(),this._is_focusing=!0},e.prototype.deactive=function(){this._is_focusing=!1,this._target_character=null},e.prototype.rtimer_tick=function(t){if(this._is_focusing&&(!appm.debug_flag||this._character.character_type()!=GameCharacterType.Assaulter)){var e=this._character.skillm_active.new_attack_act();0>e||(this._character._binded_view.start_stride(),this._character._binded_view.change_state(GC_CharacterAnimState.ATTACKING,e),this._character.distribute_event(GC_Skill_Metadata.Process_Trigger_Event.Action))}},e}(Character_Behavior);__reflect(BattleBehavior.prototype,"BattleBehavior",["ns_sirius.Itimer_rtime_based_listener"]);var SkillManagerBase=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._weak_character=null,t.prototype._before_destroy.call(this)},e.prototype.manager_init=function(t,e){this._weak_character=t,this._components_init(t,e)},e.prototype._find_skill_by_no_from_array=function(t,e){if(!e||0==e.length)return null;for(var i=e.length,o=0;i>o;o++)if(e[o].cached_skill_no==t)return e[o];return null},e.prototype._trigger_event=function(t,e){var i=t.get_metadata();if(i.trigger&&void 0!==i.trigger.event&&i.trigger.event==e.type){var o=i.trigger.target;if(o==GC_Skill_Metadata.TriggerScope.room_all)return void t.execute_sequence(e);o==GC_Skill_Metadata.TriggerScope.self&&e.src==this._weak_character&&t.execute_sequence(e),o==GC_Skill_Metadata.TriggerScope.facing&&e.src==this._weak_character.get_facing_enemy()&&t.execute_sequence(e),o==GC_Skill_Metadata.TriggerScope.room_enemy&&e.src.character_type()!=this._weak_character.character_type()&&t.execute_sequence(e),o==GC_Skill_Metadata.TriggerScope.room_friendly&&e.src.character_type()==this._weak_character.character_type()&&t.execute_sequence(e)}},e}(GamePlayEntityBase);__reflect(SkillManagerBase.prototype,"SkillManagerBase");var TestModuleView=function(t){function e(){var e=t.call(this)||this;return e.textField=new egret.TextField,e.addChild(e.textField),e.textField.size=32,e.textField.textAlign="left",e.textField.verticalAlign="top",e.textField.x=50,e.textField.y=100,e.textField.width=400,e.textField.textColor=16777215,e.textField.text=appm.lm.s("global","confirm"),e.textField.background=!0,e.textField.backgroundColor=23223,e.titleField=new egret.TextField,e.addChild(e.titleField),e.titleField.size=22,e.titleField.textAlign="center",e.titleField.verticalAlign="top",e.titleField.x=50,e.titleField.width=400,e.titleField.y=10,e.titleField.height=80,e.titleField.textColor=16777215,e.titleField.text="这是测试模块",setTimeout(function(){e._is_destroyed||e._sirius.debug_foo()},1e3),e}return __extends(e,t),e.prototype.attached_to_display_tree=function(t){},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e}(AppModuleViewBase);__reflect(TestModuleView.prototype,"TestModuleView");var Tab1View=function(t){function e(e){var i=t.call(this)||this;return i.skinName="resource/YXY/game_skins/tabViewSkin.exml",console.log("name"+e),i}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.additem()},e.prototype.additem=function(){var t=this;this.mapDatas=new eui.ArrayCollection;for(var e=["battleSettlement_expStick_01","battleSettlement_expStick_02","battleSettlement_expStick_03","battleSettlement_expStick_04","battleSettlement_expStick_04","battleSettlement_expStick_04","battleSettlement_expStick_04","battleSettlement_expStick_04","battleSettlement_expStick_04","battleSettlement_expStick_04","battleSettlement_expStick_04"],i=["battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01","battleSettlement_expStick_01"],o=0;o<e.length;o++)this.mapDatas.addItem(e[o]);this.mapList.itemRenderer=FightMapItemRenderer,this.mapList.itemRendererSkinName="resource/YXY/game_skins/test_item.exml",this.mapList.dataProvider=this.mapDatas,this.mapList.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){console.log("======"+e.item),console.log("======"+e.itemRenderer),console.log("======"+e.itemIndex),t.mapDatas.replaceAll(i)},this)},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e}(AppModuleViewBase);__reflect(Tab1View.prototype,"Tab1View");var FightMapItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.bgAsset.source=this.data),console.log("=======data "+this.data)},e}(eui.ItemRenderer);__reflect(FightMapItemRenderer.prototype,"FightMapItemRenderer");var Character_State_Battle=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.get_behavior_battle=function(){return this._behavior_battle},e.prototype._before_destroy=function(){this._behavior_battle.destroy(),this._behavior_battle=null,t.prototype._before_destroy.call(this)},e.prototype._behaviors_init=function(){this._character.character_type()==GameCharacterType.Boss?this._behavior_battle=new BossBattleBehavior(this._character,this):this._behavior_battle=new BattleBehavior(this._character,this)},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._behavior_battle.behavior_active()},e.prototype.state_leave=function(t,e){void 0===e&&(e=null),this._behavior_battle.behavior_deactive()},e}(CharacterStateBase);__reflect(Character_State_Battle.prototype,"Character_State_Battle");var RoomTypeEnum=function(){function t(){}return t.UNINITED=-1,t.EMPTY=0,t.ARENA=1,t.FACILITY=2,t.BOSS=999,t}();__reflect(RoomTypeEnum.prototype,"RoomTypeEnum");var FacilityTypeEnum=function(){function t(){}return t.UNINITED=-1,t}();__reflect(FacilityTypeEnum.prototype,"FacilityTypeEnum");var RoomEntity=function(t){function e(){var e=t.call(this)||this;return e._has_init=!1,e._room_type=RoomTypeEnum.UNINITED,e._facility_type=FacilityTypeEnum.UNINITED,e}return __extends(e,t),e.prototype._before_destroy=function(){this.layout_info.destroy(),this.layout_info=null,this.link&&(this.link.destroy(),this.link=null)},e.prototype.room_layout_init=function(t,e){this.layout_info=new RoomLayoutInfo,this.layout_info.layout_init(t,e)},e.prototype.link_generate=function(t){this.link=new RoomLinkInfo,this.link.link_init(t,this.layout_info.room_pos.row_index,this.layout_info.room_pos.column_index)},e.prototype.room_type_init=function(t,e){this._room_type=t,this._facility_type=e,this._has_init=!0},e.prototype.is_boss_room=function(){return!1},e.prototype.is_born_room=function(){return!1},e.prototype._link_asymmetrical=function(t,e){t.active_battle_behavior(e)},e.prototype._unlink=function(t){t.deactive_battle_behavior()},e.prototype._init_arr_by_null=function(t,e){for(var i=0;e>i;i++)t[i]=null},e.SlotsMax=3,e}(GamePlayEntityBase);__reflect(RoomEntity.prototype,"RoomEntity");var RoomLayoutInfo=function(t){function e(){var e=t.call(this)||this;return e.view_pos=new egret.Point,e.center_pos=new egret.Point,e.d3_point_local=new egret.Point,e.d3_scale=new egret.Point,e}return __extends(e,t),e.prototype._before_destroy=function(){this.room_pos=null,this._slots_def_2d=null,this._slots_assault_2d=null,this._slots_def_3d=null,this._slots_assault_3d=null},e.prototype.layout_init=function(t,e){var i=gp_core.layout_config,o=gp_core.layout_config.rowcolumn_to_uindex(e,t);this.room_pos=new MapRoomPosition(o,t,e),this.view_pos.x=i.room_orig_x+Math.round(t*(i.column_gap+i.cell_w)),this.view_pos.y=i.room_orig_y+Math.round(e*(i.row_gap+i.cell_h)),this.center_pos.x=this.view_pos.x+Math.round(.5*i.cell_w),this.center_pos.y=this.view_pos.y+Math.round(.5*i.cell_h),this.view_w=i.cell_w,this.view_h=i.cell_h,this._def_slots_init(),this._assualt_slots_init()},e.prototype._slot_orig_x=function(){return this.view_pos.x},e.prototype._slot_orig_y=function(){return this.view_pos.y-20},e.prototype._slot_inner_gap=function(){return 30},e.prototype._def_slots_init=function(){var t=RoomEntity.SlotsMax,e=gp_core.layout_config;this._slots_def_2d=Array(t),this._slots_def_3d=Array(t);for(var i=this._slot_orig_x(),o=0;t>o;o++)this._slots_def_2d[o]=new egret.Point(i+this._slot_inner_gap(),0),this._slots_def_3d[o]=new egret.Point(0,0);var r=this._slot_orig_y(),n=e.cell_h,_=Math.floor(e.cell_h/3);this._slots_def_2d[0].y=r+n-2*_,this._slots_def_2d[1].y=r+n-_,this._slots_def_2d[2].y=r+n},e.prototype._assualt_slots_init=function(){var t=RoomEntity.SlotsMax,e=gp_core.layout_config;this._slots_assault_2d=Array(t),this._slots_assault_3d=Array(t);for(var i=this._slot_orig_x(),o=0;t>o;o++)this._slots_assault_2d[o]=new egret.Point(i+e.cell_w-this._slot_inner_gap(),0),this._slots_assault_3d[o]=new egret.Point(0,0);var r=this._slot_orig_y(),n=e.cell_h,_=Math.floor(e.cell_h/3);this._slots_assault_2d[0].y=r+n-2*_,this._slots_assault_2d[1].y=r+n-_,this._slots_assault_2d[2].y=r+n},e.prototype.born_layout_init=function(){var t=gp_core.layout_config;this.room_pos=new MapRoomPosition(GameMap.born_room_id),this.view_pos.x=t.pawn_born_x-.5*t.pawn_born_width,this.view_pos.y=t.pawn_born_y-.5*t.pawn_born_height,this.center_pos.x=t.pawn_born_x,this.center_pos.y=t.pawn_born_y,this.view_w=t.pawn_born_width,this.view_h=t.pawn_born_height},e.prototype.update_3d_layout=function(){gp_core.ppc.cal_3d_pos(this.center_pos,this.d3_point_local,this.d3_scale);var t=RoomEntity.SlotsMax;if(this._slots_def_2d)for(var e=0;t>e;e++)gp_core.ppc.cal_3d_pos(this._slots_def_2d[e],this._slots_def_3d[e],null);if(this._slots_assault_2d)for(var e=0;t>e;e++)gp_core.ppc.cal_3d_pos(this._slots_assault_2d[e],this._slots_assault_3d[e],null)},e.prototype.get_slot_3dpos_by_slot=function(t,e,i){if(!t||t.slot_index<0)return e.copyFrom(this.d3_point_local),void i.copyFrom(this.center_pos);var o=RoomEntity.SlotsMax;return t.slot_index>o-1?(e.copyFrom(this.d3_point_local),void i.copyFrom(this.center_pos)):void(t.type==GameCharacterType.Defender?(e.copyFrom(this._slots_def_3d[t.slot_index]),i.copyFrom(this._slots_def_2d[t.slot_index])):t.type==GameCharacterType.Assaulter?(e.copyFrom(this._slots_assault_3d[t.slot_index]),i.copyFrom(this._slots_assault_3d[t.slot_index])):(e.copyFrom(this.d3_point_local),i.copyFrom(this.center_pos)))},e.prototype.get_slot_2dpos_by_index=function(t,e){if(!t||t.slot_index<0)return e.x=this.center_pos.x,void(e.y=this.center_pos.y);var i=RoomEntity.SlotsMax;return t.slot_index>i-1?(e.x=this.center_pos.x,void(e.y=this.center_pos.y)):void(t.type==GameCharacterType.Defender?(e.x=this._slots_def_2d[t.slot_index].x,e.y=this._slots_def_2d[t.slot_index].y):t.type==GameCharacterType.Assaulter?(e.x=this._slots_assault_2d[t.slot_index].x,e.y=this._slots_assault_2d[t.slot_index].y):(e.x=this.center_pos.x,e.y=this.center_pos.y))},e}(GamePlayEntityBase);__reflect(RoomLayoutInfo.prototype,"RoomLayoutInfo");var GC_Molecule_Base=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._localmd=function(){return this._weak_md},e.prototype._before_destroy=function(){this._weak_skill=null,this._weak_md=null},e.prototype.molecule_init=function(t,e){this._weak_md=e,this._weak_skill=t,this._init(e)},e}(ns_sirius.sirius_base_object);__reflect(GC_Molecule_Base.prototype,"GC_Molecule_Base");var Tab1VM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(Tab1VM.prototype,"Tab1VM");var GC_ExecutableProcess=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._calculator&&(this._calculator.destroy(),this._calculator=null),this._validator&&(this._validator.destroy(),this._validator=null),this._widget_probability=null,this._target_exec_fun=null,t.prototype._before_destroy.call(this)},e.prototype._init=function(t){var e=t;if(e.validator_enabled&&e.validator&&(this._validator=new GC_Validator,this._validator.molecule_init(this._binded_skill,e.validator)),e.probability_enabled?this._widget_probability=skill_widget_probability.choose_object(e.probability):this._widget_probability=skill_widget_probability.choose_object(null),e.target){var i=e.target.selector_id,o=this._find_siblings(i),r=o.get_metadata().selector.scope;r==GC_Process_Metadata.ScopeE.Single?this._target_exec_fun=this._exec_one_target:this._target_exec_fun=this._exec_array_target}else this._target_exec_fun=this._exec_no_target;this._init_calculator(t)},e.prototype.execute=function(){this._widget_probability(this,this._localmd().probability)&&this._target_exec_fun()},e.prototype._exec_one_target=function(){var t=this._localmd().target.selector_id,e=this._find_siblings(t).output;if(e.target){var i=e.target;this._exec_with_validate(i)}},e.prototype._exec_array_target=function(){var t=this._localmd().target.selector_id,e=this._find_siblings(t).output;if(e.target)for(var i=e.target,o=i.length,r=0;o>r;r++){var n=i[r];n&&this._exec_with_validate(n)}},e.prototype._exec_no_target=function(){this._exec_with_validate(this._binded_character)},e.prototype._exec_with_validate=function(t){if(this._validator){var e=this._validator.validate(this._binded_character,t);if(!e)return}this._exec_subdivision(t)},e}(GC_ProcessBase);__reflect(GC_ExecutableProcess.prototype,"GC_ExecutableProcess");var TestABCView=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.onComplete,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.touchClick(0)},e.prototype.stactic_table_name=function(){var t=[];return t.push("tab1"),t.push("tab2"),t.push("tab3"),t},e.prototype.touchClick=function(t){if(t!=this.selectID){if(this.tabContainGroup.removeChildren(),0==t)this.tabContent=new Tab1View("123"),sirius.view_manager.show_sub_module_init(this.tabContent,new Tab1VM,this.tabContainGroup);else if(1==t){var e=new eui.Label;e.text="tab2",e.width=199,e.height=60,e.background=!0,e.backgroundColor=10066329,this.tabContainGroup.addChild(e)}else if(2==t){var e=new eui.Label;e.text="tab3",e.width=199,e.height=60,e.background=!0,e.backgroundColor=10066329,this.tabContainGroup.addChild(e)}this.selectID=t}},e.prototype.onComplete=function(){console.log("onComplete")},e.prototype._view_before_init=function(){},e.prototype.static_title_name=function(){return"Title Name"},e.prototype._view_start_init=function(){},e.prototype._view_before_destroy=function(){null!=this.tabContent&&this.tabContent.destroy()},e}(TableViewBase);__reflect(TestABCView.prototype,"TestABCView");var TestABCVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(TableVMBase);__reflect(TestABCVM.prototype,"TestABCVM");var SkillPart_ExecSequence=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._weak_character=null,this._weak_skill=null,this._weak_skill_md=null,this._clear_outputs(),this._destroy_arr(this._processes),this._processes=null,t.prototype._before_destroy.call(this)},e.prototype.part_init=function(t,e,i){if(!i.exec_sequence||!i.exec_sequence.processes||0==i.exec_sequence.processes.length)return this._process_count=0,void(this._sequence_executable=!1);this._weak_character=t,this._weak_skill=e,this._weak_skill_md=i,this._sequence_executable=!0;var o=i.exec_sequence,r=o.processes.length;this._processes=new Array;for(var n=0;r>n;n++){var _=o.processes[n],s=GC_ProcessBase.new_process(_);if(!s)throw"invalid process";s.process_init(t,e,_),this._processes.push(s)}this._process_count=this._processes.length},e.prototype._clear_outputs=function(){for(var t=0;t<this._process_count;t++)this._processes[t].clear_output()},e.prototype.execute_sequence=function(){this._clear_outputs();for(var t=0;t<this._process_count;t++)this._processes[t].execute()},e.prototype.modify_coe_A=function(t,e,i){this._clear_outputs();for(var o=0;o<this._process_count;o++)this._processes[o].apply_coe_A(t,e,i)},e.prototype.modify_coe_P=function(t,e,i){this._clear_outputs();for(var o=0;o<this._process_count;o++)this._processes[o].apply_coe_P(t,e,i)},e.prototype.find_process=function(t){return 0==this._process_count?null:this._processes[t]},e}(SkillPart_Base);__reflect(SkillPart_ExecSequence.prototype,"SkillPart_ExecSequence");var GC_PassiveSkill=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.type=function(){return GC_Skill_Metadata.SkillType.passive},e.prototype._before_destroy=function(){this._trigger&&(this._trigger.destroy(),this._trigger=null),t.prototype._before_destroy.call(this)},e.prototype._init=function(t){},e.prototype.execute_sequence=function(t){this._weak_focus=t.src,this._p_exec_sequence.execute_sequence()},e.prototype.modify_coe_A=function(t,e,i){this._p_exec_sequence.modify_coe_A(t,e,i)},e.prototype.modify_coe_P=function(t,e,i){this._p_exec_sequence.modify_coe_P(t,e,i)},e}(GC_SkillBase);__reflect(GC_PassiveSkill.prototype,"GC_PassiveSkill");var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.ProgressBar);t.CommonProcessBar=e,__reflect(e.prototype,"game.CommonProcessBar")}(game||(game={}));var GC_CharacterAnimState=function(){function t(){}return t.IDLE=0,t.MOVING=1,t.ATTACKING=2,t.WAITING=3,t.DYING=4,t}();__reflect(GC_CharacterAnimState.prototype,"GC_CharacterAnimState");var GC_CharacterAnimName=function(){function t(){}return t.IDLE="standby",t.WAITING="waiting",t.MOVE="run",t.ATTACK_1="attack_1",t.ATTACK_2="attack_2",t}();__reflect(GC_CharacterAnimName.prototype,"GC_CharacterAnimName");var GC_CharacterView=function(t){function e(){var e=t.call(this)||this;e._fixed_scale_x=1,e._fixed_scale_y=1,e._current_anim_state=-1,e._attack_trigger=!1,e._character_x=0;var i=new egret.Bitmap(RES.getRes("character_shadow_png"));e.addChild(i),i.x=.5*-i.width,i.y=.5*-i.height,e._shadow=i,e._dmg_pool_size=3,e._dmg_pool=new ns_sirius.rotational_deprived_fixed_pool(3),e._dmg_pool.pool_init(DmgTxt);var o=[1,0,0,0,0,0,.6,0,0,0,0,0,.6,0,0,0,0,0,1,0];return e._vibration_filter=new egret.ColorMatrixFilter(o),e._vibration_comp=new GCCV_vibration(e,null,1).init(),e._stride_comp=new GCCV_stride(null,null,2).init(),e._death_comp=new GCCV_death(e,null,3).init(),e}return __extends(e,t),e.prototype._before_destroy=function(){if(this._character_display){var t=dragonBones.WorldClock.clock;t.remove(this._character_display.armature),this._character_display.animation.stop(),this._character_display.removeEvent(dragonBones.EgretEvent.COMPLETE,this._animation_play_end,this),this._character_display.removeEvent(dragonBones.EgretEvent.ANIMATION_FRAME_EVENT,this._ANIM_FRAME_EVENT,this),this._character_display.armature.dispose(),this._character_display.dispose(),this._character_display=null}for(var e=0;e<this._dmg_pool_size;e++)this._dmg_pool.get_stack()[e].destroy();this._dmg_pool.destroy(),this._dmg_pool=null,this.removeChild(this._health_view),this._health_view=null,this._binded_entity=null,this._vibration_comp.destroy(),this._vibration_comp=null,this._stride_comp.destroy(),this._stride_comp=null,this._death_comp.destroy(),this._death_comp=null,this.remove_from_parent()},e.prototype._cal_health_orig_y=function(){var t=0,e=this._character_display.armature.getSlot("root_boundingBox");if(e){var i=e.origin.scaleY,o=e.boundingBoxData;t=-o.height*i}return t},e.prototype._get_anim_res=function(t){var e=0,i=null;return t.is_boss()?(gp_core.taling_resm.res_count>1&&(e=0),i=gp_core.taling_resm.get_res_by_index(e)):(gp_core.resm.res_count>1&&(e=Math.floor(Math.random()*(gp_core.resm.res_count-.5))),i=gp_core.resm.get_res_by_index(e)),this._res_index=e,i},e.prototype.bind_entity=function(t){this._binded_entity=t;var e=this._get_anim_res(t);if(e){this._init_character_anim(e);var i=this._cal_health_orig_y();this._health_view=new CharacterHealthView(t.is_boss(),i),this.addChild(this._health_view);for(var o=0;o<this._dmg_pool_size;o++)this._dmg_pool.get_stack()[o].y=.5*i}},e.prototype._init_character_anim=function(t){var e=dragonBones.EgretFactory.factory,i=e.buildArmatureDisplay(t.armature_name,t.character_name);this.addChild(i),dragonBones.WorldClock.clock.add(i.armature),i.scaleX=this._fixed_scale_x,i.scaleY=this._fixed_scale_y,this._character_display=i,this._character_display.addEvent(dragonBones.EgretEvent.COMPLETE,this._animation_play_end,this),this._character_display.addEvent(dragonBones.EgretEvent.ANIMATION_FRAME_EVENT,this._ANIM_FRAME_EVENT,this)},e.prototype._animation_play_end=function(t){this.change_state(GC_CharacterAnimState.IDLE)},e.prototype._ANIM_FRAME_EVENT=function(t){var e=this._character_display.animation.lastAnimationState.name;e.indexOf("attack")<0||this._attack_trigger&&(this._attack_trigger=!1,this._binded_entity.execute_current_skill())},e.prototype.change_direction=function(t){0!=t&&this._character_display&&(1==t?this._character_display.scaleX=this._fixed_scale_x:2==t&&(this._character_display.scaleX=-this._fixed_scale_y))},e.prototype.update_health=function(t){this._health_view.update_prog(t)},e.prototype.play_heal_anim=function(t){this._dmg_pool.borrow().start_anim_heal(t,this,this._binded_entity.character_type()==GameCharacterType.Assaulter)},e.prototype.play_dmg_anim=function(t,e){this._dmg_pool.borrow().start_anim(t,e,this,this._binded_entity.character_type()==GameCharacterType.Assaulter)},e.prototype.play_dodge=function(){this._dmg_pool.borrow().start_anim_dodge(this,this._binded_entity.character_type()==GameCharacterType.Assaulter)},e.prototype.play_se_status_change=function(t,e){this._dmg_pool.borrow().play_se_status_change(t,e,this,this._binded_entity.character_type()==GameCharacterType.Assaulter)},e.prototype._play_idle_state=function(){this._character_display.animation.play(GC_CharacterAnimName.IDLE)},e.prototype.change_state=function(t,e){if(void 0===e&&(e=null),(t!=GC_CharacterAnimState.IDLE&&t!=GC_CharacterAnimState.WAITING&&t!=GC_CharacterAnimState.MOVING||t!=this._current_anim_state)&&this._character_display)switch(this._current_anim_state=t,t){case GC_CharacterAnimState.IDLE:this._play_idle_state();break;case GC_CharacterAnimState.WAITING:this._character_display.animation.play(GC_CharacterAnimName.WAITING);break;case GC_CharacterAnimState.MOVING:this._stride_comp.stop(),this._modify_character_x(0),this._character_display.animation.play(GC_CharacterAnimName.MOVE);break;case GC_CharacterAnimState.ATTACKING:if(null===e||void 0===e)return;var i=e,o=null;o=1==i?GC_CharacterAnimName.ATTACK_1:GC_CharacterAnimName.ATTACK_2,this._character_display.animation.hasAnimation(o)&&this._character_display.animation.play(o,1),this._attack_trigger=!0;break;case GC_CharacterAnimState.DYING:this._death_comp.start_die(this._binded_entity.character_type()==GameCharacterType.Assaulter),this._health_view.visible=!1,this._shadow.visible=!1;break;default:this._play_idle_state()}},e.prototype.single_anim_comp=function(t){1==t.anim_id?this._character_display.filters=null:2==t.anim_id||3==t.anim_id&&this._binded_entity.sentence_to_death()},e.prototype.start_vibration_anim=function(){this._vibration_comp.start(),this._character_display.filters=[this._vibration_filter]},e.prototype.start_stride=function(){this._stride_comp.stride(this._binded_entity.character_type()==GameCharacterType.Assaulter)},e.prototype.update_frame=function(){var t=this._death_comp.is_animating,e=this._vibration_comp.is_animating,i=this._stride_comp.is_animating;if(this._character_display){if(t)return this._modify_character_x(this._death_comp.current_x()),this._modify_character_y(this._death_comp.current_y()),void this._modify_character_alpha(this._death_comp.current_alpha());if(!e&&!i)return void this._modify_character_x(0);var o=0;i&&(o=this._stride_comp.stride_pos());var r=o;e&&(r+=this._vibration_comp.vibration_offset),this._modify_character_x(r)}},e.prototype._modify_character_x=function(t){(0!=this._character_x||0!=t)&&(this._character_x=t,this._character_display.x=this._character_x)},e.prototype._modify_character_y=function(t){this._character_display.y=t},e.prototype._modify_character_alpha=function(t){this._character_display.alpha=t},e}(GC_Ele_BaseView);__reflect(GC_CharacterView.prototype,"GC_CharacterView",["ns_sirius.Isingle_animation_listener"]);var GC_RoomView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(GC_Ele_BaseView);__reflect(GC_RoomView.prototype,"GC_RoomView");var GameCoreResManager=function(){function t(){var t=this._config_file_name(),e=RES.getRes(t).characters;if(!e||0==e.length)return sirius.view_manager.show_popup_text_msg("必须在【"+t+"】文件中配置角色信息"),void console.log("必须在【"+t+"】文件中配置角色信息");this._resources=new Array;var i=(this._resources,e.length);this.res_count=i;for(var o=0;i>o;o++){var r=e[o],n=new AnimRes(o,r.file_key,r.armature_name,r.character_name);this._resources.push(n)}}return t.prototype.get_res_by_index=function(t){return this._resources?t>this._resources.length-1?null:this._resources[t]:null},t.prototype._config_file_name=function(){return"character_config_json"},t.prototype._res_prefix=function(){return"resource/LK/game_core/characters"},t.prototype.load_res=function(t){if(!this._resources||0==this._resources.length)return void t();this._callback=t,this._load_count=this._resources.length;for(var e=0,i=this._resources;e<i.length;e++){var o=i[e];this._load_ske_res(o)}},t.prototype._load_ske_res=function(t){var e=this,i=this._res_prefix()+"/"+t.file_key+"/"+t.file_key+"_ske.json";RES.getResByUrl(i,function(i,o){t.data_ske=i,e._load_tex_config_res(t)},this,null)},t.prototype._load_tex_config_res=function(t){var e=this,i=this._res_prefix()+"/"+t.file_key+"/"+t.file_key+"_tex.json";RES.getResByUrl(i,function(i,o){t.data_tex_config=i,e._load_tex_img_res(t)},this,null)},t.prototype._load_tex_img_res=function(t){var e=this,i=this._res_prefix()+"/"+t.file_key+"/"+t.file_key+"_tex.png";RES.getResByUrl(i,function(i,o){t.data_tex_img=i,e._one_res_loaded(t)},this,null)},t.prototype._one_res_loaded=function(t){var e=dragonBones.EgretFactory.factory;e.parseDragonBonesData(t.data_ske),e.parseTextureAtlasData(t.data_tex_config,t.data_tex_img),this._load_count--,this._load_count<=0&&(this._callback(),this._callback=null)},t.prototype.remove_all_data=function(){var t=dragonBones.EgretFactory.factory;t.clear()},t}();__reflect(GameCoreResManager.prototype,"GameCoreResManager");var AdventureEnterView=function(t){function e(){var e=t.call(this)||this;return e.ad_flag=!0,e.sourceArr=[],e.sourceMapArr=[],e.currentAreaArr=[],e.map_col_count=11,e.map_item_w=14,e.addEventListener(eui.UIEvent.COMPLETE,e.onComplete,e),e.skinName="resource/ZL/skins/adventure/adventure_enter.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(t){t.stopPropagation()},this),this.btn_back_out.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backOut,this),this.btn_pause.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pause,this),this.group_reward.addEventListener(UICommon.ClickEvent.click,this.rewardClick,this),this.group_reward.addEventListener(UICommon.ClickEvent.longClick,this.rewardLongClick,this);for(var e=0;121>e;e++)this.sourceArr.push({type:Math.floor(3*Math.random()),index:e});console.log(this.sourceArr);for(var e=0;e<this.sourceArr.length;e++){var i=e%this.map_col_count*this.map_item_w+2*(e%this.map_col_count+1),o=Math.floor(e/this.map_col_count)*this.map_item_w+2*(Math.floor(e/this.map_col_count)+1),r=new MapCellEntity;r.set(this.sourceArr[e].type,this.sourceArr[e].index,Math.floor(e/this.map_col_count),e%this.map_col_count,i,o),this.sourceMapArr.push(r)}this.arrCollection=new eui.ArrayCollection(this.sourceArr),this.initLeft(),this.initMap()},e.prototype.initLeft=function(){for(var t=0;16>t;t++){var e=t%4*130+4*(t%4+1),i=130*Math.floor(t/4)+4*(Math.floor(t/4)+1),o=new AdventureMapItem;o.width=130,o.height=130,o.x=e,o.y=i,this.group_L_map.addChild(o),o.setIndex(t),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.enter,this)}this.l_map_location=new eui.Group,this.l_map_location.width=138,this.l_map_location.height=138,this.group_L.addChild(this.l_map_location);var r=new eui.Image;r.width=128,r.height=69,r.source="Event_Pic_BlankBG_02_png",r.bottom=4,r.horizontalCenter=0,this.l_map_location.addChild(r);var n=new eui.Image;n.width=77,n.height=43,n.bottom=0,n.source="Common_Pic_Base_png",n.horizontalCenter=0,this.l_map_location.addChild(n)},e.prototype.clearLeft=function(){for(var t=0;t<this.currentAreaArr.length;t++){var e=this.group_L_map.getChildAt(t);e.setState(0),e.visible=!0}},e.prototype.changeLeft=function(){this.clearLeft();for(var t=0;t<this.currentAreaArr.length;t++){var e=this.group_L_map.getChildAt(t);e.setType(this.currentAreaArr[t].type),e.setState(this.currentAreaArr[t].state),3===this.currentAreaArr[t].state&&(e.visible=!1,console.log(e.x+" : "+e.y),this.l_map_location.x=e.x-4,this.l_map_location.y=e.y-4)}},e.prototype.initMap=function(){console.log("=====map");for(var t=0;t<this.sourceMapArr.length;t++){var e=new eui.Image;e.width=this.map_item_w,e.height=this.map_item_w,e.x=this.sourceMapArr[t].x,e.y=this.sourceMapArr[t].y,e.source="Common_Pic_Blank_01_png",this.group_RT_map.addChild(e)}this.sourceArr[0].location;this.current_location=120,this.changeMap()},e.prototype.clearMap=function(){for(var t=0;t<this.sourceMapArr.length;t++){var e=this.group_RT_map.getChildAt(t);e.source="Common_Pic_Blank_01_png",this.sourceMapArr[t].setState(0)}},e.prototype.changeMap=function(){this.current_location_h=this.current_location%this.map_col_count,this.current_location_v=Math.floor(this.current_location/this.map_col_count),this.clearMap(),console.log("this.current_location_col:"+this.current_location_h),console.log("this.current_location_row:"+this.current_location_v);for(var t=0;t<this.sourceMapArr.length;t++){var e=this.sourceMapArr[t],i=this.group_RT_map.getChildAt(t);this.current_location_h-3===e.col&&this.current_location_v===e.row||this.current_location_h-2===e.col&&this.current_location_v===e.row||this.current_location_h-1===e.col&&this.current_location_v-1===e.row||this.current_location_h-2===e.col&&this.current_location_v-1===e.row||this.current_location_h-1===e.col&&this.current_location_v-2===e.row||this.current_location_h===e.col&&this.current_location_v-2===e.row||this.current_location_h===e.col&&this.current_location_v-3===e.row?(i.source="Common_Pic_Blank_02_png",this.sourceMapArr[t].setState(1)):this.current_location_h-1===e.col&&this.current_location_v===e.row||this.current_location_h===e.col&&this.current_location_v-1===e.row?(i.source="Common_Pic_Blank_03_png",this.sourceMapArr[t].setState(2)):t===this.current_location&&(i.source="Common_Pic_Blank_04_png",this.sourceMapArr[t].setState(3),this.rt_map_location.x=this.sourceMapArr[t].x-4,this.rt_map_location.y=this.sourceMapArr[t].y-9)
}this.setMapArea()},e.prototype.setMapArea=function(){var t=0,e=0;t=this.current_location_h<4?-4:10===this.current_location_h?7*(this.map_item_w+2)-4:(this.current_location_h-4+1)*(this.map_item_w+2)-4,e=this.current_location_v<4?-4:10===this.current_location_v?7*(this.map_item_w+2)-4:(this.current_location_v-4+1)*(this.map_item_w+2)-4,this.rt_map_area.x=t,this.rt_map_area.y=e,this.currentAreaArr.splice(0,this.currentAreaArr.length);for(var i=0;i<this.sourceMapArr.length;i++)this.sourceMapArr[i].x>t+4&&this.sourceMapArr[i].x<t+74-4&&this.sourceMapArr[i].y>e+4&&this.sourceMapArr[i].y<e+74-4&&this.currentAreaArr.push(this.sourceMapArr[i]);console.log(this.currentAreaArr),this.changeLeft()},e.prototype.onComplete=function(){console.log("onComplete")},e.prototype._view_before_init=function(){console.log(this.init_param)},e.prototype._view_start_init=function(){},e.prototype.backOut=function(){sirius.view_manager.pop_top_module()},e.prototype.pause=function(){sirius.view_manager.pop_top_module()},e.prototype.rewardClick=function(){this.ad_flag&&(this.ad_flag=!1,this.group_ad.visible=!1,this.reward_start.visible=!1,this.reward.visible=!0,this.reward_img.source="Common_Icon_EXPup_png",this.reward_num.text="20")},e.prototype.rewardLongClick=function(){this.ad_flag||(console.log("====longclick"),sirius.view_manager.show_module("AdventureRewardDesView",{name:"EXP增加",des:"状态描述状态描述状态描述状态描述"}))},e.prototype.enter=function(t){console.log("---------enter"),console.log(t.target),console.log(t.target.index);for(var e=this.currentAreaArr[t.target.index].row,i=this.currentAreaArr[t.target.index].col,o=0;o<this.sourceMapArr.length;o++)this.sourceMapArr[o].col===i&&this.sourceMapArr[o].row===e&&(this.current_location=this.sourceMapArr[o].index,this.changeMap())},e}(AppModuleViewBase);__reflect(AdventureEnterView.prototype,"AdventureEnterView");var AdventureEnterVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(AdventureEnterVM.prototype,"AdventureEnterVM");var AdventureRewardDesView=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.onComplete,e),e.skinName="resource/ZL/skins/adventure/adventure_reward_des.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.des_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},e.prototype.onClose=function(){sirius.view_manager.pop_top_module()},e.prototype.onComplete=function(){console.log("onComplete")},e.prototype._view_before_init=function(){console.log(this.init_param);var t=this.init_param;this.des_name.text=t.name,this.des_content.text=t.des},e.prototype._view_start_init=function(){},e}(AppModuleViewBase);__reflect(AdventureRewardDesView.prototype,"AdventureRewardDesView");var AdventureRewardDesVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(AdventureRewardDesVM.prototype,"AdventureRewardDesVM");var BottomSkillItemDesView=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.onComplete,e),e.skinName="resource/ZL/skins/bottom/BottomSkillItemDes.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.skill_item_des_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},e.prototype.onClose=function(){sirius.view_manager.pop_top_module()},e.prototype.onComplete=function(){console.log("onComplete")},e.prototype._view_before_init=function(){console.log(this.init_param);var t=this.init_param;this.skill_item_des_name.text=t.name,this.skill_item_des.text=t.des},e.prototype._view_start_init=function(){},e}(AppModuleViewBase);__reflect(BottomSkillItemDesView.prototype,"BottomSkillItemDesView");var BottomSkillItemDesVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(BottomSkillItemDesVM.prototype,"BottomSkillItemDesVM");var BottomSkillListItemDesView=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.onComplete,e),e.skinName="resource/ZL/skins/bottom/BottomSkillListItemDes.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),console.log(this.init_param),this.skill_list_item_des_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},e.prototype.onClose=function(){sirius.view_manager.pop_top_module()},e.prototype.onComplete=function(){console.log("onComplete")},e.prototype._view_before_init=function(){console.log("============"),console.log(this.init_param);var t=this.init_param;this.skill_list_item_des.text=t.des},e.prototype._view_start_init=function(){},e}(AppModuleViewBase);__reflect(BottomSkillListItemDesView.prototype,"BottomSkillListItemDesView");var ns_sirius;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.core_init=function(t){this._sirius=t},e}(t.sirius_base_object);t.sirius_element_module=e,__reflect(e.prototype,"ns_sirius.sirius_element_module")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(e){function i(t,i,o,r){void 0===t&&(t=null),void 0===i&&(i=null),void 0===o&&(o=0),void 0===r&&(r=null);var n=e.call(this)||this;return n._listener=t,n.anim_id=o,n._param=r,n._target_view=i,n}return __extends(i,e),i.prototype.init=function(t){return void 0===t&&(t=null),this.anim_active(t),this},i.prototype.anim_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.anim_deactive=function(){this._clock&&this._clock.remove(this)},i.prototype._before_destroy=function(){this.stop(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._param=null,this._target_view=null},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!0,configurable:!0}),i.prototype.is_disposable=function(){return!1},Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!0,configurable:!0}),i.prototype.start=function(){this._normalized_time=0,this._real_time=0,this._anim_duration=this.animation_duration(),this._is_animating=!0,this._reset_anim_properties()},i.prototype.stop=function(){this._is_animating=!1,this._normalized_time=0,this._real_time=0,this._reset_anim_properties()},i.prototype.update=function(t){this._is_animating&&(this._real_time+=t,this._normalized_time=this._real_time/this._anim_duration,this._normalized_time>1?this._anim_update(1):this._anim_update(this._normalized_time),this._normalized_time<1||(this.stop(),this._listener&&this._listener.single_anim_comp(this),this.is_disposable()&&this.destroy()))},i.prototype.util_linear_interpolation=function(t,e,i){return t+(e-t)*i},i}(t.sirius_base_object);t.single_animation=e,__reflect(e.prototype,"ns_sirius.single_animation",["ns_sirius.IAnimatable"])}(ns_sirius||(ns_sirius={}));var BottomSkillListItemDesVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AppModuleVMBase);__reflect(BottomSkillListItemDesVM.prototype,"BottomSkillListItemDesVM");var ConfigurationInfo=function(t){function e(){var e=t.call(this)||this;return e.layout_gap=40,e.skinName="resource/ZL/skins/configuration/configuration_info.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initInfo(),this.initDes()},e.prototype.initInfo=function(){},e.prototype.initDes=function(){this.scr_des.verticalScrollBar.autoVisibility=!1,this.scr_des.verticalScrollBar.visible=!1,this.scr_des.scrollPolicyV=eui.ScrollPolicy.ON;var t=new eui.VerticalLayout;t.gap=this.layout_gap,this.list_des.layout=t},e.prototype.setDesData=function(t){var e=new eui.ArrayCollection(t);console.log(e),this.list_des.dataProvider=e,this.list_des.itemRenderer=ConfigurationInfoDesItem},e.prototype.setBtnVisible=function(t){this.group_btn.visible=t},e.prototype.setBtnLabel=function(t){this.btn_label.text=t},e.prototype.setDesVisible=function(t){console.log("setDesVisible:"+t),this.group_des.visible=t},e.prototype.infoClick=function(){var t=this;this.group_info.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.group_des.visible?t.setDesVisible(!1):t.setDesVisible(!0)},this)},e}(eui.Component);__reflect(ConfigurationInfo.prototype,"ConfigurationInfo");var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e}return __extends(e,t),e.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},e.prototype._before_destroy=function(){console.log("======= sirius_view_base  destroy ======= "),console.log(this.constructor.name+" destroy"),this._view_before_destroy(),this.remove_all_children(),this.remove_from_parent()},e.prototype.attached_to_display_tree=function(t){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e.prototype.remove_all_children=function(){this.removeChildren()},e.prototype.remove_from_parent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.update_visible=function(t){this.visible=t},e.prototype.mark_as_fullfill=function(){this.percentWidth=100,this.percentHeight=100,this.x=0,this.y=0},e.prototype.set_bg_color=function(t,e){void 0===e&&(e=1);var i=new eui.Rect;return this.addChildAt(i,0),i.fillColor=t,i.percentWidth=100,i.percentHeight=100,i.alpha=e,i},e}(eui.Group);t.sirius_view_base=e,__reflect(e.prototype,"ns_sirius.sirius_view_base",["ns_sirius.Isirius_view_base","ns_sirius.Isirius_base_object"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._mstack=new Array,e._top=-1,e}return __extends(e,t),e.prototype.manager_init=function(t,e,i){this._root_view=t,this.layer_id=e,this._sirius=i},e.prototype.get_root_view=function(){return this._root_view},e.prototype._s_is_empty=function(){return this._top<0?!0:!1},e.prototype._s_push=function(t){this._top<0&&(this._top=-1),this._top++,this._mstack[this._top]=t},e.prototype._s_pop=function(){this._s_is_empty()||(this._mstack[this._top]=null,this._top--)},e.prototype._s_shift=function(){if(!this._s_is_empty()){for(var t=0;t<this._top;t++)this._mstack[t]=this._mstack[t+1];this._top--}},e.prototype._s_clear=function(){if(!this._s_is_empty()){for(var t=0;t<=this._top;t++)this._mstack[t]=null;this._top=-1}},e.prototype._s_top=function(){return this._s_is_empty()?null:this._mstack[this._top]},e.prototype._s_bottom=function(){return this._s_is_empty()?null:this._mstack[0]},e.prototype.show_view=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=null),this._root_view.addChild(t),t.attached_to_display_tree(e),this._s_push(t),this._update_container_visible(),t},e.prototype.clear_all=function(){if(!this._s_is_empty()){for(var t=0;t<=this._top;t++){var e=this._mstack[t];e.detaching_from_display_tree(),e.destroy()}this._s_clear(),this._update_container_visible()}},e.prototype.pop_top=function(){if(this._s_is_empty())return void console.log("视图栈已经为空了");var t=this._s_top();t.detaching_from_display_tree(),t.destroy(),this._s_pop(),this._update_container_visible()},e.prototype.shift_first=function(){if(this._s_is_empty())return void console.log("视图栈已经为空了");var t=this._s_bottom();t.detaching_from_display_tree(),t.destroy(),this._s_shift(),this._update_container_visible()},e.prototype.is_empty=function(){return this._s_is_empty()},e.prototype._update_container_visible=function(){this._s_is_empty()?this._root_view.update_visible(!1):this._root_view.update_visible(!0)},e}(t.sirius_base_object);t.layer_stack_manager=e,__reflect(e.prototype,"ns_sirius.layer_stack_manager",["ns_sirius.Isirius_layer_manager"])}(ns_sirius||(ns_sirius={}));var MonsterView=function(t){function e(){var e=t.call(this)||this;return e.arr_test=[{source:"Common_Icon_Monster_01_png",quality:"violet",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"violet",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"violet",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"violet",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"blue",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"orange",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"green",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"green",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"green",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"green",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"white",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"white",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"white",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"white",isSelected:!1},{source:"Common_Icon_Monster_01_png",quality:"white",isSelected:!1}],e.sort.visible=!0,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setArr(this.arr_test)},e.prototype.showInfo=function(){this.item_info&&(this.removeChild(this.item_info),this.item_info=null),this.item_info=new MonsterInfo,this.addChild(this.item_info),this.item_info.left=65,this.item_info.top=15,this.setTitle("请选择要布置的角色")},e.prototype._view_before_init=function(){console.log(this.init_param)},e.prototype._view_start_init=function(){},e.prototype.resetClick=function(){},e.prototype.saveClick=function(){var t=this,e=new ConfirmDialog;e.setInfo("还有房间未布置，保存后未布置的房间将会消失，是否结束布置？还有房间未布置，保存后未布置的房间将会消失，是否结束布置？还有房间未布置，保存后未布置的房间将会消失，是否结束布置？还有房间未布置，保存后未布置的房间将会消失，是否结束布置？还有房间未布置，保存后未布置的房间将会消失，是否结束布置？还有房间未布置，保存后未布置的房间将会消失，是否结束布置？还有房间未布置，保存后未布置的房间将会消失，是否结束布置？还有房间未布置，保存后未布置的房间将会消失，是否结束布置？"),e.setCallBack(function(){t.onClose()}),sirius.view_manager.show_alert(e)},e.prototype.itemClick=function(){console.log("====短按"),this.showInfo()},e.prototype.itemLongClick=function(){console.log("====长按")},e}(ConfigurationView);__reflect(MonsterView.prototype,"MonsterView");var GC_MetadataManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._characters=null,this._se_list=null},e.prototype.debug_init=function(){this._characters=new Array,this._characters.push(RES.getRes("character_debug_defence_json")),this._characters.push(RES.getRes("character_debug_assault_json")),this._characters.push(RES.getRes("character_debug_taling_json")),this._se_list=RES.getRes("se_list_json").se_list},e.prototype.debug_assault_template=function(){return this._characters[1]},e.prototype.debug_defence_template=function(){return this._characters[0]},e.prototype.debug_boss_template=function(){return this._characters[2]},e.prototype.find_se_metadata=function(t){for(var e=this._se_list.length,i=0;e>i;i++){var o=this._se_list[i];if(o.skill_no===t)return o}return null},e}(ns_sirius.sirius_base_object);__reflect(GC_MetadataManager.prototype,"GC_MetadataManager");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,o){function r(t){e.call(o,t)}function n(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),i.call(o))}var _=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(o,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(o,generateEUI2)},_)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var a=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(o,generateJSON.paths[t])},this):RES.getResByUrl(a,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(o,generateJSON.paths[t])},_)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(o,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var MapCellEntity=function(){function t(){this.state=0}return t.prototype.set=function(t,e,i,o,r,n){this.type=t,this.index=e,this.row=i,this.col=o,this.x=r,this.y=n},t.prototype.setType=function(t){this.type=t},t.prototype.getType=function(){return this.type},t.prototype.setIndex=function(t){this.index=t},t.prototype.getIndex=function(){return this.index},t.prototype.setRow=function(t){this.row=t},t.prototype.getRow=function(){return this.row},t.prototype.setCol=function(t){this.col=t},t.prototype.getCol=function(){return this.col},t.prototype.setX=function(t){this.x=t},t.prototype.getX=function(){return this.x},t.prototype.setY=function(t){this.y=t},t.prototype.getY=function(){return this.y},t.prototype.setState=function(t){this.state=t},t.prototype.getState=function(){return this.state},t}();__reflect(MapCellEntity.prototype,"MapCellEntity");var AppModel=function(){function t(){this.debug_flag=!1,this.crit_loader=new CriticalResLoader}return Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),t.prototype.app_init=function(){this.lm=new LocalizationManager,this.lm.choose_language("cn"),sirius.view_manager.switch_global_loading(!0),gp_core.prepare_game()},t.prototype.game_res_prepare_success=function(){sirius.view_manager.switch_global_loading(!1),gp_core.start_game()},t.prototype._post_login_req=function(){var t=this,e={userName:"hongang",socialId:"88888",headUrl:"from"};(new ns_sirius.common_req).post_fullurl("http://47.90.211.44:6001/user/login",e).then(function(e){sirius.view_manager.show_popup_text_msg("登录成功"),console.log("======= 登录成功 ======="),t._token=e.v.user.token,t._retrieve_map()},function(t){sirius.view_manager.switch_global_loading(!1),sirius.view_manager.show_popup_text_msg("登录失败"),console.log("======= 登录失败 =======")})},t.prototype._retrieve_map=function(){var t={token:this._token};(new ns_sirius.common_req).post("game/info",t).then(function(t){sirius.view_manager.switch_global_loading(!1),sirius.view_manager.show_popup_text_msg("获取游戏配置成功"),console.log("======= 获取游戏配置成功 ======="),gp_core.prepare_game()},function(t){sirius.view_manager.switch_global_loading(!1),sirius.view_manager.show_popup_text_msg("获取游戏配置失败"),console.log("======= 获取游戏配置失败 =======")})},t}();__reflect(AppModel.prototype,"AppModel");var BossBattleBehavior=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play_taling_skill=function(){},e}(BattleBehavior);__reflect(BossBattleBehavior.prototype,"BossBattleBehavior");var Move_Behavior_Anim=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.current_pos_3d=new egret.Point,e.current_scale_3d=new egret.Point,e._cur_pos_2d=new egret.Point,e._from_pos=new egret.Point,e._to_pos=new egret.Point,e}return __extends(e,t),e.prototype.animation_duration=function(){return 0},e.prototype._reset_anim_properties=function(){},Object.defineProperty(e.prototype,"cur_pos_2d",{get:function(){return this._cur_pos_2d},enumerable:!0,configurable:!0}),e.prototype.start_move=function(t){this.start(),this._anim_duration=t},e.prototype._anim_update=function(t){this._cur_pos_2d.x=this._from_pos.x+(this._to_pos.x-this._from_pos.x)*t,this._cur_pos_2d.y=this._from_pos.y+(this._to_pos.y-this._from_pos.y)*t,gp_core.ppc.cal_3d_pos(this._cur_pos_2d,this.current_pos_3d,this.current_scale_3d)},e}(ns_sirius.single_animation);__reflect(Move_Behavior_Anim.prototype,"Move_Behavior_Anim");var Move_Behavior=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.can_settle_down=!1,o._anim=new Move_Behavior_Anim(o),o}return __extends(e,t),Object.defineProperty(e.prototype,"anim",{get:function(){return this._anim},enumerable:!0,configurable:!0}),e.prototype._before_destroy=function(){this._anim.destroy(),this._anim=null,t.prototype._before_destroy.call(this)},e.prototype.behavior_active=function(){this._anim.anim_active()},e.prototype.behavior_deactive=function(){this._anim.anim_deactive()},e.prototype.move=function(t,e,i,o,r,n){this.target_room=e.layout_info.room_pos,this.target_slot=o,this.can_settle_down=n;var _=this._anim;i&&i.slot_index>=0?t.layout_info.get_slot_2dpos_by_index(i,_._from_pos):_._from_pos.copyFrom(t.layout_info.center_pos),this.can_settle_down?e.layout_info.get_slot_2dpos_by_index(o,_._to_pos):_._to_pos.copyFrom(e.layout_info.center_pos);var s=_._to_pos.x-_._from_pos.x,a=(_._to_pos.y-_._from_pos.y)*GPC_layout_config.distance_ratio_w_to_h,l=Math.sqrt(s*s+a*a),c=3,u=Math.floor(l/c),h=ns_sirius.anim_clock.frame_to_ms(u);_.start_move(h);var p=1;return r==RoomLinkDirection.RIGHT&&(p=2),p},e.prototype.single_anim_comp=function(t){var e=this._character;if(this.can_settle_down)e.enter_room_and_start_battle(this.target_room,this.target_slot);else{e.enter_room(this.target_room,this.target_slot);var i=this._s;i._continue_move()}},e}(Character_Behavior);__reflect(Move_Behavior.prototype,"Move_Behavior",["ns_sirius.Isingle_animation_listener"]);var FindRoom_Behavior=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fixed_direction_weights=[3e4,8e4,3e4,3e4],e.target_direction=0,e._previous_direction=-1,e}return __extends(e,t),e.prototype.behavior_active=function(){},e.prototype.behavior_deactive=function(){},e.prototype.find_next_room=function(t){this.cur_room_pos=t,this.target_room_pos=null;var e=gp_core.map.get_room_by_pos(t),i=this._array_multiply(this.fixed_direction_weights,e.link.availables,4),o=this._cal_direction_by_weights(i,this._previous_direction);this.target_direction=o;var r=e.link.neighbours[o];return r?(this.target_room_pos=r.layout_info.room_pos,this._previous_direction=RoomLinkInfo.reverse_direciton(o),!0):(console.error("未找到下一个房间 : "+o),console.log(e.link.neighbours),!1)},e.prototype._array_multiply=function(t,e,i){for(var o=new Array,r=0;i>r;r++)o[r]=t[r]*e[r];return o},e.prototype._cal_direction_by_weights=function(t,e){for(var i=0,o=new Array(4),r=0;4>r;r++)r==e?o[r]=0:o[r]=Math.random()*t[r];for(var r=1;4>r;r++)o[i]<o[r]&&(i=r);return i},e}(Character_Behavior);__reflect(FindRoom_Behavior.prototype,"FindRoom_Behavior");var GameBossEntity=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.skill_hierarchy_establish=function(e){t.prototype.skill_hierarchy_establish.call(this,e),this.taling_m=new TalingSkillManager,this.taling_m.manager_init(this,e)},e.prototype.trigger_new_attack=function(){this._binded_view.change_state(GC_CharacterAnimState.ATTACKING,1)},e.prototype.execute_current_skill=function(){this.taling_m.execute_skill(0)},e.prototype._machine_init=function(){this._machine=new CharacterMachine_Defender,this._machine.machine_initialize(this,this)},e.prototype.is_boss=function(){return!0},e.prototype.can_be_matched=function(){return this._machine?this._machine.get_current_state_enum()==CharacterMachineState.BATTLE_DEFENDER:!1},e.prototype.can_match=function(){return this.can_be_matched()},e.prototype._set_machine_initial_state=function(){this._machine.state_change(CharacterMachineState.BATTLE_DEFENDER)},e.prototype.sentence_to_death=function(){t.prototype.sentence_to_death.call(this),gp_core.end_game(),sirius.view_manager.show_popup_text_msg("游戏结束了")},e.prototype.character_type=function(){return GameCharacterType.Boss},e.prototype.bind_view=function(e){t.prototype.bind_view.call(this,e),this._binded_view.change_direction(2)},e}(GameCharacter);__reflect(GameBossEntity.prototype,"GameBossEntity");var GamePawn_Assault=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._machine_init=function(){this._machine=new CharacterMachine_Assaulter,this._machine.machine_initialize(this,this)},e.prototype._set_machine_initial_state=function(){this._machine&&this._machine.state_change(CharacterMachineState.MOVING)},e.prototype.can_be_matched=function(){return this._machine?this._machine.get_current_state_enum()==CharacterMachineState.BATTLE_ASSAULTER:!1},e.prototype.can_match=function(){return this.can_be_matched()},e.prototype.change_slot_sub_index=function(t){this._slot_pos.slot_sub_id=t},e.prototype.enter_room=function(t,e){this._room_pos.copyp(t),this._slot_pos.copyp(e)},e.prototype.enter_room_and_start_battle=function(t,e){this._machine&&(this.enter_room(t,e),this._machine.state_change(CharacterMachineState.BATTLE_ASSAULTER))},e.prototype.end_battle_and_start_move=function(){this._machine&&this._machine.state_change(CharacterMachineState.MOVING)},e.prototype.sentence_to_death=function(){t.prototype.sentence_to_death.call(this),gp_core.am.mark_assaulters_check_death()},e.prototype.character_type=function(){return GameCharacterType.Assaulter},e}(GameCharacter);__reflect(GamePawn_Assault.prototype,"GamePawn_Assault");var GamePawn_Defence=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._machine_init=function(){this._machine=new CharacterMachine_Defender,this._machine.machine_initialize(this,this)},e.prototype.can_be_matched=function(){return this._machine?this._machine.get_current_state_enum()==CharacterMachineState.BATTLE_DEFENDER:!1},e.prototype.can_match=function(){return this.can_be_matched()},e.prototype._set_machine_initial_state=function(){this._machine&&this._machine.state_change(CharacterMachineState.BATTLE_DEFENDER)},e.prototype.sentence_to_death=function(){t.prototype.sentence_to_death.call(this),gp_core.am.mark_defenders_check_death()},e.prototype.character_type=function(){return GameCharacterType.Defender},e.prototype.bind_view=function(e){t.prototype.bind_view.call(this,e),this._binded_view.change_direction(2)},e}(GameCharacter);__reflect(GamePawn_Defence.prototype,"GamePawn_Defence");var Character_RPPS_Battle=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.is_immortal=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"current_life_percent",{get:function(){if(0==this.total_life)return 0;var t=this.current_life/this.total_life;return t},enumerable:!0,configurable:!0}),e}(GamePlayEntityBase);__reflect(Character_RPPS_Battle.prototype,"Character_RPPS_Battle");var Character_Skill=function(){function t(){}return t}();__reflect(Character_Skill.prototype,"Character_Skill");var ActiveSkillManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._destroy_arr(this._active_skills),this._active_skills=null,t.prototype._before_destroy.call(this)},e.prototype._components_init=function(t,e){if(this._runnable=!1,e&&e.skills){this._active_skills=new Array;for(var i=e.skills,o=i.length,r=0;o>r;r++){var n=i[r];if(n.run_mode==GC_Skill_Metadata.RunMode.active){var _=new GC_ActiveSkill;_.skill_init(this._active_skills.length,t,n),this._active_skills.push(_)}}this._skill_count=this._active_skills.length,0!=this._skill_count&&(this._runnable=!0)}},e.prototype.find_skill_by_no=function(t){return this._find_skill_by_no_from_array(t,this._active_skills)},e.prototype.execute_current_skill=function(){if(this._runnable){var t=this._active_skills[this._active_skill_index];t.execute_sequence()}},e.prototype.new_attack_act=function(){if(!this._runnable)return-1;var t=this._choose_skill_and_start_cd();return this._all_active_cd_decrease(),t},e.prototype._choose_skill_and_start_cd=function(){var t=this._find_active_skill();return t?(t.start_cd(),this._active_skill_index=t.index,t._cache_action_id):-1},e.prototype._find_active_skill=function(){for(var t=this._active_skills.length,e=t-1;e>=0;e--){var i=this._active_skills[e];if(i.cd_counter.skill_can_release())return i}return null},e.prototype._all_active_cd_decrease=function(){for(var t=this._active_skills.length,e=t-1;e>=0;e--){var i=this._active_skills[e];i.cd_counter.cd_decrease()}},e}(SkillManagerBase);__reflect(ActiveSkillManager.prototype,"ActiveSkillManager");var PassiveSkillManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.find_skill_by_no=function(t){var e=this._find_skill_by_no_from_array(t,this._trigger_skills);if(e)return e;var i=this._find_skill_by_no_from_array(t,this._dmgcoe_A_skills);if(i)return i;var o=this._find_skill_by_no_from_array(t,this._dmgcoe_P_skills);return o?o:null},e.prototype._before_destroy=function(){this._destroy_arr(this._trigger_skills),this._trigger_skills=null,this._destroy_arr(this._dmgcoe_A_skills),this._dmgcoe_A_skills=null,this._destroy_arr(this._dmgcoe_P_skills),this._dmgcoe_P_skills=null,t.prototype._before_destroy.call(this)},e.prototype._components_init=function(t,e){if(e&&e.skills){var i=GC_Skill_Metadata.SkillType.passive;this._trigger_skills=new Array,this._dmgcoe_A_skills=new Array,this._dmgcoe_P_skills=new Array;for(var o=e.skills,r=o.length,n=0;r>n;n++){var _=o[n];if(_.run_mode==GC_Skill_Metadata.RunMode.trigger&&_.type==i){var s=new GC_PassiveSkill;s.skill_init(this._trigger_skills.length,t,_),this._trigger_skills.push(s)}else if(_.run_mode==GC_Skill_Metadata.RunMode.dmg_coe&&_.type==i)if(_.initiative==GC_Skill_Metadata.SkillInitiative.caller){var s=new GC_PassiveSkill;s.skill_init(this._dmgcoe_A_skills.length,t,_),this._dmgcoe_A_skills.push(s)}else{var s=new GC_PassiveSkill;s.skill_init(this._dmgcoe_P_skills.length,t,_),this._dmgcoe_P_skills.push(s)}}}},e.prototype.modify_coe_A=function(t,e,i){var o=this._dmgcoe_A_skills.length;if(0!=o)for(var r=0;o>r;r++)this._dmgcoe_A_skills[r].modify_coe_A(t,e,i)},e.prototype.modify_coe_P=function(t,e,i){var o=this._dmgcoe_P_skills.length;if(0!=o)for(var r=0;o>r;r++)this._dmgcoe_P_skills[r].modify_coe_P(t,e,i)},e.prototype.post_trigger_event=function(t){for(var e=this._trigger_skills.length,i=0;e>i;i++)this._trigger_event(this._trigger_skills[i],t)},e}(SkillManagerBase);__reflect(PassiveSkillManager.prototype,"PassiveSkillManager");var SEManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.has_se=function(t){var e=this.find_skill_by_no(t);return e?!0:!1},e.prototype.find_skill_by_no=function(t){var e=this._trigger_skills.find_element_by_property("cached_skill_no",t);if(e)return e;var i=this._dmgcoe_A_skills.find_element_by_property("cached_skill_no",t);if(i)return i;var o=this._dmgcoe_P_skills.find_element_by_property("cached_skill_no",t);return o?o:null},e.prototype._before_destroy=function(){this._trigger_skills.destroy(),this._trigger_skills=null,this._dmgcoe_A_skills.destroy(),this._dmgcoe_A_skills=null,this._dmgcoe_P_skills.destroy(),this._dmgcoe_P_skills=null,t.prototype._before_destroy.call(this)},e.prototype._components_init=function(t,e){if(e&&e.skills){GC_Skill_Metadata.SkillType.SE;this._trigger_skills=new ns_sirius.doubly_linked_list,this._dmgcoe_A_skills=new ns_sirius.doubly_linked_list,this._dmgcoe_P_skills=new ns_sirius.doubly_linked_list}},e.prototype.modify_coe_A=function(t,e,i){if(!this._dmgcoe_A_skills.is_empty())for(var o=this._dmgcoe_A_skills.get_head().next;o&&!o.is_tail();)o.element.modify_coe_A(t,e,i),o=o.next},e.prototype.modify_coe_P=function(t,e,i){if(!this._dmgcoe_P_skills.is_empty())for(var o=this._dmgcoe_P_skills.get_head().next;o&&!o.is_tail();)o.element.modify_coe_P(t,e,i),o=o.next},e.prototype.add_se=function(t,e){var i=this.find_skill_by_no(t);i?this._se_value_superposition(i,e):this._add_new_se(t,e)},e.prototype._add_new_se=function(t,e){var i=gp_core.mdm.find_se_metadata(t);
if(!i){var o="do not have this se : "+t;return void console.log(o)}this._weak_character._binded_view.play_se_status_change(0,i.skill_name);var r;i.run_mode==GC_Skill_Metadata.RunMode.trigger?(r=new GC_SESkill,r.skill_init(this._trigger_skills.length,this._weak_character,i),this._trigger_skills.push(r)):i.run_mode==GC_Skill_Metadata.RunMode.dmg_coe&&(i.initiative==GC_Skill_Metadata.SkillInitiative.caller?(r=new GC_SESkill,r.skill_init(this._dmgcoe_A_skills.length,this._weak_character,i),this._dmgcoe_A_skills.push(r)):(r=new GC_SESkill,r.skill_init(this._dmgcoe_P_skills.length,this._weak_character,i),this._dmgcoe_P_skills.push(r))),r&&r.set_value(e)},e.prototype._se_value_superposition=function(t,e){t.tweak_value(e),this._weak_character._binded_view.play_se_status_change(1,t.get_metadata().skill_name)},e.prototype._remove_skill=function(t){var e=this._trigger_skills.find_element_by_property("cached_skill_no",t);if(e)return this._trigger_skills.remove(e),e;var i=this._dmgcoe_A_skills.find_element_by_property("cached_skill_no",t);if(i)return this._dmgcoe_A_skills.remove(i),i;var o=this._dmgcoe_P_skills.find_element_by_property("cached_skill_no",t);return o?(this._dmgcoe_P_skills.remove(o),o):null},e.prototype.remove_all=function(){this._trigger_skills.destroy(),this._trigger_skills=new ns_sirius.doubly_linked_list,this._dmgcoe_A_skills.destroy(),this._dmgcoe_A_skills=new ns_sirius.doubly_linked_list,this._dmgcoe_P_skills.destroy(),this._dmgcoe_P_skills=new ns_sirius.doubly_linked_list},e.prototype.remove_all_harmful=function(){this._trigger_skills.remove_element_by_property("cached_advantage_type",GC_Skill_Metadata.SEAdvantageType.harmful),this._dmgcoe_A_skills.remove_element_by_property("cached_advantage_type",GC_Skill_Metadata.SEAdvantageType.harmful),this._dmgcoe_P_skills.remove_element_by_property("cached_advantage_type",GC_Skill_Metadata.SEAdvantageType.harmful)},e.prototype.remove_all_advantageous=function(){this._trigger_skills.remove_element_by_property("cached_advantage_type",GC_Skill_Metadata.SEAdvantageType.advantageous),this._dmgcoe_A_skills.remove_element_by_property("cached_advantage_type",GC_Skill_Metadata.SEAdvantageType.advantageous),this._dmgcoe_P_skills.remove_element_by_property("cached_advantage_type",GC_Skill_Metadata.SEAdvantageType.advantageous)},e.prototype.remove_se=function(t){var e=this._remove_skill(t);if(e){var i=e.get_metadata().skill_name;this._weak_character._binded_view.play_se_status_change(2,i),e.destroy()}},e.prototype.remove_se_by_object=function(t){var e=t.get_metadata();e.run_mode==GC_Skill_Metadata.RunMode.dmg_coe?e.initiative==GC_Skill_Metadata.SkillInitiative.caller?this._dmgcoe_A_skills.remove(t):this._dmgcoe_P_skills.remove(t):this._trigger_skills.remove(t)},e.prototype.post_trigger_event=function(t){var e=this;this._trigger_skills.loop(function(i){e._trigger_event(i.element,t)})},e}(SkillManagerBase);__reflect(SEManager.prototype,"SEManager");var lk_rtable=[{module_name:"Test",view:TestModuleView,vm:TestModuleVM}],TalingSkillManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._destroy_arr(this._taling_skills),this._taling_skills=null,t.prototype._before_destroy.call(this)},e.prototype._components_init=function(t,e){if(this._runnable=!1,e&&e.taling){this._taling_skills=new Array;for(var i=e.taling,o=i.length,r=0;o>r;r++){var n=i[r];if(n.run_mode==GC_Skill_Metadata.RunMode.manual){var _=new GC_TalingSkill;_.skill_init(this._taling_skills.length,t,n),this._taling_skills.push(_)}}this._skill_count=this._taling_skills.length,0!=this._skill_count&&(this._runnable=!0)}},e.prototype.find_skill_by_no=function(t){return this._find_skill_by_no_from_array(t,this._taling_skills)},e.prototype.execute_skill=function(t){if(this._runnable){var e=this._taling_skills[t];e.execute_sequence()}},e}(SkillManagerBase);__reflect(TalingSkillManager.prototype,"TalingSkillManager");var yxy_rtable=[{module_name:"GameWin",view:GameWinView,vm:GameWinVM},{module_name:"TestABC",view:TestABCView,vm:TestABCVM},{module_name:"TestTab",view:Tab1View,vm:Tab1VM}],zl_rtable=[{module_name:"BottomSkillListItemDes",view:BottomSkillListItemDesView,vm:BottomSkillListItemDesVM},{module_name:"BottomSkillItemDes",view:BottomSkillItemDesView,vm:BottomSkillItemDesVM},{module_name:"TrapView",view:TrapView,vm:TrapVM},{module_name:"MonsterView",view:MonsterView,vm:MonsterVM},{module_name:"AdventureEnterView",view:AdventureEnterView,vm:AdventureEnterVM},{module_name:"AdventureRewardDesView",view:AdventureRewardDesView,vm:AdventureRewardDesVM}],CharacterMachine_Assaulter=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.get_battle_behavior=function(){if(this.get_current_state_enum()==CharacterMachineState.DYING)return null;if(this.get_current_state_enum()==CharacterMachineState.MOVING)return null;if(this.get_current_state_enum()!=CharacterMachineState.BATTLE_ASSAULTER)throw"Assaulter get_battle_behavior   not in battle ? ";return this._s_battle.get_behavior_battle()},e.prototype._states_init=function(e){t.prototype._states_init.call(this,e),this._s_battle=new Character_State_Battle_Assaulter,this._s_battle.state_init(this,e),this._s_moving=new Character_State_MOVING,this._s_moving.state_init(this,e)},e.prototype.get_state_by_enum=function(e){switch(e){case CharacterMachineState.MOVING:return this._s_moving;case CharacterMachineState.BATTLE_ASSAULTER:return this._s_battle}return t.prototype.get_state_by_enum.call(this,e)},e.prototype._before_destroy=function(){this._s_moving.destroy(),this._s_moving=null,this._s_battle.destroy(),this._s_battle=null,t.prototype._before_destroy.call(this)},e}(CharacterMachine);__reflect(CharacterMachine_Assaulter.prototype,"CharacterMachine_Assaulter");var CharacterMachine_Defender=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.get_battle_behavior=function(){if(this.get_current_state_enum()==CharacterMachineState.DYING)return null;if(this.get_current_state_enum()!=CharacterMachineState.BATTLE_DEFENDER)throw"Defender get_battle_behavior   not in battle ? ";return this._s_battle.get_behavior_battle()},e.prototype._states_init=function(e){t.prototype._states_init.call(this,e),this._s_battle=new Character_State_Battle_Defender,this._s_battle.state_init(this,e)},e.prototype.get_state_by_enum=function(e){switch(e){case CharacterMachineState.BATTLE_DEFENDER:return this._s_battle}return t.prototype.get_state_by_enum.call(this,e)},e.prototype._before_destroy=function(){this._s_battle.destroy(),this._s_battle=null,t.prototype._before_destroy.call(this)},e}(CharacterMachine);__reflect(CharacterMachine_Defender.prototype,"CharacterMachine_Defender");var Character_State_BORN=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return CharacterMachineState.BORN},e.prototype.state_str=function(){return"BORN"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(CharacterStateBase);__reflect(Character_State_BORN.prototype,"Character_State_BORN");var Character_State_DYING=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return CharacterMachineState.DYING},e.prototype.state_str=function(){return"DYING"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null);var i=this._character.current_room();if(this._character.character_type()==GameCharacterType.Defender)i.defender_leave(this._character);else if(this._character.character_type()==GameCharacterType.Assaulter)i.assaulter_leave(this._character);else if(this._character.character_type()==GameCharacterType.Boss){var o=i;o.boss_leave(this._character)}},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(CharacterStateBase);__reflect(Character_State_DYING.prototype,"Character_State_DYING");var Character_State_ERROR=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return CharacterMachineState.ERROR},e.prototype.state_str=function(){return"ERROR"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(CharacterStateBase);__reflect(Character_State_ERROR.prototype,"Character_State_ERROR");var Character_State_MOVING=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._behavior_move.destroy(),this._behavior_move=null,this._behavior_findroom.destroy(),this._behavior_findroom=null,t.prototype._before_destroy.call(this)},e.prototype._behaviors_init=function(){this._behavior_move=new Move_Behavior(this._character,this),this._behavior_findroom=new FindRoom_Behavior(this._character,this)},e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return CharacterMachineState.MOVING},e.prototype.state_str=function(){return"MOVING"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._behavior_move.behavior_active(),this._behavior_findroom.behavior_active(),this._continue_move()},e.prototype.state_leave=function(t,e){void 0===e&&(e=null),this._behavior_move.behavior_deactive(),this._behavior_findroom.behavior_deactive()},e.prototype._syn_character_pos=function(){this._character._sm_modify_pos(this._behavior_move.anim.current_pos_3d,this._behavior_move.anim.current_scale_3d,this._behavior_move.anim.cur_pos_2d)},e.prototype._continue_move=function(){var t=this._character.get_room_pos(),e=this._character.get_slot_pos(),i=this._behavior_findroom.find_next_room(t);if(!i)return void this._machine.state_change(CharacterMachineState.ERROR,"find_room");var o=this._behavior_findroom.target_room_pos,r=this._behavior_findroom.target_direction,n=gp_core.map.get_room_by_pos(t),_=gp_core.map.get_room_by_pos(o),s=_.pawn_settle_down(this._character,this._character._buffer_new_slot_pos);s||(this._character._buffer_new_slot_pos.slot_index=-1);var a=this._behavior_move.move(n,_,e,this._character._buffer_new_slot_pos,r,s);this._character._sm_modify_view_orientation(a)},e}(CharacterStateBase);__reflect(Character_State_MOVING.prototype,"Character_State_MOVING");var Character_State_Battle_Assaulter=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.state_enum=function(){return CharacterMachineState.BATTLE_ASSAULTER},e.prototype.state_str=function(){return"BATTLE_ASSAULTER"},e.prototype.state_enter=function(e,i){void 0===i&&(i=null),t.prototype.state_enter.call(this,e,i),this._character._sm_modify_view_orientation(1),this._character.current_room().mark_match_again()},e}(Character_State_Battle);__reflect(Character_State_Battle_Assaulter.prototype,"Character_State_Battle_Assaulter");var Character_State_Battle_Defender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.state_enum=function(){return CharacterMachineState.BATTLE_DEFENDER},e.prototype.state_str=function(){return"BATTLE_DEFENDER"},e}(Character_State_Battle);__reflect(Character_State_Battle_Defender.prototype,"Character_State_Battle_Defender");var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Label);t.BaseLabel=e,__reflect(e.prototype,"game.BaseLabel")}(game||(game={}));var GC_TriggerEvent=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this.src=null,t.prototype._before_destroy.call(this)},e.prototype.evt_init=function(t,e){this.src=t,this.type=e},e}(GamePlayEntityBase);__reflect(GC_TriggerEvent.prototype,"GC_TriggerEvent");var GameMap=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._destroy_arr(this.rooms),this.rooms=null,this.boss_room&&(this.boss_room.destroy(),this.boss_room=null)},e.prototype.generate_map_layout=function(){this.birth_room=new BornRoomEntity,this.birth_room.room_layout_init(0,0);var t=gp_core.layout_config;this.rooms=new Array(t.element_count);for(var e=t.column_count,i=t.row_count,o=0;i>o;o++)for(var r=0;e>r;r++){var n=new CommonRoomEntity;n.room_layout_init(r,o);var _=n.layout_info.room_pos.unique_index;this.rooms[_]=n}this.boss_room=new BossRoomEntity,this.boss_room.room_layout_init(0,0),this.birth_room.link_generate(this);for(var o=0;o<t.element_count;o++)this.rooms[o].link_generate(this);this.boss_room.link_generate(this);var s=0;3==t.row_count?s=1:5==t.row_count&&(s=2);var a=gp_core.layout_config.rowcolumn_to_uindex(s,0);this.rooms[a].link.link_to_boss(this)},e.prototype.perspective_update=function(){for(var t=gp_core.map,e=t.rooms.length,i=0;e>i;i++){var o=t.rooms[i].layout_info;o.update_3d_layout()}t.birth_room.layout_info.update_3d_layout(),t.boss_room.layout_info.update_3d_layout()},e.prototype.assault_depth_update=function(){for(var t=this.rooms.length,e=0;t>e;e++){var i=this.rooms[e];i._room_type==RoomTypeEnum.ARENA&&i.depth_sort()}this.boss_room.depth_sort()},e.prototype.get_room_by_pos=function(t){if(!t||t.unique_index<0)return null;var i=t.unique_index;if(i==e.born_room_id)return this.birth_room;if(i==e.boss_room_id)return this.boss_room;var o=this.rooms.length;return i>o-1?null:this.rooms[i]},e.prototype.get_room_beneath_birth_room=function(){var t=gp_core.layout_config.row_count,e=gp_core.layout_config.column_count,i=0;return 3==t?i=gp_core.layout_config.rowcolumn_to_uindex(1,e-1):5==t&&(i=gp_core.layout_config.rowcolumn_to_uindex(2,e-1)),this.rooms[i]},e.prototype.get_common_room_count=function(){return this.rooms.length},e.prototype.get_common_room_by_index=function(t){return this.rooms[t]},e.prototype.get_boss_room=function(){return this.boss_room},e.prototype.get_birth_room=function(){return this.birth_room},e.prototype.debug_generate_defenders=function(){for(var t=this.rooms.length,e=0;t>e;e++){var i=this.rooms[e];i.layout_info.room_pos.unique_index;0==i.layout_info.room_pos.row_index&&(1==i.layout_info.room_pos.column_index||2==i.layout_info.room_pos.column_index||4==i.layout_info.room_pos.column_index)&&i.debug_generate_defenders(),1==i.layout_info.room_pos.row_index&&1==i.layout_info.room_pos.column_index&&i.debug_generate_defenders(),2==i.layout_info.room_pos.row_index&&(6==i.layout_info.room_pos.column_index||7==i.layout_info.room_pos.column_index||8==i.layout_info.room_pos.column_index)&&i.debug_generate_defenders()}this.boss_room.debug_generate_defenders()},e.born_room_id=998,e.boss_room_id=999,e.boss_slot_id=999,e}(GamePlayEntityBase);__reflect(GameMap.prototype,"GameMap");var MapRoomPosition=function(){function t(t,e,i){void 0===t&&(t=-1),void 0===e&&(e=-1),void 0===i&&(i=-1),this.unique_index=t,this.column_index=e,this.row_index=i}return t.prototype.copyp=function(t){this.unique_index=t.unique_index,this.column_index=t.column_index,this.row_index=t.row_index},t}();__reflect(MapRoomPosition.prototype,"MapRoomPosition");var MapRoomSlotPosition=function(){function t(t,e,i){void 0===t&&(t=-1),void 0===e&&(e=1),void 0===i&&(i=-1),this.slot_index=t,this.slot_sub_id=i,this.type=e}return t.prototype.copyp=function(t){this.slot_index=t.slot_index,this.slot_sub_id=t.slot_sub_id,this.type=t.type},t.empty_slot_pos=new t(-1,-1,-1),t}();__reflect(MapRoomSlotPosition.prototype,"MapRoomSlotPosition");var MapUniquePos=function(){function t(t,e){this.room=t,this.slot=e}return t}();__reflect(MapUniquePos.prototype,"MapUniquePos");var BornRoomEntity=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.loop_assault=function(t){},e.prototype.get_friendly=function(t){return null},e.prototype.get_enemy=function(t){return null},e.prototype.get_all=function(){return null},e.prototype.room_layout_init=function(t,e){this.layout_info=new RoomLayoutInfo,this.layout_info.born_layout_init()},e.prototype.link_generate=function(t){this.link=new RoomLinkInfo,this.link.born_link_init(t)},e.prototype.is_born_room=function(){return!0},e.prototype.assaulter_leave=function(t){return-1},e.prototype.defender_leave=function(t){return-1},e.prototype.pawn_settle_down=function(t,e){return!1},e.prototype.mark_match_again=function(){},e.prototype.depth_sort=function(){},e.prototype.post_trigger_event=function(t){},e}(RoomEntity);__reflect(BornRoomEntity.prototype,"BornRoomEntity");var BossRoomEntity=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.loop_assault=function(t){var e=this._slots_assault[0].length,i=this._slots_assault[1].length,o=this._slots_assault[2].length;e>0&&this._slots_assault[0].loop(function(e){t(e.element)}),i>0&&this._slots_assault[1].loop(function(e){t(e.element)}),o>0&&this._slots_assault[2].loop(function(e){t(e.element)})},e.prototype.assaulter_count=function(){var t=this._slots_assault[0].length,e=this._slots_assault[1].length,i=this._slots_assault[2].length;return t+e+i},e.prototype.has_assaulter=function(){return 0==this.assaulter_count()?!1:!0},e.prototype.get_friendly=function(t){return t==GameCharacterType.Assaulter?null:t==GameCharacterType.Defender?this._slots_defence:null},e.prototype.get_enemy=function(t){return t==GameCharacterType.Assaulter?this._slots_defence:(t==GameCharacterType.Defender,null)},e.prototype.get_all=function(){var t=new Array;return t},e.prototype._before_destroy=function(){this._slot_boss=null,this._slots_defence=null;for(var e=0;e<RoomEntity.SlotsMax;e++)this._slots_assault[e].destroy();this._slots_assault=null,t.prototype._before_destroy.call(this)},e.prototype.room_layout_init=function(t,e){this.layout_info=new BossRoomLayoutInfo,this.layout_info.layout_init(-1,-1),this._slots_defence=new Array(RoomEntity.SlotsMax),this._init_arr_by_null(this._slots_defence,RoomEntity.SlotsMax),this._slots_assault=new Array(RoomEntity.SlotsMax);for(var i=0;i<RoomEntity.SlotsMax;i++)this._slots_assault[i]=new ns_sirius.doubly_linked_list(i)},e.prototype.link_generate=function(t){this.link=new RoomLinkInfo,this.link.boss_link_init(t)},e.prototype.is_boss_room=function(){return!0},e.prototype.pawn_settle_down=function(t,e){return this._has_init?(this._push_new_assaulter(t,e),this._assaulter_slots_update(),gp_core.am.mark_assault_depth_update(),!0):!1},e.prototype.boss_leave=function(t){return 0},e.prototype.assaulter_leave=function(t){var e=t.get_slot_pos();if(!e)throw"slot pos should not be null";var i=e.slot_index;if(0>i)throw"slot index should not be negative";var o=this._slots_assault[i];return o.remove(t),this._assaulter_slots_update(),this._match_enemies(),0},e.prototype.defender_leave=function(t){var e=t.get_slot_pos();if(!e)throw"slot pos should not be null";var i=e.slot_index;if(0>i)throw"slot index should not be negative";return this._slots_defence[i]=null,this._match_enemies(),0},e.prototype.mark_match_again=function(){this._match_enemies()},e.prototype.depth_sort=function(){for(var t=0;t<RoomEntity.SlotsMax;t++){var e=this._slots_assault[t];if(!e.is_empty())for(var i=e.get_head().next;i&&!i.is_tail();){if(!i.element.is_dead()){var o=i.element._binded_view;o.parent.addChild(o)}i=i.next}}},e.prototype._assaulter_slots_update=function(){for(var t=0;t<RoomEntity.SlotsMax;t++){var e=this._slots_assault[t];if(!e.is_empty())for(var i=e.get_head().next,o=0;i&&!i.is_tail();){var r=i.element;r.change_slot_sub_index(o),o++,i=i.next}}},e.prototype._match_enemies=function(){var t=this._defence_slots_is_empty();t?this._match_assaulter_to_boss():(this._match_defender_to_assaulter(),this._match_assaulter_to_defenders()),this._match_boss_to_assaulter()},e.prototype._link_list_to_target=function(t,e){for(var i=t.get_head().next;i&&!i.is_tail();){var o=i.element;o.can_match()&&this._link_asymmetrical(o,e),i=i.next}},e.prototype._link_target_to_list=function(t,e){for(var i=e.get_head().next;i&&!i.is_tail();){var o=i.element;o.can_be_matched()&&this._link_asymmetrical(t,o),i=i.next}},e.prototype._unlink_list=function(t){for(var e=t.get_head().next;e&&!e.is_tail();){var i=e.element;this._unlink(i),e=e.next}},e.prototype._match_assaulter_to_boss=function(){var t=!1;this._slot_boss&&this._slot_boss.can_be_matched()&&(t=!0);for(var e=0;e<RoomEntity.SlotsMax;e++){var i=this._slots_assault[e];i.is_empty()||(t?this._link_list_to_target(i,this._slot_boss):this._unlink_list(i))}},e.prototype._match_assaulter_to_defenders=function(){for(var t=0;t<RoomEntity.SlotsMax;t++){var e=this._slots_assault[t];if(!e.is_empty()){var i=this._find_facing_defender(t);if(i)this._link_list_to_target(e,i);else{var o=this._find_living_defender();o?this._link_list_to_target(e,o):this._unlink_list(e)}}}},e.prototype._match_boss_to_assaulter=function(){if(this._slot_boss){this._slot_boss.can_match()||this._unlink(this._slot_boss);var t=this._find_living_assaulter();return t?void this._link_asymmetrical(this._slot_boss,t):void this._unlink(this._slot_boss)}},e.prototype._match_defender_to_assaulter=function(){for(var t=RoomEntity.SlotsMax,e=0;t>e;e++){var i=this._slots_defence[e];if(i&&i.can_match()){var o=this._find_facing_assaulter(e);if(o)this._link_asymmetrical(i,o);else{var r=this._find_living_assaulter();r?this._link_asymmetrical(i,r):this._unlink(i)}}}},e.prototype._find_shortest_list=function(){var t=this._slots_assault[0];return this._slots_assault[1].length<t.length&&(t=this._slots_assault[1]),this._slots_assault[2].length<t.length&&(t=this._slots_assault[2]),t},e.prototype._push_new_assaulter=function(t,e){var i=this._find_shortest_list();e.slot_index=i.list_id,e.slot_sub_id=i.length,i.push(t)},e.prototype._defence_slots_is_empty=function(){for(var t=0;t<RoomEntity.SlotsMax;t++)if(this._slots_defence[t])return!1;return!0},e.prototype._assaulter_slots_is_empty=function(){for(var t=0;t<RoomEntity.SlotsMax;t++)if(!this._slots_assault[t].is_empty())return!1;return!0},e.prototype._find_facing_defender=function(t){var e=this._slots_defence[t];return e&&e.can_be_matched()?e:null},e.prototype._find_living_defender=function(){for(var t=0;t<RoomEntity.SlotsMax;t++){var e=this._find_facing_defender(t);if(e)return e}return null},e.prototype._find_facing_assaulter=function(t){var e=this._slots_assault[t];if(e.is_empty())return null;var i=e.get_head().next.element;return i.can_be_matched()?i:null},e.prototype._find_living_assaulter=function(){for(var t=0;t<RoomEntity.SlotsMax;t++){var e=this._find_facing_assaulter(t);if(e)return e}return null},e.prototype.debug_generate_defenders=function(){var t=gp_core.mdm.debug_defence_template();this.room_type_init(RoomTypeEnum.BOSS,-1);for(var e=RoomEntity.SlotsMax,i=0;e>i;i++){var o=gp_core.am.born_pawn(GameCharacterType.Defender);this._slots_defence[i]=o,o.skill_hierarchy_establish(t),o.put_on_the_map_and_run(this.layout_info.room_pos,new MapRoomSlotPosition(i,GameCharacterType.Defender))}var r=gp_core.am.born_boss();this._slot_boss=r,r.skill_hierarchy_establish(gp_core.mdm.debug_boss_template()),r.put_on_the_map_and_run(this.layout_info.room_pos,new MapRoomSlotPosition(GameMap.boss_slot_id,GameCharacterType.Boss))},e.prototype.post_trigger_event=function(t){},e}(RoomEntity);__reflect(BossRoomEntity.prototype,"BossRoomEntity");var CommonRoomEntity=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.loop_assault=function(t){if(this._has_init)for(var e=this._slots_assault.length,i=0;e>i;i++){var o=this._slots_assault[i];o&&!o.is_dead()&&t(o)}var r=this.layout_info.room_pos.unique_index;gp_core.am.loop_moving_character_by_room(r,t)},e.prototype.get_friendly=function(t){return t==GameCharacterType.Assaulter?this._slots_assault:t==GameCharacterType.Defender?this._slots_defence:null},e.prototype.get_enemy=function(t){return t==GameCharacterType.Assaulter?this._slots_defence:t==GameCharacterType.Defender?this._slots_assault:null},e.prototype.get_all=function(){var t=new Array;return t.concat(this._slots_assault).concat(this._slots_defence),t},e.prototype._before_destroy=function(){this._slots_defence=null,this._slots_assault=null,t.prototype._before_destroy.call(this)},e.prototype.room_type_init=function(e,i){t.prototype.room_type_init.call(this,e,i),this._slots_defence=new Array(RoomEntity.SlotsMax),this._slots_assault=new Array(RoomEntity.SlotsMax),this._init_arr_by_null(this._slots_defence,RoomEntity.SlotsMax),this._init_arr_by_null(this._slots_assault,RoomEntity.SlotsMax)},e.prototype.pawn_settle_down=function(t,e){if(this._room_type!=RoomTypeEnum.ARENA)return!1;if(this.defence_slots_is_empty())return!1;var i=this.find_free_assault_slot();return 0>i?!1:(e.slot_index=i,this._slots_assault[i]=t,gp_core.am.mark_assault_depth_update(),!0)},e.prototype.assaulter_leave=function(t){if(this._room_type!=RoomTypeEnum.ARENA)return-1;var e=t.get_slot_pos();if(!e)throw"slot pos should not be null";var i=e.slot_index;if(!(0>i))return this._slots_assault[i]=null,this._match_enemies(),0},e.prototype.defender_leave=function(t){if(this._room_type!=RoomTypeEnum.ARENA)return-1;var e=t.get_slot_pos();if(!e)throw"slot pos should not be null";var i=e.slot_index;if(0>i)throw"slot index should not be negative";return this._slots_defence[i]=null,this._match_enemies(),this._check_assaulters_should_leave(),0},e.prototype._check_assaulters_should_leave=function(){var t=this.find_living_defender();if(!t)for(var e=RoomEntity.SlotsMax,i=0;e>i;i++){var o=this._slots_assault[i];o&&(o.end_battle_and_start_move(),this._slots_assault[i]=null)}},e.prototype.mark_match_again=function(){this._match_enemies()},e.prototype._match_enemies=function(){if(!this._slots_defence)throw"?? should have defenders";for(var t=RoomEntity.SlotsMax,e=0;t>e;e++){var i=this._slots_defence[e];if(i&&i.can_match()){var o=this.find_facing_assaulter(e);if(o)this._link_asymmetrical(i,o);else{var r=this.find_living_assaulter();r?this._link_asymmetrical(i,r):this._unlink(i)}}}for(var e=0;t>e;e++){var n=this._slots_assault[e];if(n&&n.can_match()){var _=this.find_facing_defender(e);if(_)this._link_asymmetrical(n,_);else{var s=this.find_living_defender();s?this._link_asymmetrical(n,s):this._unlink(n)}}}},e.prototype.depth_sort=function(){for(var t=RoomEntity.SlotsMax,e=0;t>e;e++){var i=this._slots_assault[e];if(i){if(i.is_dead())continue;i._binded_view.parent.addChild(i._binded_view)}}},e.prototype.find_free_assault_slot=function(){for(var t=0;t<RoomEntity.SlotsMax;t++)if(null==this._slots_assault[t])return t;return-1},e.prototype.find_facing_assaulter=function(t){var e=this._slots_assault[t];return e&&e.can_be_matched()?e:null},e.prototype.find_living_assaulter=function(){for(var t=0;t<RoomEntity.SlotsMax;t++){var e=this._slots_assault[t];if(e&&e.can_be_matched())return e}return null},e.prototype.find_facing_defender=function(t){var e=this._slots_defence[t];return e&&e.can_be_matched()?e:null},e.prototype.find_living_defender=function(){for(var t=0;t<RoomEntity.SlotsMax;t++){var e=this._slots_defence[t];if(e&&e.can_be_matched())return e}return null},e.prototype.assault_slots_is_empty=function(){for(var t=0;t<RoomEntity.SlotsMax;t++)if(this._slots_assault[t])return!1;return!0},e.prototype.defence_slots_is_empty=function(){for(var t=0;t<RoomEntity.SlotsMax;t++)if(this._slots_defence[t])return!1;return!0},e.prototype.debug_generate_defenders=function(){var t=RES.getRes("defence_num_json");t&&t.fill_room?this._debug_fullfill():this._debug_generate_single()},e.prototype._debug_generate_single=function(){var t=gp_core.mdm.debug_defence_template();this.room_type_init(RoomTypeEnum.ARENA,-1);var e=gp_core.am.born_pawn(GameCharacterType.Defender);this._slots_defence[0]=e,e.skill_hierarchy_establish(t),e.put_on_the_map_and_run(this.layout_info.room_pos,new MapRoomSlotPosition(0,GameCharacterType.Defender))},e.prototype._debug_fullfill=function(){var t=gp_core.mdm.debug_defence_template();this.room_type_init(RoomTypeEnum.ARENA,-1);for(var e=RoomEntity.SlotsMax,i=0;e>i;i++){var o=gp_core.am.born_pawn(GameCharacterType.Defender);this._slots_defence[i]=o,o.skill_hierarchy_establish(t),o.put_on_the_map_and_run(this.layout_info.room_pos,new MapRoomSlotPosition(i,GameCharacterType.Defender))}},e.prototype.post_trigger_event=function(t){},e}(RoomEntity);__reflect(CommonRoomEntity.prototype,"CommonRoomEntity");var ConfigurationInfoDesItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/ZL/skins/configuration/configuration_info_des_item.exml",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.title.text=this.data.title,"list"===this.data.type){var t=new eui.List;t.minHeight=200,this.content.addChild(t);var e=new eui.VerticalLayout;e.gap=20,t.layout=e;var i=new eui.ArrayCollection(this.data.list);t.dataProvider=i,t.itemRenderer=ConfigurationInfoDesSubItem}else{this.content.height=38;for(var o=0;o<this.data.recipes.length;o++){var r=new eui.Image;if(this.content.addChild(r),r.left=38*o+18*o,r.width=38,r.height=38,r.verticalCenter=0,r.source=this.data.recipes[o],o!==this.data.recipes.length-1){var n=new eui.Image;this.content.addChild(n),n.left=38*(o+1)+18*o,n.width=18,n.height=18,n.verticalCenter=0,n.source="Unit_Icon_Plus_png"}}}},e}(eui.ItemRenderer);__reflect(ConfigurationInfoDesItem.prototype,"ConfigurationInfoDesItem");var BossRoomLayoutInfo=function(t){function e(){var e=t.call(this)||this;return e._boss_pos2=new egret.Point,e._boss_pos3=new egret.Point,e}return __extends(e,t),e.prototype._before_destroy=function(){this._slots_assault_2d_from=null,this._slots_assault_2d_to=null,this._slots_assault_3d_from=null,this._slots_assault_3d_to=null,t.prototype._before_destroy.call(this)},e.prototype.layout_init=function(t,e){var i=gp_core.layout_config;this.room_pos=new MapRoomPosition(GameMap.boss_room_id);var o=i.boss_w,r=i.boss_h;this.view_pos.x=i.boss_view_x,this.view_pos.y=i.boss_view_y,this.center_pos.x=this.view_pos.x+Math.round(.5*o),this.center_pos.y=this.view_pos.y+Math.round(.5*r),this.view_w=o,this.view_h=r,this._def_slots_init(),this._assualt_slots_init(),this._boss_position_init()},e.prototype._boss_position_init=function(){var t=gp_core.layout_config;this._boss_pos2.x=this.view_pos.x+.5*t.cell_w,this._boss_pos2.y=this.center_pos.y},e.prototype._slot_orig_x=function(){var t=gp_core.layout_config;return this.view_pos.x+t.cell_w},e.prototype._slot_orig_y=function(){var t=gp_core.layout_config;return this.view_pos.y+.5*t.cell_h},e.prototype._assualt_slots_init=function(){var t=RoomEntity.SlotsMax,e=gp_core.layout_config;this._slots_assault_2d_from=Array(t),this._slots_assault_2d_to=Array(t),this._slots_assault_3d_from=Array(t),this._slots_assault_3d_to=Array(t);for(var i=this._slot_orig_x(),o=e.cell_h,r=Math.floor(e.cell_h/3),n=this._slot_orig_y(),_=0;t>_;_++){var s=n+o-r*(t-1-_);this._slots_assault_2d_from[_]=new egret.Point(i+e.cell_w-this._slot_inner_gap(),s),this._slots_assault_2d_to[_]=new egret.Point(this.view_pos.x+this.view_w,s),this._slots_assault_3d_from[_]=new egret.Point(0,0),this._slots_assault_3d_to[_]=new egret.Point(0,0)}},e.prototype.update_3d_layout=function(){gp_core.ppc.cal_3d_pos(this.center_pos,this.d3_point_local,this.d3_scale),gp_core.ppc.cal_3d_pos(this._boss_pos2,this._boss_pos3,null);for(var t=RoomEntity.SlotsMax,e=0;t>e;e++)gp_core.ppc.cal_3d_pos(this._slots_def_2d[e],this._slots_def_3d[e],null);for(var e=0;t>e;e++)gp_core.ppc.cal_3d_pos(this._slots_assault_2d_from[e],this._slots_assault_3d_from[e],null),gp_core.ppc.cal_3d_pos(this._slots_assault_2d_to[e],this._slots_assault_3d_to[e],null)},e.prototype.get_slot_3dpos_by_slot=function(t,e,i){if(t.type==GameCharacterType.Boss)return e.copyFrom(this._boss_pos3),void i.copyFrom(this._boss_pos2);if(!t||t.slot_index<0)return e.copyFrom(this.d3_point_local),void i.copyFrom(this.center_pos);var o=RoomEntity.SlotsMax;return t.slot_index>o-1?(e.copyFrom(this.d3_point_local),void i.copyFrom(this.center_pos)):void(t.type==GameCharacterType.Defender?(e.copyFrom(this._slots_def_3d[t.slot_index]),i.copyFrom(this._slots_def_2d[t.slot_index])):t.type==GameCharacterType.Assaulter?(e.y=this._slots_assault_3d_from[t.slot_index].y,e.x=this._linear_interpolation(this._slots_assault_3d_from[t.slot_index].x,this._slots_assault_3d_to[t.slot_index].x,t.slot_sub_id),i.y=this._slots_assault_2d_from[t.slot_index].y,i.x=this._linear_interpolation(this._slots_assault_2d_from[t.slot_index].x,this._slots_assault_2d_to[t.slot_index].x,t.slot_sub_id)):(e.copyFrom(this.d3_point_local),i.copyFrom(this.center_pos)))
},e.prototype.get_slot_2dpos_by_index=function(t,e){return!t||t.slot_index<0?(e.x=this.center_pos.x,void(e.y=this.center_pos.y)):t.type==GameCharacterType.Boss?(e.x=this._boss_pos2.x,void(e.y=this._boss_pos2.y)):void(t.type==GameCharacterType.Defender?(e.x=this._slots_def_2d[t.slot_index].x,e.y=this._slots_def_2d[t.slot_index].y):t.type==GameCharacterType.Assaulter?(e.y=this._slots_assault_2d_from[t.slot_index].y,e.x=this._linear_interpolation(this._slots_assault_2d_from[t.slot_index].x,this._slots_assault_2d_to[t.slot_index].x,t.slot_sub_id)):(e.x=this.center_pos.x,e.y=this.center_pos.y))},e.prototype._linear_interpolation=function(t,e,i){var o=3,r=(e-t)/o;if(o>=i){var n=t+i*r;return n}return e},e}(RoomLayoutInfo);__reflect(BossRoomLayoutInfo.prototype,"BossRoomLayoutInfo");var ConfigurationInfoDesSubItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/ZL/skins/configuration/configuration_info_des_sub_item.exml",e}return __extends(e,t),e.prototype.dataChanged=function(){this.title.textColor=this.data.special?16484643:8284991,this.title.text=this.data.name,this.des.text=this.data.des},e}(eui.ItemRenderer);__reflect(ConfigurationInfoDesSubItem.prototype,"ConfigurationInfoDesSubItem");var RoomLinkDirection=function(){function t(){}return t.FRONT=0,t.LEFT=1,t.BACK=2,t.RIGHT=3,t}();__reflect(RoomLinkDirection.prototype,"RoomLinkDirection");var RoomLinkInfo=function(t){function e(){var e=t.call(this)||this;return e.availables=[0,0,0,0],e.neighbours=[null,null,null,null],e}return __extends(e,t),e.reverse_direciton=function(t){switch(t){case RoomLinkDirection.FRONT:return RoomLinkDirection.BACK;case RoomLinkDirection.BACK:return RoomLinkDirection.FRONT;case RoomLinkDirection.LEFT:return RoomLinkDirection.RIGHT;case RoomLinkDirection.RIGHT:return RoomLinkDirection.LEFT}return-1},e.prototype._before_destroy=function(){this.availables=null,this.neighbours=null},e.prototype.link_init=function(t,e,i){var o=gp_core.layout_config.rowcolumn_to_uindex(e+1,i),r=gp_core.layout_config.rowcolumn_to_uindex(e,i-1),n=gp_core.layout_config.rowcolumn_to_uindex(e-1,i),_=gp_core.layout_config.rowcolumn_to_uindex(e,i+1);this.neighbours[RoomLinkDirection.FRONT]=t.get_common_room_by_index(o),this.neighbours[RoomLinkDirection.LEFT]=t.get_common_room_by_index(r),this.neighbours[RoomLinkDirection.BACK]=t.get_common_room_by_index(n),this.neighbours[RoomLinkDirection.RIGHT]=t.get_common_room_by_index(_),this.availables[0]=this.neighbours[RoomLinkDirection.FRONT]?1:0,this.availables[1]=this.neighbours[RoomLinkDirection.LEFT]?1:0,this.availables[2]=this.neighbours[RoomLinkDirection.BACK]?1:0,this.availables[3]=this.neighbours[RoomLinkDirection.RIGHT]?1:0},e.prototype.born_link_init=function(t){this.neighbours[RoomLinkDirection.FRONT]=t.get_room_beneath_birth_room(),this.neighbours[RoomLinkDirection.LEFT]=null,this.neighbours[RoomLinkDirection.BACK]=null,this.neighbours[RoomLinkDirection.RIGHT]=null,this.availables[0]=1,this.availables[1]=0,this.availables[2]=0,this.availables[3]=0},e.prototype.boss_link_init=function(t){this.neighbours[RoomLinkDirection.FRONT]=null,this.neighbours[RoomLinkDirection.LEFT]=null,this.neighbours[RoomLinkDirection.BACK]=null,this.neighbours[RoomLinkDirection.RIGHT]=null,this.availables[0]=0,this.availables[1]=0,this.availables[2]=0,this.availables[3]=0},e.prototype.link_to_boss=function(t){this.neighbours[RoomLinkDirection.FRONT]=t.get_boss_room(),this.availables[0]=1},e}(GamePlayEntityBase);__reflect(RoomLinkInfo.prototype,"RoomLinkInfo");var RoomBossSlotEntity=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(GamePlayEntityBase);__reflect(RoomBossSlotEntity.prototype,"RoomBossSlotEntity");var RoomSlotEntity=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(GamePlayEntityBase);__reflect(RoomSlotEntity.prototype,"RoomSlotEntity");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var GC_Character_Metadata;!function(t){var e=function(){function t(){}return t.prototype.reflect_ur=function(t){var e=typeof t;"string"===e?this.unlock_rank=parseInt(t):"number"===e&&(this.unlock_rank=t)},t}();t.character_skill_ref=e,__reflect(e.prototype,"GC_Character_Metadata.character_skill_ref")}(GC_Character_Metadata||(GC_Character_Metadata={}));var GC_Comparer_Metadata;!function(t){var e;!function(t){t[t.equal=0]="equal",t[t.bigger_than=1]="bigger_than",t[t.smaller_than=2]="smaller_than",t[t.bigger_equal=3]="bigger_equal",t[t.smaller_equal=4]="smaller_equal"}(e=t.Operator_Type||(t.Operator_Type={}))}(GC_Comparer_Metadata||(GC_Comparer_Metadata={}));var GC_Logic_Expression;!function(t){var e;!function(t){t[t.single=0]="single",t[t.union=1]="union"}(e=t.Logic_Expression_Type||(t.Logic_Expression_Type={}));var i;!function(t){t[t.and=0]="and",t[t.or=1]="or",t[t.not=2]="not"}(i=t.Operator_Type||(t.Operator_Type={}))}(GC_Logic_Expression||(GC_Logic_Expression={}));var GC_Molecule_Metadata;!function(t){var e;!function(t){t[t.se=0]="se",t[t.logic_expression=1]="logic_expression"}(e=t.requirementType||(t.requirementType={}))}(GC_Molecule_Metadata||(GC_Molecule_Metadata={}));var GC_Numeric_Expression;!function(t){var e;!function(t){t[t.add=0]="add",t[t.subtract=1]="subtract",t[t.multiply=2]="multiply",t[t.divide=3]="divide"}(e=t.OperatorType||(t.OperatorType={}));var i;!function(t){t[t["const"]=0]="const",t[t.character_property=1]="character_property",t[t.process_output=2]="process_output",t[t.se_property=3]="se_property"}(i=t.NumericSrcType||(t.NumericSrcType={})),t.character_properties=["current_attack","total_life","current_life","current_life_percent"],t.status_effect_properties=["se_value"];var o;!function(t){t[t.single=0]="single",t[t.simple=1]="simple",t[t.array=2]="array",t[t.tree=3]="tree"}(o=t.ExpressionType||(t.ExpressionType={}))}(GC_Numeric_Expression||(GC_Numeric_Expression={}));var GC_Process_Metadata;!function(t){var e;!function(t){t[t.nil=0]="nil",t[t.dmg=1]="dmg",t[t.ik=2]="ik",t[t.heal=3]="heal",t[t.character_modify=4]="character_modify",t[t.se_modify=5]="se_modify",t[t.se_add=6]="se_add",t[t.se_remove=7]="se_remove",t[t.se_modify_quick=8]="se_modify_quick",t[t.cd_modify=9]="cd_modify",t[t.cd_terminate=10]="cd_terminate",t[t.cd_modify_quick=11]="cd_modify_quick",t[t.selector=100]="selector",t[t.conditional=101]="conditional",t[t.probability=102]="probability",t[t.dmg_modifier=500]="dmg_modifier"}(e=t.GC_ProcessType||(t.GC_ProcessType={}));var i;!function(t){t[t.Single=0]="Single",t[t.Room=1]="Room",t[t.Global=2]="Global"}(i=t.ScopeE||(t.ScopeE={}));var o;!function(t){t[t.Self=0]="Self",t[t.Facing=1]="Facing",t[t.Focus=2]="Focus",t[t.Friendly=3]="Friendly",t[t.Enemy=4]="Enemy",t[t.All=5]="All",t[t.Enemy_Others=6]="Enemy_Others"}(o=t.TargetE||(t.TargetE={}));var r;!function(t){t[t.All=0]="All",t[t.Random_One=1]="Random_One",t[t.Random_Two=2]="Random_Two"}(r=t.RegulationE||(t.RegulationE={}));var n;!function(t){t[t.simple=0]="simple",t[t.complex=1]="complex"}(n=t.Process_SelectorType||(t.Process_SelectorType={}));var _;!function(t){t[t.water=0]="water",t[t.fire=1]="fire",t[t.wind=2]="wind",t[t.earth=3]="earth",t[t.light=4]="light",t[t.darkness=5]="darkness",t[t.spirit=6]="spirit",t[t.physics=7]="physics",t[t.same_as_character=100]="same_as_character"}(_=t.Dmg_Element||(t.Dmg_Element={}));var s;!function(t){t[t.specific=0]="specific",t[t.all_advantageous=1]="all_advantageous",t[t.all_harmful=2]="all_harmful",t[t.all=3]="all"}(s=t.SERemoveType||(t.SERemoveType={}));var a;!function(t){t[t.terminate=0]="terminate",t[t.offset=1]="offset"}(a=t.ModifyCDType||(t.ModifyCDType={}));var l;!function(t){t[t.basic=0]="basic",t[t.element=1]="element",t[t.global_1=2]="global_1",t[t.global_2=3]="global_2"}(l=t.DmgCoePosition||(t.DmgCoePosition={}))}(GC_Process_Metadata||(GC_Process_Metadata={}));var GC_Skill_Metadata;!function(t){var e;!function(t){t[t.caller=0]="caller",t[t.callee=1]="callee"}(e=t.SkillInitiative||(t.SkillInitiative={}));var i;!function(t){t[t.active=0]="active",t[t.trigger=1]="trigger",t[t.dmg_coe=2]="dmg_coe",t[t.manual=3]="manual"}(i=t.RunMode||(t.RunMode={}));var o;!function(t){t[t.active=0]="active",t[t.passive=1]="passive",t[t.SE=2]="SE",t[t.taling=3]="taling"}(o=t.SkillType||(t.SkillType={}));var r;!function(t){t[t.advantageous=0]="advantageous",t[t.harmful=1]="harmful"}(r=t.SEAdvantageType||(t.SEAdvantageType={}));var n;!function(t){t[t.Action=0]="Action",t[t.Before_Attack=1]="Before_Attack",t[t.Hit=2]="Hit",t[t.NotHit=3]="NotHit",t[t.After_Attack=4]="After_Attack",t[t.Dead=5]="Dead"}(n=t.Process_Trigger_Event||(t.Process_Trigger_Event={})),t.Trigger_Event_Count=6;var _;!function(t){t[t.self=0]="self",t[t.facing=1]="facing",t[t.room_friendly=2]="room_friendly",t[t.room_enemy=3]="room_enemy",t[t.room_all=4]="room_all"}(_=t.TriggerScope||(t.TriggerScope={}))}(GC_Skill_Metadata||(GC_Skill_Metadata={}));var ConfigurationListItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/ZL/skins/configuration/configuration_list_item.exml",e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.onComplete,e),e}return __extends(e,t),e.prototype.onComplete=function(){},e.prototype.dataChanged=function(){this.selected_img.source=this.data.isSelected?"Common_Icon_Frame_Selection_png":"";var t="";switch(this.data.quality){case"violet":t="Common_Icon_Frame_Violet_png";break;case"blue":t="Common_Icon_Frame_Blue_png";break;case"orange":t="Common_Icon_Frame_Orange_png";break;case"green":t="Common_Icon_Frame_Green_png";break;case"white":t="Common_Icon_Frame_White_png";break;default:t="Common_Icon_BlockBg_02_png"}this.border.source=t,this.icon.source=this.data.source},e}(eui.ItemRenderer);__reflect(ConfigurationListItem.prototype,"ConfigurationListItem");var Numeric_Expression_Calculator;!function(t){function e(t,e){return t.value}function i(t,e){var i=0;return i=t.initiative==GC_Skill_Metadata.SkillInitiative.caller?e._weak_from.md_battle[t.property_name]:e._weak_to.md_battle[t.property_name]}function o(t,e){return e._weak_to.md_battle[t.property_name]}function r(t,e){var i=e._weak_skill.find_process(t.pid),o=i.output;return o[t.res_type]}function n(t,e){return e._weak_skill.se_value}function _(t){var e=null;switch(t){case GC_Numeric_Expression.ExpressionType.single:e=new l;break;case GC_Numeric_Expression.ExpressionType.simple:e=new c;break;case GC_Numeric_Expression.ExpressionType.array:break;case GC_Numeric_Expression.ExpressionType.tree:}return e}var s=function(){function t(){}return t.prototype.destroy=function(){this._value_fun=null},t.prototype.init=function(t){if(t.src_type==GC_Numeric_Expression.NumericSrcType["const"])this._value_fun=e;else if(t.src_type==GC_Numeric_Expression.NumericSrcType.character_property){var _=t.src;_.initiative==GC_Skill_Metadata.SkillInitiative.caller?this._value_fun=i:this._value_fun=o}else t.src_type==GC_Numeric_Expression.NumericSrcType.process_output?this._value_fun=r:t.src_type==GC_Numeric_Expression.NumericSrcType.se_property&&(this._value_fun=n)},t.prototype.get_value=function(t,e){return this._value_fun(t.src,e)},t}();__reflect(s.prototype,"Numeric");var a=function(){function t(){}return t.prototype.destroy=function(){this._n1.destroy(),this._n1=null,this._n2.destroy(),this._n2=null,this._op_fun=null},t.prototype.init=function(t){this._n1=new s,this._n1.init(t.n1),this._n2=new s,this._n2.init(t.n2),t.operator==GC_Numeric_Expression.OperatorType.add?this._op_fun=function(t,e){return t+e}:t.operator==GC_Numeric_Expression.OperatorType.subtract?this._op_fun=function(t,e){return t-e}:t.operator==GC_Numeric_Expression.OperatorType.multiply?this._op_fun=function(t,e){return t*e}:t.operator==GC_Numeric_Expression.OperatorType.divide&&(this._op_fun=function(t,e){return t/e})},t.prototype.cal=function(t,e){var i=this._n1.get_value(t.n1,e),o=this._n2.get_value(t.n2,e);return this._op_fun(i,o)},t}();__reflect(a.prototype,"SingleNode"),t.new_calculator=_;var l=function(){function t(){}return t.prototype.destroy=function(){this._weak_md=null,this._num.destroy(),this._num=null},t.prototype.init=function(t){this._weak_md=t.expression,this._num=new s,this._num.init(this._weak_md.num)},t.prototype.cal=function(t){return this._num.get_value(this._weak_md.num,t)},t}();__reflect(l.prototype,"SingleNumericCalculator",["Numeric_Expression_Calculator.ICalculator"]);var c=function(){function t(){}return t.prototype.destroy=function(){this._weak_md=null,this._node.destroy(),this._node=null},t.prototype.init=function(t){this._weak_md=t.expression,this._node=new a,this._node.init(this._weak_md.node)},t.prototype.cal=function(t){return this._node.cal(this._weak_md.node,t)},t}();__reflect(c.prototype,"SingleNodeCalculator",["Numeric_Expression_Calculator.ICalculator"])}(Numeric_Expression_Calculator||(Numeric_Expression_Calculator={}));var GC_Numeric_Expression_Calculator=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.destroy=function(){this._weak_from=null,this._weak_to=null,this._calculator&&(this._calculator.destroy(),this._calculator=null)},e.prototype._init=function(t){var e=t.type,i=parseInt(e);this._calculator=Numeric_Expression_Calculator.new_calculator(i),this._calculator.init(t)},e.prototype.cal=function(t,e){return this._weak_from=t,this._weak_to=e,this._calculator.cal(this)},e}(GC_Molecule_Base);__reflect(GC_Numeric_Expression_Calculator.prototype,"GC_Numeric_Expression_Calculator");var Process_Comparer;!function(t){function e(t,e){return t==e}function i(t,e){return t>e}function o(t,e){return e>t}function r(t,e){return t>=e}function n(t,e){return e>=t}function _(t){var _=null;switch(t){case GC_Comparer_Metadata.Operator_Type.equal:_=e;break;case GC_Comparer_Metadata.Operator_Type.bigger_than:_=i;break;case GC_Comparer_Metadata.Operator_Type.smaller_than:_=o;break;case GC_Comparer_Metadata.Operator_Type.bigger_equal:_=r;break;case GC_Comparer_Metadata.Operator_Type.smaller_equal:_=n}return _}t.choose_comparer=_}(Process_Comparer||(Process_Comparer={}));var Process_LogicExpression;!function(t){function e(t){var e=null;switch(t){case GC_Logic_Expression.Logic_Expression_Type.single:e=new i}return e}var i=function(){function t(){}return t.prototype.destroy=function(){this._exp1.destroy(),this._exp2.destroy(),this._comparer=null,this._weak_md=null},t.prototype.init=function(t,e){this._weak_md=e.expression,this._exp1=new GC_Numeric_Expression_Calculator,this._exp1.molecule_init(t._weak_skill,this._weak_md.node.exp1),this._exp2=new GC_Numeric_Expression_Calculator,this._exp2.molecule_init(t._weak_skill,this._weak_md.node.exp2),this._comparer=Process_Comparer.choose_comparer(this._weak_md.node.method)},t.prototype.evaluate=function(t){var e=this._exp1.cal(t._weak_from,t._weak_to),i=this._exp2.cal(t._weak_from,t._weak_to);return this._comparer(e,i)},t}();__reflect(i.prototype,"LogicExpression_Single"),t.choose_le=e}(Process_LogicExpression||(Process_LogicExpression={}));var Process_Validator;!function(t){function e(t){var e=null,r=t.type,n=parseInt(r);switch(n){case GC_Molecule_Metadata.requirementType.se:e=new o;break;case GC_Molecule_Metadata.requirementType.logic_expression:e=new i}return e}var i=function(){function t(){}return t.prototype.destroy=function(){this._logic_expression.destroy(),this._logic_expression=null},t.prototype.init=function(t,e){var i=e.requirement;this._logic_expression=Process_LogicExpression.choose_le(i.type),this._logic_expression.init(t,i)},t.prototype.validate=function(t){return this._logic_expression.evaluate(t)},t}();__reflect(i.prototype,"Validator_LogicExpression");var o=function(){function t(){}return t.prototype.destroy=function(){this._weak_md=null},t.prototype.init=function(t,e){this._weak_md=e},t.prototype.validate=function(t){var e=this._weak_md.requirement;if(!e.se_id)return!0;var i=!1;return i=e.initiative==GC_Skill_Metadata.SkillInitiative.caller?t._weak_from.skillm_se.has_se(e.se_id):t._weak_to.skillm_se.has_se(e.se_id),this._weak_md.reverse?!i:i},t}();__reflect(o.prototype,"Validator_HasSe"),t.new_validator=e}(Process_Validator||(Process_Validator={}));var GC_Validator=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.destroy=function(){this._weak_from=null,this._weak_to=null,this._validator&&(this._validator.destroy(),this._validator=null)},e.prototype._init=function(t){this._validator=Process_Validator.new_validator(t),this._validator.init(this,t)},e.prototype.validate=function(t,e){return this._weak_from=t,this._weak_to=e,this._validator.validate(this)},e}(GC_Molecule_Base);__reflect(GC_Validator.prototype,"GC_Validator");var po_selector;!function(t){function e(t){var e=null;return t.scope==GC_Process_Metadata.ScopeE.Single?t.target==GC_Process_Metadata.TargetE.Self?e=o:t.target==GC_Process_Metadata.TargetE.Facing?e=r:t.target==GC_Process_Metadata.TargetE.Focus&&(e=n):t.scope==GC_Process_Metadata.ScopeE.Room&&(t.target==GC_Process_Metadata.TargetE.Friendly?t.regulation==GC_Process_Metadata.RegulationE.All?e=_:t.regulation==GC_Process_Metadata.RegulationE.Random_One?e=l:t.regulation==GC_Process_Metadata.RegulationE.Random_Two&&(e=h):t.target==GC_Process_Metadata.TargetE.Enemy?t.regulation==GC_Process_Metadata.RegulationE.All?e=s:t.regulation==GC_Process_Metadata.RegulationE.Random_One?e=c:t.regulation==GC_Process_Metadata.RegulationE.Random_Two&&(e=p):t.target==GC_Process_Metadata.TargetE.All?t.regulation==GC_Process_Metadata.RegulationE.All?e=a:t.regulation==GC_Process_Metadata.RegulationE.Random_One?e=u:t.regulation==GC_Process_Metadata.RegulationE.Random_Two&&(e=d):t.target==GC_Process_Metadata.TargetE.Enemy_Others&&(e=f)),e}function i(t){return t.scope==GC_Process_Metadata.ScopeE.Single?0:1}function o(t){return t._weak_self}function r(t){return t._weak_self.get_facing_enemy()}function n(t){return t._weak_focus}function _(t){var e=t._weak_self.current_room();return e.get_friendly(t._weak_self.character_type())}function s(t){var e=t._weak_self.current_room();return e.get_enemy(t._weak_self.character_type())}function a(t){var e=t._weak_self.current_room();return e.get_all()}function l(t){return m(_(t))}function c(t){return m(s(t))}function u(t){return m(a(t))}function h(t){return y(_(t))}function p(t){return y(s(t))}function d(t){return y(a(t))}function f(t){for(var e=t._weak_self.current_room(),i=t._weak_self.get_facing_enemy(),o=new Array,r=e.get_enemy(t._weak_self.character_type()),n=0;n<r.length;n++)r[n]!=i&&o.push(r[n]);return o}function m(t){var e=Math.floor(2.5*Math.random());return[t[e]]}function y(t){return[t[0],t[1]]}t.choose_selector=e,t.result_type=i}(po_selector||(po_selector={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.Component);t.CommonIconItemView=e,__reflect(e.prototype,"game.CommonIconItemView")}(game||(game={}));var GC_Process_Probability=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.probability},e.prototype.clear_output=function(){},e.prototype._before_destroy=function(){t.prototype._before_destroy.call(this)},e.prototype._init=function(t){},e.prototype.execute=function(){var t=Math.random(),e=this._localmd().value;e>t?this.output=!0:this.output=!1},e}(GC_ProcessBase);__reflect(GC_Process_Probability.prototype,"GC_Process_Probability");var GC_Process_Selector=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.selector},e.prototype.clear_output=function(){this.output.target=null},e.prototype._before_destroy=function(){this._selector=null,t.prototype._before_destroy.call(this)},e.prototype._init=function(t){var e=this._localmd().selector;this._selector=po_selector.choose_selector(e),this.output.target_type=po_selector.result_type(e)},e.prototype.execute=function(){this.output.target=this._selector(this._binded_skill)},e}(GC_ProcessBase);__reflect(GC_Process_Selector.prototype,"GC_Process_Selector");var MonsterInfo=function(t){function e(){var e=t.call(this)||this;return e.des_data=[[{title:"天赋能力",list:[{name:"天赋能力",des:"状态描述状态描述状态描述状态描述状态描述",special:!1},{name:"天赋能力",des:"状态描述状态描述状态描述状态描述状态描述",special:!1}],type:"list"}],[{title:"元素守护",list:[{name:"元素守护",des:"状态描述状态描述状态描述状态描述状态描述",special:!1},{name:"元素守护",des:"状态描述状态描述状态描述状态描述状态描述",special:!1},{name:"元素守护",des:"状态描述状态描述状态描述状态描述状态描述",special:!1}],type:"list"}],[{title:"基础能力",list:[{name:"能力名称",des:"状态描述状态描述状态描述状态描述状态描述",special:!1},{name:"能力名称",des:"状态描述状态描述状态描述状态描述状态描述",special:!1},{name:"能力名称",des:"状态描述状态描述状态描述状态描述状态描述",special:!1},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述",special:!0},{name:"能力名称",des:"状态描述状态描述状态描述状态描述状态描述",special:!1},{name:"能力名称",des:"状态描述状态描述状态描述状态描述状态描述",special:!1}],type:"list"}],[{title:"特性",list:[{name:"特性",des:"状态描述状态描述状态描述状态描述状态描述",special:!1}],type:"list"}]],e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setDesVisible(!1),this.infoClick(),this.setBtnVisible(!1)},e.prototype.initInfo=function(){var t=this,e=new eui.Group;this.group_info.addChild(e),e.width=this.group_info.width,this.corner_mark=new eui.Image,e.addChild(this.corner_mark),this.corner_mark.width=96,this.corner_mark.height=54,this.corner_mark.top=30,this.corner_mark.left=-4;var i=new eui.Group;e.addChild(i),i.width=59,i.height=63,i.right=0,i.top=50;var o=new eui.Image;i.addChild(o),o.left=0,o.top=0,o.right=0,o.bottom=0,o.source="Common_Button_ButtonEquit_png";var r=new eui.Image;i.addChild(r),r.left=8,r.top=6,r.right=5,r.bottom=14,r.source="Common_Icon_Equit_01_png",this.info_icon=new eui.Image,e.addChild(this.info_icon),this.info_icon.width=84,this.info_icon.height=84,this.info_icon.top=100,this.info_icon.horizontalCenter=0;var n=new eui.Image;e.addChild(n),n.width=192,n.height=46,n.source="Common_Pic_Side_png",n.top=180,n.horizontalCenter=0,this.info_name=new eui.Label,e.addChild(this.info_name),this.info_name.width=192,this.info_name.height=46,this.info_name.top=180,this.info_name.size=18,this.info_name.textColor=7755857,this.info_name.horizontalCenter=0,this.info_name.verticalAlign=egret.VerticalAlign.MIDDLE,this.info_name.textAlign=egret.HorizontalAlign.CENTER,this.info_lv=new eui.Label,e.addChild(this.info_lv),this.info_lv.height=20,this.info_lv.horizontalCenter=0,this.info_lv.verticalAlign=egret.VerticalAlign.MIDDLE,this.info_lv.textAlign=egret.HorizontalAlign.CENTER,this.info_lv.top=235;var _=new eui.Image;e.addChild(_),_.source="Common_Pic_Line_02_png",_.width=154,_.height=1,_.horizontalCenter=0,_.top=260,this.info_life=new MonsterInfoValue,e.addChild(this.info_life),this.info_life.top=270,this.info_life.left=25,this.info_life.right=25,this.info_life.height=17,this.info_attack=new MonsterInfoValue,e.addChild(this.info_attack),this.info_attack.top=287,this.info_attack.left=25,this.info_attack.right=25,this.info_attack.height=17,this.info_attack_speed=new MonsterInfoValue,e.addChild(this.info_attack_speed),this.info_attack_speed.top=304,this.info_attack_speed.left=25,this.info_attack_speed.right=25,this.info_attack_speed.height=17;var s=95,a=48;this.btn_genius=this.btn("天赋能力"),this.group_info.addChild(this.btn_genius),this.btn_genius.width=s,this.btn_genius.height=a,this.btn_genius.left=20,this.btn_genius.bottom=82,this.btn_guard=this.btn("元素守护"),this.group_info.addChild(this.btn_guard),this.btn_guard.width=s,this.btn_guard.height=a,this.btn_guard.right=20,this.btn_guard.bottom=82,this.btn_base=this.btn("基础能力"),this.group_info.addChild(this.btn_base),this.btn_base.width=s,this.btn_base.height=a,this.btn_base.left=20,this.btn_base.bottom=35,this.btn_character=this.btn("特性"),this.group_info.addChild(this.btn_character),this.btn_character.width=s,this.btn_character.height=a,this.btn_character.right=20,this.btn_character.bottom=35,this.corner_mark.source="Common_Icon_Label_Orange_png",this.info_icon.source="Common_Icon_Block_01_png",this.info_name.text="永恒之树：伊格拉希尔";var l="<font size=14 color=0xffffff strokecolor=0x80631f stroke=2>等级.  55</font><font size = 14 color = 0x765851>    (33.0%)</font>";this.info_lv.textFlow=(new egret.HtmlTextParser).parser(l),this.info_life.setData("Unit_Icon_Hp_png","生命",5e4),this.info_attack.setData("Unit_Icon_Atk_png","攻击",23e3),this.info_attack_speed.setData("Unit_Icon_AtkSpeed_png","攻速",5e4),this.btn_genius.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnGeniusClick,this),this.btn_guard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnGuardClick,this),this.btn_base.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnBaseClick,this),this.btn_character.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnCharacterClick,this),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.group_des.visible&&t.setDesVisible(!1)},this)},e.prototype.btn=function(t){var e=new eui.Group,i=new eui.Image;e.addChild(i),i.left=0,i.top=0,i.right=0,i.bottom=0,i.source="Common_Button_Simple_png";var o=new eui.Label;return e.addChild(o),o.verticalCenter=0,o.horizontalCenter=0,o.verticalAlign=egret.VerticalAlign.MIDDLE,o.textAlign=egret.HorizontalAlign.CENTER,o.size=14,o.textColor=16777215,o.stroke=2,o.strokeColor=8413983,o.text=t,e},e.prototype.btnGeniusClick=function(t){this.setDesData(this.des_data[0]),this.setDesVisible(!0)},e.prototype.btnGuardClick=function(t){this.setDesData(this.des_data[1]),this.setDesVisible(!0)},e.prototype.btnBaseClick=function(t){this.setDesData(this.des_data[2]),this.setDesVisible(!0)},e.prototype.btnCharacterClick=function(t){this.setDesData(this.des_data[3]),this.setDesVisible(!0)},e.prototype.infoClick=function(){var t=this;this.group_info_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.group_des.visible&&t.setDesVisible(!1)},this)},e}(ConfigurationInfo);__reflect(MonsterInfo.prototype,"MonsterInfo");var GC_Process_CD_Modify_Self=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.clear_output=function(){},e.prototype._init_calculator=function(t){var e=this._localmd();if(e.modity_type==GC_Process_Metadata.ModifyCDType.offset){var i=e.modify;this._calculator=new GC_Numeric_Expression_Calculator,this._calculator.molecule_init(this._binded_skill,i.offset)}},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.cd_modify_quick},e.prototype._exec_subdivision=function(t){var e=this._localmd(),i=this._binded_character.skillm_active.find_skill_by_no(e.skill_id);if(i)if(e.modity_type==GC_Process_Metadata.ModifyCDType.offset){var o=(e.modify,this._calculator.cal(this._binded_character,t));i.cd_offset(o)}else i.cd_terminate()},e}(GC_ExecutableProcess);__reflect(GC_Process_CD_Modify_Self.prototype,"GC_Process_CD_Modify_Self");var Dmg_Local_Coe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._validator&&(this._validator.destroy(),this._validator=null),this._coefficient_fun=null,t.prototype._before_destroy.call(this)},e.prototype.clear_output=function(){},e.prototype.execute=function(){},e.prototype.type=function(){return-1},e.prototype._init=function(t){var e=this,i=this._localmd().validator;return i?(this._validator=new GC_Validator,this._validator.molecule_init(this._binded_skill,i),void(this._coefficient_fun=function(t,i){return e._validator.validate(t,i)?e._localmd().coe:0})):void(this._coefficient_fun=function(t,i){return e._localmd().coe})},e.prototype.apply_coe_A=function(t,e,i){var o=this._coefficient_fun(t,e);i[0]+=o},e}(GC_ProcessBase);__reflect(Dmg_Local_Coe.prototype,"Dmg_Local_Coe");var GC_Process_Dmg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dmg_part_count=4,e._dmg_coes=[0,0,0,0],e}return __extends(e,t),e.prototype._before_destroy=function(){this._local_dmg_coe&&(this._local_dmg_coe.destroy(),this._local_dmg_coe=null),t.prototype._before_destroy.call(this)},e.prototype.clear_output=function(){},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.dmg},e.prototype._init_calculator=function(t){var e=this._localmd();this._calculator=new GC_Numeric_Expression_Calculator,this._calculator.molecule_init(this._binded_skill,e.numeric),this._cache_base_coe=e.base_coe,e.local_coe&&(this._local_dmg_coe=new Dmg_Local_Coe,this._local_dmg_coe.process_init(this._binded_character,this._binded_skill,e.local_coe))},e.prototype._cal_dmg=function(t,e){for(var i=0;i<this._dmg_part_count;i++)this._dmg_coes[i]=0;this._local_dmg_coe&&this._local_dmg_coe.apply_coe_A(t,e,this._dmg_coes),t.skillm_passive.modify_coe_A(t,e,this._dmg_coes),t.skillm_se.modify_coe_A(t,e,this._dmg_coes),e.skillm_passive.modify_coe_P(t,e,this._dmg_coes),e.skillm_se.modify_coe_P(t,e,this._dmg_coes);var o=this._calculator.cal(t,e),r=o*(this._cache_base_coe+this._dmg_coes[0])*(1+this._dmg_coes[1])*(1+this._dmg_coes[2])*(1+this._dmg_coes[3]);return r=Math.round(r),1>r&&(r=1),this.output=[r],r},e.prototype._cal_dodge=function(t,e,i){var o=t.md_battle.accuracy+i,r=Math.random()*o,n=Math.random()*e.md_battle.dodge;return n>r},e.prototype._exec_subdivision=function(t){var e=this._binded_skill.get_metadata().skill_accuracy,i=this._cal_dodge(this._binded_character,t,e);if(i)return void t.dodge_attack();var o=this._localmd().element,r=this._cal_dmg(this._binded_character,t),n=this._binded_skill.type()==GC_Skill_Metadata.SkillType.active;t.deduct_life(r,o,n)},e}(GC_ExecutableProcess);__reflect(GC_Process_Dmg.prototype,"GC_Process_Dmg");var GC_Process_Heal=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.clear_output=function(){},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.dmg},e.prototype._init_calculator=function(t){var e=this._localmd();this._calculator=new GC_Numeric_Expression_Calculator,this._calculator.molecule_init(this._binded_skill,e.numeric),this._cache_base_coe=e.base_coe},e.prototype._cal_heal=function(t,e){var i=this._calculator.cal(t,e),o=i*this._cache_base_coe;return o=Math.round(o),1>o&&(o=1),o},e.prototype._exec_subdivision=function(t){var e=(this._localmd(),this._cal_heal(this._binded_character,t));t.heal(e)},e}(GC_ExecutableProcess);__reflect(GC_Process_Heal.prototype,"GC_Process_Heal");var GC_Process_Instant_Kill=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.clear_output=function(){},e.prototype._init_calculator=function(t){},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.ik},e.prototype._exec_subdivision=function(t){t.instant_kill()},e}(GC_ExecutableProcess);__reflect(GC_Process_Instant_Kill.prototype,"GC_Process_Instant_Kill");var GC_Process_SE_Add=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.clear_output=function(){},e.prototype._init_calculator=function(t){this._calculator=new GC_Numeric_Expression_Calculator,this._calculator.molecule_init(this._binded_skill,this._localmd().value)},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.se_add},e.prototype._exec_subdivision=function(t){var e=this._localmd(),i=this._calculator.cal(this._binded_character,t);t.skillm_se.add_se(e.se_id,i)},e}(GC_ExecutableProcess);__reflect(GC_Process_SE_Add.prototype,"GC_Process_SE_Add");var GC_Process_SE_Remove=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.clear_output=function(){},e.prototype._init_calculator=function(t){},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.se_remove
},e.prototype._exec_subdivision=function(t){var e=this._localmd(),i=e.remove_type;i==GC_Process_Metadata.SERemoveType.all?t.skillm_se.remove_all():i==GC_Process_Metadata.SERemoveType.all_advantageous?t.skillm_se.remove_all_advantageous():i==GC_Process_Metadata.SERemoveType.all_harmful?t.skillm_se.remove_all_harmful():i==GC_Process_Metadata.SERemoveType.specific&&t.skillm_se.remove_se(e.se_id)},e}(GC_ExecutableProcess);__reflect(GC_Process_SE_Remove.prototype,"GC_Process_SE_Remove");var GC_Process_SEMQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.clear_output=function(){},e.prototype._init_calculator=function(t){},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.se_modify_quick},e.prototype._exec_subdivision=function(t){var e=this._localmd().value;if(this._binded_skill.type()==GC_Skill_Metadata.SkillType.SE){var i=this._binded_skill;0==e?i.tweak_value(-1):i.tweak_half()}},e}(GC_ExecutableProcess);__reflect(GC_Process_SEMQ.prototype,"GC_Process_SEMQ");var skill_widget_probability;!function(t){function e(t){return t&&t.probability_id?t.probability_id<0?i:o:i}function i(t,e){return!0}function o(t,e){var i=t._find_siblings(e.probability_id);return i?i.output:!0}t.choose_object=e}(skill_widget_probability||(skill_widget_probability={}));var GC_Process_DmgCoe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._validator&&(this._validator.destroy(),this._validator=null),this._coefficient_fun=null,t.prototype._before_destroy.call(this)},e.prototype.clear_output=function(){},e.prototype.execute=function(){},e.prototype.type=function(){return GC_Process_Metadata.GC_ProcessType.dmg_modifier},e.prototype._init=function(t){var e=this,i=this._localmd().validator;return i?(this._validator=new GC_Validator,this._validator.molecule_init(this._binded_skill,i),void(this._coefficient_fun=function(t,i){return e._validator.validate(t,i)?e._localmd().coe:0})):void(this._coefficient_fun=function(t,i){return e._localmd().coe})},e.prototype.apply_coe_A=function(t,e,i){var o=this._localmd().position,r=this._coefficient_fun(t,e);i[o]+=r},e.prototype.apply_coe_P=function(t,e,i){this.apply_coe_A(t,e,i)},e}(GC_ProcessBase);__reflect(GC_Process_DmgCoe.prototype,"GC_Process_DmgCoe");var MonsterInfoValue=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.icon=new eui.Image,this.addChild(this.icon),this.icon.width=15,this.icon.height=15,this.icon.verticalCenter=0,this.icon.left=0,this.title=new eui.Label,this.addChild(this.title),this.title.verticalCenter=0,this.title.left=20,this.title.size=14,this.title.textColor=7755857,this.value=new eui.Label,this.addChild(this.value),this.value.verticalCenter=0,this.value.right=0,this.value.size=14,this.value.textColor=7755857},e.prototype.setData=function(t,e,i){this.icon.source=t,this.title.text=e,this.value.text=i},e.prototype.setValue=function(t){this.value.text=t},e}(eui.Component);__reflect(MonsterInfoValue.prototype,"MonsterInfoValue");var GC_ActiveSkill=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.type=function(){return GC_Skill_Metadata.SkillType.active},e.prototype._before_destroy=function(){this.cd_counter.destroy(),this.cd_counter=null,t.prototype._before_destroy.call(this)},e.prototype._init=function(t){var e=t;1==e.action_id||2==e.action_id?this._cache_action_id=e.action_id:this._cache_action_id=1,this.cd_counter=DependentSkill_CD.new_cd(e.cd)},e.prototype.execute_sequence=function(){this._p_exec_sequence.execute_sequence()},e.prototype.start_cd=function(){this.cd_counter.start_cd()},e.prototype.cd_terminate=function(){this.cd_counter.cd_reset()},e.prototype.cd_offset=function(t){this.cd_counter.cd_offset(t)},e}(GC_SkillBase);__reflect(GC_ActiveSkill.prototype,"GC_ActiveSkill");var SkillFlyingPart=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"dmg",{get:function(){return this._dmg},enumerable:!0,configurable:!0}),e.prototype._before_destroy=function(){this._strong_view&&(this._strong_view.parent.removeChild(this._strong_view),this._strong_view.destroy(),this._strong_view=null),this._anim&&(this._anim.destroy(),this._anim=null),this._weak_character=null},e.prototype.part_init=function(t,e,i,o,r){this._strong_view=i,gp_core._game_core_view.map_view.addChild(this._strong_view),this._anim=new SkillFlyingPartAnim(this,i).init(),this._anim.start_fly(t,e),this._weak_character=o,this._dmg=r},e.prototype.single_anim_comp=function(t){return this._weak_character.is_dead()?void this.destroy():(this._weak_character.recevie_part_arrived(this),void this.destroy())},e}(ns_sirius.sirius_base_object);__reflect(SkillFlyingPart.prototype,"SkillFlyingPart",["ns_sirius.Isingle_animation_listener"]);var SkillFlyingPartAnim=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._local_duration=-1,e}return __extends(e,t),e.prototype.animation_duration=function(){return this._local_duration},e.prototype.start_fly=function(t,e){this._buffer_current_orig3d=new egret.Point,this._buffer_orig2d=new egret.Point,this._from_orig2d=new egret.Point,this._to_orig2d=new egret.Point,this._from_orig2d.copyFrom(t),this._to_orig2d.copyFrom(e);var i=this._to_orig2d.x-this._from_orig2d.x,o=this._to_orig2d.y-this._from_orig2d.y;this._local_duration=1*i;var r=0;i>5&&(r=Math.atan(o/i)),this._target_view.rotation=180*r/Math.PI,this.start()},e.prototype._anim_update=function(t){var e=t,i=this._target_view;this._buffer_orig2d.x=this.util_linear_interpolation(this._from_orig2d.x,this._to_orig2d.x,e),this._buffer_orig2d.y=this.util_linear_interpolation(this._from_orig2d.y,this._to_orig2d.y,e),gp_core.ppc.convert_2_to_3_global(this._buffer_orig2d,this._buffer_current_orig3d,this._buffer_current_scale3d),i.x=this._buffer_current_orig3d.x,i.y=this._buffer_current_orig3d.y},e.prototype._reset_anim_properties=function(){},e}(ns_sirius.single_animation);__reflect(SkillFlyingPartAnim.prototype,"SkillFlyingPartAnim");var SkillFlyingPartView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._is_destroyed=!1,e}return __extends(e,t),e.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},e.prototype._before_destroy=function(){},e}(egret.DisplayObjectContainer);__reflect(SkillFlyingPartView.prototype,"SkillFlyingPartView",["ns_sirius.Isirius_base_object"]);var SolidRectFlyingPartView=function(t){function e(){var e=t.call(this)||this,i=new egret.Shape;return i.graphics.beginFill(16777215*Math.random()),i.graphics.drawRect(0,0,50,50),i.graphics.endFill(),e.addChild(i),e}return __extends(e,t),e.prototype._before_destroy=function(){},e}(SkillFlyingPartView);__reflect(SolidRectFlyingPartView.prototype,"SolidRectFlyingPartView");var FireBallFlyingPartView=function(t){function e(){var e=t.call(this)||this,i=gp_core.taling_resm.get_res_by_index(1);return e._init_character_anim(i),e}return __extends(e,t),e.prototype._before_destroy=function(){},e.prototype._init_character_anim=function(t){var e=dragonBones.EgretFactory.factory,i=e.buildArmatureDisplay(t.armature_name,t.character_name);this.addChild(i),dragonBones.WorldClock.clock.add(i.armature),i.animation.play("attack_1"),i.scaleX=.8,i.scaleY=.8},e}(SkillFlyingPartView);__reflect(FireBallFlyingPartView.prototype,"FireBallFlyingPartView");var Test_Added=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/LK/skins/Test_AddedSkin.exml",e}return __extends(e,t),e}(eui.Component);__reflect(Test_Added.prototype,"Test_Added",["eui.UIComponent","egret.DisplayObject"]);var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Component);t.CommonRedBtnView=e,__reflect(e.prototype,"game.CommonRedBtnView")}(game||(game={}));var SkillPart_Trigger=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.part_init=function(t,e,i){},e}(SkillPart_Base);__reflect(SkillPart_Trigger.prototype,"SkillPart_Trigger");var TrapInfo=function(t){function e(){var e=t.call(this)||this;return e.des_data=[{title:"状态",list:[{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"},{name:"状态名称",des:"状态描述状态描述状态描述状态描述状态描述"}],type:"list"},{title:"合成配方",recipes:["Common_Icon_Block_01_png","Common_Icon_Block_01_png","Common_Icon_Block_01_png"],type:"arr"}],e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setDesData(this.des_data),this.setDesVisible(!1),this.infoClick()},e.prototype.initInfo=function(){this.group_star=new eui.Group,this.group_info.addChild(this.group_star),this.group_star.height=28,this.group_star.top=50,this.group_star.horizontalCenter=0,this.info_icon=new eui.Image,this.group_info.addChild(this.info_icon),this.info_icon.width=84,this.info_icon.height=84,this.info_icon.top=100,this.info_icon.horizontalCenter=0;var t=new eui.Image;this.group_info.addChild(t),t.width=192,t.height=46,t.source="Common_Pic_Side_png",t.top=210,t.horizontalCenter=0,this.info_name=new eui.Label,this.group_info.addChild(this.info_name),this.info_name.width=192,this.info_name.height=46,this.info_name.top=210,this.info_name.size=18,this.info_name.textColor=7755857,this.info_name.horizontalCenter=0,this.info_name.verticalAlign=egret.VerticalAlign.MIDDLE,this.info_name.textAlign=egret.HorizontalAlign.CENTER,this.info_type=new eui.Label,this.group_info.addChild(this.info_type),this.info_type.width=192,this.info_type.height=18,this.info_type.top=265,this.info_type.size=18,this.info_type.textColor=7755857,this.info_type.horizontalCenter=0,this.info_type.verticalAlign=egret.VerticalAlign.MIDDLE,this.info_type.textAlign=egret.HorizontalAlign.CENTER,this.info_lv=new eui.Label,this.group_info.addChild(this.info_lv),this.info_lv.height=20,this.info_lv.horizontalCenter=0,this.info_lv.verticalAlign=egret.VerticalAlign.MIDDLE,this.info_lv.textAlign=egret.HorizontalAlign.CENTER,this.info_lv.top=290;var e=new eui.Image;this.group_info.addChild(e),e.source="Common_Pic_Line_02_png",e.width=154,e.height=1,e.horizontalCenter=0,e.top=312,this.info_des=new eui.Label,this.group_info.addChild(this.info_des),this.info_des.width=175,this.info_des.horizontalCenter=0,this.info_des.size=14,this.info_des.textColor=7755857,this.info_des.lineSpacing=5,this.info_des.top=325,this.setStar(3),this.info_icon.source="Common_Icon_Block_01_png",this.info_name.text="闪电",this.info_type.text="陷阱";var i="<font size=14 color=0xffffff strokecolor=0x80631f stroke=2>等级.  55</font><font size = 14 color = 0x765851>    (33.0%)</font>";this.info_lv.textFlow=(new egret.HtmlTextParser).parser(i),this.info_des.text="对入场的魔物娘造成12的伤害，并赋予4的缓慢。"},e.prototype.setStar=function(t){for(var e=0;t>e;e++){var i=new eui.Image;this.group_star.addChild(i),i.source="Common_Icon_Gold_Star_png",i.width=27,i.height=28,i.left=27*e+5}},e}(ConfigurationInfo);__reflect(TrapInfo.prototype,"TrapInfo");var GC_SESkill=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.get_value=function(){return this.se_value},e.prototype._init=function(e){t.prototype._init.call(this,e),this.se_value=0,this.cached_advantage_type=this._localmd().advantage_type},e.prototype.tweak_value=function(t){return this.se_value+=t,this.se_value>0?this.se_value:(this._weak_self.skillm_se.remove_se_by_object(this),0)},e.prototype.tweak_half=function(){var t=Math.floor(.5*this.se_value);return this.se_value=t,this.se_value>0?this.se_value:(this._weak_self.skillm_se.remove_se_by_object(this),0)},e.prototype.set_value=function(t){this.se_value=t},e.prototype.type=function(){return GC_Skill_Metadata.SkillType.SE},e}(GC_PassiveSkill);__reflect(GC_SESkill.prototype,"GC_SESkill");var GC_TalingSkill=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._init=function(t){},e.prototype.type=function(){return GC_Skill_Metadata.SkillType.taling},e.prototype._before_destroy=function(){t.prototype._before_destroy.call(this)},e.prototype._init_parts=function(t,e){this._p_exec_sequence=new TSE_FireBall,this._p_exec_sequence.part_init(t,this,e)},e.prototype.execute_sequence=function(){this._p_exec_sequence.execute_sequence()},e}(GC_SkillBase);__reflect(GC_TalingSkill.prototype,"GC_TalingSkill");var TSE_FireBall=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.part_init=function(t,e,i){this._weak_character=t,this._weak_skill=e,this._weak_skill_md=i},e.prototype.execute_sequence=function(){var t=this,e=3,i=this._weak_character.current_room(),o=(i.assaulter_count(),e);if(i.loop_assault(function(e){o>=0&&(t.new_fire_ball(e),o--)}),!(0>o))for(var r=gp_core.map.get_common_room_count(),n=0;r>n;n++){var _=gp_core.map.get_common_room_by_index(n);if(_.loop_assault(function(e){o>=0&&(t.new_fire_ball(e),o--)}),0>o)return}},e.prototype.new_fire_ball=function(t){if(t&&!t.is_dead()){var e=new egret.Point;e.x=this._weak_character.current_pos_2d.x+60,e.y=this._weak_character.current_pos_2d.y-90;var i=new egret.Point;i.x=t.current_pos_2d.x,i.y=t.current_pos_2d.y-50;var o=new FireBallFlyingPartView,r=new SkillFlyingPart;r.part_init(e,i,o,t,1e3),t.register_flying_part(r)}},e}(SkillPart_ExecSequence);__reflect(TSE_FireBall.prototype,"TSE_FireBall");var DependentSkill_CD=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.new_cd=function(t){var e=null;return e=t>1?new DependentSkill_CD_T:new DependentSkill_CD_F,e.init(t),e},e}(GamePlayEntityBase);__reflect(DependentSkill_CD.prototype,"DependentSkill_CD");var DependentSkill_CD_T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(t){this._cd_interval=t,this._cd_cursor=0},e.prototype.skill_can_release=function(){return 0==this._cd_cursor},e.prototype.start_cd=function(){this._cd_cursor=this._cd_interval},e.prototype.cd_decrease=function(){0!=this._cd_cursor&&this._cd_cursor--},e.prototype.cd_reset=function(){this._cd_cursor=0},e.prototype.cd_offset=function(t){this._cd_cursor-=t,this._cd_cursor<0&&(this._cd_cursor=0)},e}(DependentSkill_CD);__reflect(DependentSkill_CD_T.prototype,"DependentSkill_CD_T");var DependentSkill_CD_F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(t){},e.prototype.skill_can_release=function(){return!0},e.prototype.start_cd=function(){},e.prototype.cd_decrease=function(){},e.prototype.cd_reset=function(){},e.prototype.cd_offset=function(t){},e}(DependentSkill_CD);__reflect(DependentSkill_CD_F.prototype,"DependentSkill_CD_F");var GameCoreView=function(t){function e(){var e=t.call(this)||this;return e.height=sirius.device_info.design_height,e.width=sirius.device_info.initial_optimal_w,e.horizontalCenter=0,e.top=0,e.mask=new egret.Rectangle(0,0,e.width,e.height),e._bgimg=new eui.Image("game_bg_jpg"),e.addChild(e._bgimg),e._bgimg.top=0,e._bgimg.width=sirius.device_info.design_width,e._bgimg.height=Math.ceil(1136*e._bgimg.width/640),e._bgimg.horizontalCenter=0,e._bgimg.verticalCenter=0,e._coord_convert_ref_view=new egret.DisplayObjectContainer,e.addChild(e._coord_convert_ref_view),e._coord_convert_ref_view.width=gp_core.layout_config.total_w,e._coord_convert_ref_view.height=gp_core.layout_config.total_h,e._repos_view(),e}return __extends(e,t),e.prototype.core_init=function(t){this._gc=t},e.prototype.prepare_view_before_game=function(){},e.prototype._repos_view=function(){var t=gp_core.layout_config.total_w,e=sirius.device_info.initial_optimal_w;if(this.map_view){var i=.5*(e-t);this.map_view.x=i,this._coord_convert_ref_view.x=i}this.painting_canvas&&(this.painting_canvas.x=.5*sirius.device_info.initial_optimal_w)},e.prototype.get_coord_convert_ref_view=function(){return this._coord_convert_ref_view},e.prototype.prepare_game=function(){this.painting_canvas=new MapPaintingCanvas,this.addChild(this.painting_canvas),this.painting_canvas.prepare_mesh(),this.painting_canvas.visible=!1,this.map_view=new GC_MapView,this.addChild(this.map_view),this.map_view.width=gp_core.layout_config.total_w,this.map_view.height=gp_core.layout_config.total_h,this._painting_src=new MapPaintingView,this.addChild(this._painting_src),this._painting_src.width=gp_core.layout_config.canvas_fixed_w,this._painting_src.height=gp_core.layout_config.canvas_fixed_h,this._painting_src.visible=!1,this._repos_view()},e.prototype.room_start_painting=function(){this._painting_src.redraw()},e.prototype.start_game=function(){this._draw_rt(),this.map_view.rooms_init()},e.prototype.game_res_dispose=function(){this.painting_canvas.game_res_dispose(),this.painting_canvas.destroy(),this.painting_canvas=null,this.map_view.game_res_dispose(),this.map_view.destroy(),this.map_view=null},e.prototype.perspective_update=function(){this.painting_canvas.update_pp_param(this._gc),this.map_view.update_pp_param()},e.prototype._draw_rt=function(){var t=gp_core.layout_config.canvas_fixed_w,e=gp_core.layout_config.canvas_fixed_h,i=new egret.RenderTexture;i.disposeBitmapData=!0,i.drawToTexture(this._painting_src,new egret.Rectangle(0,0,t,e)),this.painting_canvas.paint_room(i,this._gc),i=null,this.painting_canvas.visible=!0,this.removeChild(this._painting_src),this._painting_src=null},e.prototype.debug_born_pawn=function(){return this.map_view.debug_born_pawn()},e.prototype.debug_born_boss=function(){return this.map_view.debug_born_boss()},e}(ns_sirius.sirius_view_base);__reflect(GameCoreView.prototype,"GameCoreView");var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setPosition=function(t,e){e>2&&98>e?(this.stick.visible=!0,this.stick.x=t*(.01*e)):this.stick.visible=!1},e}(t.CommonProcessBar);t.ExpProcessBarView=e,__reflect(e.prototype,"game.ExpProcessBarView")}(game||(game={}));var MapPaintingCanvas=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.game_res_dispose=function(){this._src_texture&&(this._src_texture.disposeBitmapData=!0,this._src_texture.dispose(),this._src_texture=null),this._dragon_display&&(this._dragon_display.dispose(),this.removeChild(this._dragon_display),this._dragon_display=null)},e.prototype.paint_room=function(t,e){this._src_texture&&(this._src_texture.disposeBitmapData=!0,this._src_texture.dispose(),this._src_texture=null),this._dragon_display&&(this._src_texture=t,this._dragon_display.scaleX=gp_core.layout_config.canvas_scale_x,this._dragon_display.scaleY=gp_core.layout_config.canvas_scale_y,this._dragon_display.armature.replaceTexture(this._src_texture),this.update_pp_param(e))},e.prototype.prepare_mesh=function(){var t=dragonBones.EgretFactory.factory,e=t.buildArmatureDisplay("Armature","canvas_mesh");this.addChild(e),this._dragon_display=e;var i="#define M_PI 3.1415926535897932384626433832795\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord; \n \nconst float near = 0.5;\nconst vec2 center = vec2(-1.0, 1.0);\n \nuniform float last_scale;\nuniform float offset_x;\nuniform float offset_y;\n \nuniform vec2 projectionVector;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\n \nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main(void) {\n\n    vec2 raw_pos =  (aVertexPosition / projectionVector) + center;\n   \n    //======= 先处理， 处理scale\n    raw_pos.x = raw_pos.x * last_scale;\n    raw_pos.y = raw_pos.y * last_scale + last_scale - 1.0;\n      \n    float rx = raw_pos.x;\n    float ry = raw_pos.y;\n      \n    //根据 ry [-1, 1] 映射 z 值 到  [0, m] 上 ，近平面为 x-o-y平面\n    const float m = 0.2;\n    float rz = (ry + 1.0) * 0.5 * m + offset_y * 0.1;\n    \n    float input_x = rx + offset_x;\n    float input_y = ry + offset_y;\n\n    float res_x =  (input_x * near) / (rz + near);\n    float res_y =  (input_y * near) / (rz + near);\n  \n    vec2 normal_pos = vec2(res_x, res_y);\n  \n    vec2 color_pos = aTextureCoord;  \n    color_pos.x = rx;\n    color_pos.y = ry;\n \n    gl_Position = vec4( normal_pos, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vColor = vec4(color_pos.x, color_pos.y, 0.0,1.0);\n    }\n",o="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\n\nuniform float customUniform;\n\nvoid main(void) { \n     \n    vec4 fg = texture2D(uSampler, vTextureCoord); \n    // fg += (vColor * 0.5);\n    gl_FragColor = fg;\n\n    // gl_FragColor = vColor;\n\n    // gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0);\n\n}",r=new egret.CustomFilter(i,o,{offset_x:0,offset_y:0,last_scale:1});e.filters=[r],this._customFilter1=r},e.prototype.update_pp_param=function(t){this._customFilter1.uniforms.offset_x=t.ppc._shader_offset_x,this._customFilter1.uniforms.offset_y=t.ppc._shader_offset_y,this._customFilter1.uniforms.last_scale=t.ppc._shader_last_scale},e}(GC_Ele_BaseView);__reflect(MapPaintingCanvas.prototype,"MapPaintingCanvas");var MapPaintingView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.redraw=function(){gp_core.layout_config.canvas_fixed_w,gp_core.layout_config.canvas_fixed_h;this._draw_lines(),this._draw_normal_rooms(),this._draw_boss_room()},e.prototype._draw_normal_rooms=function(){for(var t=gp_core.map,e=gp_core.layout_config.pr_w_ratio,i=gp_core.layout_config.pr_h_ratio,o=t.rooms.length,r=new Array(o),n=0;o>n;n++){var _=t.rooms[n],s=_.layout_info.room_pos.unique_index,a=new eui.Image;r[s]=a,a.fillMode=egret.BitmapFillMode.SCALE,a.width=_.layout_info.view_w*e,a.height=_.layout_info.view_h*i,a.x=_.layout_info.view_pos.x*e,a.y=_.layout_info.view_pos.y*i,this.addChild(a),s%11==0?a.source="Battle_Block_02_png":s%11==2?a.source="Battle_Block_03_png":s%11==4?a.source="Battle_Block_04_png":s%11==9?a.source="Battle_Block_05_png":a.source="Battle_Block_01_png"}},e.prototype._draw_boss_room=function(){var t=gp_core.map,e=gp_core.layout_config.pr_w_ratio,i=gp_core.layout_config.pr_h_ratio,o=t.get_boss_room(),r=new eui.Image;r.source="Battle_Block_06_png",r.width=o.layout_info.view_w*e,r.height=o.layout_info.view_h*i,r.x=o.layout_info.view_pos.x*e,r.y=o.layout_info.view_pos.y*i,this.addChild(r),r.fillMode=egret.BitmapFillMode.SCALE},e.prototype._draw_lines=function(){for(var t=gp_core.map,e=gp_core.layout_config.pr_w_ratio,i=gp_core.layout_config.pr_h_ratio,o=gp_core.layout_config.row_count,r=gp_core.layout_config.column_count,n=-5,_=gp_core.layout_config.column_gap+2*n,s=Math.ceil(.2*_),a=gp_core.layout_config.row_gap+2*n,l=Math.ceil(.2*a),c=0;o>c;c++)for(var u=0;r>u;u++){var h=gp_core.layout_config.rowcolumn_to_uindex(c,u),p=t.rooms[h];if(u!=r-1){var d=new egret.Point(p.layout_info.view_pos.x+p.layout_info.view_w-n,p.layout_info.center_pos.y),f=new eui.Image("Battle_Block_07_png");f.fillMode=egret.BitmapFillMode.SCALE,f.width=_*e,f.height=s*i,f.x=d.x*e,f.y=(d.y-.5*s)*i,this.addChild(f)}if(c!=o-1){var m=new egret.Point(p.layout_info.center_pos.x,p.layout_info.view_pos.y+p.layout_info.view_h-n),y=new eui.Image("Battle_Block_08_png");y.fillMode=egret.BitmapFillMode.SCALE,y.width=l*e,y.height=a*i,y.x=(m.x-.5*l)*e,y.y=m.y*i,this.addChild(y)}}},e}(GC_Ele_BaseView);__reflect(MapPaintingView.prototype,"MapPaintingView");var GC_BossView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._play_idle_state=function(){this._character_display.animation.play(GC_CharacterAnimName.WAITING)},e}(GC_CharacterView);__reflect(GC_BossView.prototype,"GC_BossView");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function o(o){e.call(i,o,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?o(r):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GCCV_death=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._current_x=0,e._current_y=0,e._current_alpha=0,e._is_reverse=!1,e._x_offset=0,e}return __extends(e,t),e.prototype.animation_duration=function(){var t=1e3;return t},e.prototype._reset_anim_properties=function(){},e.prototype.current_x=function(){return this._current_x},e.prototype.current_y=function(){return this._current_y},e.prototype.current_alpha=function(){return this._current_alpha},e.prototype.start_die=function(t){this._is_animating||(this._x_offset=t?200:-200,this._is_reverse=t,this.start())},e.prototype._anim_update=function(t){var e=t,i=1-Math.pow(e-1,2);this._current_x=this._x_offset*i;var o=150,r=Math.pow(i-.5,2);this._current_y=-o+4*o*r,this._current_alpha=1-e},e}(ns_sirius.single_animation);__reflect(GCCV_death.prototype,"GCCV_death");var DmgTxt=function(t){function e(){var e=t.call(this)||this;return e._lbl_con=new egret.DisplayObjectContainer,e.addChild(e._lbl_con),e._lbl=new egret.TextField,e._lbl_con.addChild(e._lbl),e._lbl.text="",e._lbl.size=12,e._lbl.fontFamily="Comic Sans MS",e._lbl.bold=!0,e._lbl.textColor=16711806,e._lbl.stroke=1,e._lbl.strokeColor=0,e._lbl.y=-6,e._lbl.x=-18,e._anim_comp=new DmgTxtAnim(e,e._lbl_con).init(),e}return __extends(e,t),e.prototype.destroy=function(){this._lbl_con.removeChild(this._lbl),this.removeChild(this._lbl_con),this._anim_comp.destroy()},e.prototype.start_anim_heal=function(t,e,i){this._lbl.textColor=65280,this._lbl.text=t+"",e.addChild(this),this._anim_comp.start_anim(i)},e.prototype.start_anim=function(t,e,i,o){this._lbl.textColor=this.clr_of_element(e),this._lbl.text=t+"",i.addChild(this),this._anim_comp.start_anim(o)},e.prototype.start_anim_dodge=function(t,e){this._lbl.textColor=5408767,this._lbl.text="闪避",t.addChild(this),this._anim_comp.start_anim(e)},e.prototype.play_se_status_change=function(t,e,i,o){this._lbl.textColor=15620441,0==t?this._lbl.text="! "+e+" !":1==t&&(this._lbl.text="+"+e),i.addChild(this),this._anim_comp.start_anim(o)},e.prototype.single_anim_comp=function(t){this.parent&&this.parent.removeChild(this)},e.prototype.clr_of_element=function(t){var e=16777215;switch(t){case GC_Process_Metadata.Dmg_Element.water:break;case GC_Process_Metadata.Dmg_Element.fire:e=15007744;break;case GC_Process_Metadata.Dmg_Element.wind:e=516033;break;case GC_Process_Metadata.Dmg_Element.earth:e=16762666;break;case GC_Process_Metadata.Dmg_Element.light:break;case GC_Process_Metadata.Dmg_Element.darkness:break;case GC_Process_Metadata.Dmg_Element.spirit:break;case GC_Process_Metadata.Dmg_Element.physics:}return e},e}(egret.DisplayObjectContainer);__reflect(DmgTxt.prototype,"DmgTxt",["ns_sirius.Isingle_animation_listener"]);var DmgTxtAnim=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._start_scale=4,e._end_scale=1.5,e._anim_max_offset=0,e._anim_max_y_offset=0,e}return __extends(e,t),e.prototype.animation_duration=function(){var t=ns_sirius.anim_clock.frame_to_ms(40);return t},e.prototype._reset_anim_properties=function(){},e.prototype.start_anim=function(t){this._anim_max_offset=t?100:-100,this._anim_max_y_offset=-50+100*Math.random(),this.start()},e.prototype.stop=function(){t.prototype.stop.call(this)},e.prototype._anim_update=function(t){var e=this._target_view,i=t,o=Math.sqrt(1-Math.pow(i-1,2));e.x=o*this._anim_max_offset,e.y=o*this._anim_max_y_offset;var r=1.5*i;r>1&&(r=1);var n=this._start_scale+(this._end_scale-this._start_scale)*r;e.scaleX=n,e.scaleY=n},e}(ns_sirius.single_animation);__reflect(DmgTxtAnim.prototype,"DmgTxtAnim");var CharacterHealthView=function(t){function e(e,i){var o=t.call(this)||this,r=null,n=null;e?(o.x=-50,o.y=i-25,r="Common_Pic_Battle_BloodStrip_01_png",n="Common_Pic_Battle_BloodStrip_02_png"):(o.x=-25,o.y=i-8,r="Battle_SmallBloodStick_01_png",n="Battle_SmallBloodStick_02_png");var _=new egret.Bitmap(RES.getRes(n));o.addChild(_);var s=new egret.Bitmap(RES.getRes(r));return o.addChild(s),o.raw_width=s.width,o.front=s,s.fillMode=egret.BitmapFillMode.CLIP,o}return __extends(e,t),e.prototype.update_prog=function(t){this.front.width=this.raw_width*t,this.visible=!0},e}(egret.DisplayObjectContainer);__reflect(CharacterHealthView.prototype,"CharacterHealthView");var GCCV_stride=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._stride_pos=0,e._stride_end_offset=0,e}return __extends(e,t),e.prototype.animation_duration=function(){var t=ns_sirius.anim_clock.frame_to_ms(40);return t},e.prototype.stride_pos=function(){return this._stride_pos},e.prototype.stride=function(t){this._stride_end_offset=t?-50:50,this.start()},e.prototype._anim_update=function(t){var e=t,i=Math.sqrt(1-Math.pow(e-1,2));this._stride_pos=this._stride_end_offset*i},e.prototype._reset_anim_properties=function(){this._stride_pos=0},e}(ns_sirius.single_animation);__reflect(GCCV_stride.prototype,"GCCV_stride");var GCCV_vibration=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._vibration_offset=0,e}return __extends(e,t),e.prototype.animation_duration=function(){var t=ns_sirius.anim_clock.frame_to_ms(15);return t},Object.defineProperty(e.prototype,"vibration_offset",{get:function(){return this._vibration_offset},enumerable:!0,configurable:!0}),e.prototype._anim_update=function(t){var e=35,i=t,o=e-i*e,r=4*Math.PI*i,n=o*Math.sin(r);this._vibration_offset=n},e.prototype._reset_anim_properties=function(){this._vibration_offset=0},e}(ns_sirius.single_animation);__reflect(GCCV_vibration.prototype,"GCCV_vibration");var GC_MapView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.rooms_init=function(){this._born_room_init(),this._boss_room_init()},e.prototype.game_res_dispose=function(){this.boss_room&&(this.boss_room.destroy(),this.boss_room=null),this.born_room&&(this.born_room.destroy(),this.born_room=null)},e.prototype._boss_room_init=function(){var t=new GC_BossRoomView;this.boss_room=t,this.addChild(t),this._update_boss_room_pos()},e.prototype._born_room_init=function(){var t=new GC_BornRoomView;this.born_room=t,this.addChild(t),this._update_born_room_pos()},e.prototype.update_pp_param=function(){this._update_boss_room_pos(),this._update_born_room_pos()},e.prototype._update_boss_room_pos=function(){var t=gp_core.map;if(t){var e=t.get_boss_room();this.boss_room.x=e.layout_info.d3_point_local.x,this.boss_room.y=e.layout_info.d3_point_local.y,this.boss_room.scaleX=e.layout_info.d3_scale.x,this.boss_room.scaleY=e.layout_info.d3_scale.y}},e.prototype._update_born_room_pos=function(){var t=gp_core.map;if(t){var e=t.get_birth_room();this.born_room.x=e.layout_info.d3_point_local.x,this.born_room.y=e.layout_info.d3_point_local.y,this.born_room.scaleX=e.layout_info.d3_scale.x,this.born_room.scaleY=e.layout_info.d3_scale.y}},e.prototype.debug_born_pawn=function(){var t=new GC_CharacterView;return this.addChild(t),t},e.prototype.debug_born_boss=function(){var t=new GC_BossView;return this.addChild(t),t},e}(GC_Ele_BaseView);__reflect(GC_MapView.prototype,"GC_MapView");var GC_BornRoomView=function(t){function e(){var e=t.call(this)||this;return e.load(e.createView),e}return __extends(e,t),e.prototype.createView=function(){var t=new egret.MovieClipDataFactory(this._mcData,this._mcTexture),e=new egret.MovieClip(t.generateMovieClipData("NewProject"));this.addChild(e),e.gotoAndPlay(1,-1),e.x=0,e.y=0,e.scaleX=2,e.scaleY=2},e.prototype.load=function(t){var e=this,i=0,o=this,r=function(){i++,2==i&&t.call(o)},n=new egret.URLLoader;n.addEventListener(egret.Event.COMPLETE,function(t){var i=t.currentTarget;e._mcTexture=i.data,r()
},this),n.dataFormat=egret.URLLoaderDataFormat.TEXTURE;var _=new egret.URLRequest("resource/LK/game_core/portal/portal_tex.png");n.load(_);var n=new egret.URLLoader;n.addEventListener(egret.Event.COMPLETE,function(t){var i=t.currentTarget;e._mcData=JSON.parse(i.data),r()},this),n.dataFormat=egret.URLLoaderDataFormat.TEXT;var _=new egret.URLRequest("resource/LK/game_core/portal/portal_mc.json");n.load(_)},e}(GC_RoomView);__reflect(GC_BornRoomView.prototype,"GC_BornRoomView");var GC_BossRoomView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(GC_RoomView);__reflect(GC_BossRoomView.prototype,"GC_BossRoomView");var common_anim_loader=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._clear=function(){this._res_no=null,this._index=-1,this._factory=null,this._listener=null,this._tmp_png=null,this._tmp_tex=null,this._tmp_ske=null,this._url_prefix=null},e.prototype._before_destroy=function(){this._clear()},e.prototype.load_anim=function(t,e,i,o,r){this._clear(),this._url_prefix=t,this._res_no=e,this._factory=i,this._index=o,this._listener=r,this._load_ske_res()},e.prototype._load_ske_res=function(){var t=this,e=this._url_prefix+"/"+this._res_no+"/"+this._res_no+"_ske.json";RES.getResByUrl(e,function(e,i){t._is_destroyed||(t._tmp_ske=e,t._load_tex_config_res())},this,null)},e.prototype._load_tex_config_res=function(){var t=this,e=this._url_prefix+"/"+this._res_no+"/"+this._res_no+"_tex.json";RES.getResByUrl(e,function(e,i){t._is_destroyed||(t._tmp_tex=e,t._load_tex_img_res())},this,null)},e.prototype._load_tex_img_res=function(){var t=this,e=this._url_prefix+"/"+this._res_no+"/"+this._res_no+"_tex.png";RES.getResByUrl(e,function(e,i){t._is_destroyed||(t._tmp_png=e,t._all_loaded())},this,null)},e.prototype._all_loaded=function(){this._factory.parseDragonBonesData(this._tmp_ske),this._factory.parseTextureAtlasData(this._tmp_tex,this._tmp_png),this._listener&&this._listener.anim_res_success(this._index,null),this._clear()},e}(ns_sirius.sirius_base_object);__reflect(common_anim_loader.prototype,"common_anim_loader");var AnimRes=function(){function t(t,e,i,o){void 0===t&&(t=0),void 0===e&&(e=""),void 0===i&&(i=""),void 0===o&&(o=""),this.all_loaded=!1,this.res_id=t,this.file_key=e,this.armature_name=i,this.character_name=o}return t}();__reflect(AnimRes.prototype,"AnimRes");var CriticalResLoader=function(){function t(){}return t.prototype._res_prefix=function(){},t.prototype.load_res=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return this._loader=new common_anim_loader,this._loader.load_anim("resource/LK/game_core","canvas_mesh",dragonBones.EgretFactory.factory,0,this),[2,new Promise(function(e,i){t._cb_s=e,t._cb_f=i})]})})},t.prototype.anim_res_success=function(t,e){this._cb_s()},t}();__reflect(CriticalResLoader.prototype,"CriticalResLoader",["Icommon_anim_loader_listener"]);var EffectResLoader=function(){function t(){}return t.prototype.load_res=function(){},t}();__reflect(EffectResLoader.prototype,"EffectResLoader");var character_anim_def=function(){function t(){}return t}();__reflect(character_anim_def.prototype,"character_anim_def");var TalingResManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._config_file_name=function(){return"taling_config_json"},e.prototype._res_prefix=function(){return"resource/LK/game_core/taling"},e}(GameCoreResManager);__reflect(TalingResManager.prototype,"TalingResManager");var GameUIView=function(t){function e(){var e=t.call(this)||this;e.mark_as_fullfill(),e.topView=new GameUIViewTop,e.addChild(e.topView),e.topView.top=0,e.topView.left=0,e.topView.right=0,e.bottomView=new GameUIViewBottom,e.addChild(e.bottomView),e.bottomView.bottom=0,e.bottomView.left=0,e.bottomView.right=0,e.friend_area=new eui.Component,e.addChild(e.friend_area),e.friend_area.top=e.topView.height+10,e.friend_area.left=5,e.friend_area.width=48,e.friend_area.height=48,e.friend=new eui.Image,e.friend_area.addChild(e.friend),e.friend_area.width=48,e.friend_area.height=48,e.friend.source="Common_Icon_FriendRequest_png",e.friend_dot=new eui.Image,e.friend_area.addChild(e.friend_dot),e.friend_dot.right=0,e.friend_dot.width=18,e.friend_dot.height=18,e.friend_dot.source="Common_Pic_Red_png",e.chat=new eui.Image,e.addChild(e.chat),e.chat.width=41,e.chat.height=71,e.chat.left=0,e.chat.verticalCenter=20,e.chat.source="Main_Icon_Chat_png";var i=new eui.Button;e.addChild(i),i.label="测试弹出陷阱设置",i.top=100,i.horizontalCenter=0,i.height=50,i.addEventListener(egret.TouchEvent.TOUCH_TAP,e.test1Click,e);var o=new eui.Button;e.addChild(o),o.label="测试弹出魔物设置",o.top=160,o.horizontalCenter=0,o.height=50,o.addEventListener(egret.TouchEvent.TOUCH_TAP,e.test2Click,e);var r=new eui.Button;return e.addChild(r),r.label="测试弹出探险进入页",r.top=220,r.horizontalCenter=0,r.height=50,r.addEventListener(egret.TouchEvent.TOUCH_TAP,e.test3Click,e),e.touchEnabled=!1,e}return __extends(e,t),e.prototype.btn_debug_click2=function(t){sirius.view_manager.show_popup_text_msg("你点击了 GameUIView 上的按钮")},e.prototype.test1Click=function(){sirius.view_manager.show_module("TrapView")},e.prototype.test2Click=function(){sirius.view_manager.show_module("MonsterView")},e.prototype.test3Click=function(){sirius.view_manager.show_module("AdventureEnterView")},e}(ns_sirius.sirius_view_base);__reflect(GameUIView.prototype,"GameUIView");var GameUIViewBottom=function(t){function e(){var e=t.call(this)||this;return e.layout_gap=2,e.item_width=46,e.scr_skill_bg_width=703,e.arr=[],e.arr_test=[{source:"Battle_Icon_Buff_01_png",count:12,des:"buff01 buff01 buff01buff01 buff01 buff01"},{source:"Battle_Icon_Buff_02_png",count:2,des:"buff02 buff02 buff02"},{source:"Battle_Icon_Buff_03_png",count:7,des:"buff03 buff03 buff03"},{source:"Battle_Icon_Buff_01_png",count:0,des:"buff01 buff01 buff01"},{source:"Battle_Icon_Buff_02_png",count:0,des:"buff02 buff02 buff02"},{source:"Battle_Icon_Buff_03_png",count:0,des:"buff03 buff03 buff03"},{source:"Battle_Icon_Buff_01_png",count:0,des:"buff01 buff01 buff01"},{source:"Battle_Icon_Buff_02_png",count:0,des:"buff02 buff02 buff02"},{source:"Battle_Icon_Buff_03_png",count:0,des:"buff01 buff01 buff01"},{source:"Battle_Icon_Buff_01_png",count:0,des:"buff01 buff01 buff01"},{source:"Battle_Icon_Buff_02_png",count:0,des:"buff02 buff02 buff02"},{source:"Battle_Icon_Buff_03_png",count:0,des:"buff03 buff03 buff03"},{source:"Battle_Icon_Buff_01_png",count:0,des:"buff01 buff01 buff01"},{source:"Battle_Icon_Buff_02_png",count:0,des:"buff02 buff02 buff02"},{source:"Battle_Icon_Buff_03_png",count:0,des:"buff03 buff03 buff03"}],e.times=0,e.skinName="resource/ZL/skins/bottom/GameUIViewBottom.exml",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype._bottom_touch_move=function(t){console.log("=======_bottom_touch_move"),this.scr_skill.globalToLocal(t.stageX,t.stageY,this._buffer_touch_pos),this._scroll_bounds.containsPoint(this._buffer_touch_pos)?(this.scr_skill.scrollPolicyH=eui.ScrollPolicy.ON,t.stopPropagation()):this.scr_skill.scrollPolicyH=eui.ScrollPolicy.OFF},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),console.log(this.group_skill),this.scr_skill.horizontalScrollBar.autoVisibility=!1,this.scr_skill.horizontalScrollBar.visible=!1,this.scr_skill.scrollPolicyH=eui.ScrollPolicy.ON,this._scroll_bounds=new egret.Rectangle,this._buffer_touch_pos=new egret.Point,setTimeout(function(){e.scr_skill.getBounds(e._scroll_bounds)},1e3),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this._bottom_touch_move,this);this.changeList(this.arr),this.timer=new egret.Timer(1e3,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerCallFunc,this),this.timer.start();var i=10,o=10;this.skill_num.text=i+"/"+o;var r=i/o;this.pro_skill.value=100*r,this.group_skill_01.image.source="Bottom_Button_ButtonSkill_01_png",this.group_skill_01.count.text="2",this.group_skill_02.image.source="Bottom_Button_ButtonSkill_02_png",this.group_skill_03.image.source="Bottom_Button_ButtonSkill_03_png",this.group_skill_04.image.source="Bottom_Button_ButtonSkill_04_png",this.skillBtnTimer=new egret.Timer(300,0),this.group_skill_01.index=0,this.group_skill_02.index=1,this.group_skill_03.index=2,this.group_skill_04.index=3,this.group_skill_01.touchEnabled=!0,this.group_skill_02.touchEnabled=!0,this.group_skill_03.touchEnabled=!0,this.group_skill_04.touchEnabled=!0,this.group_skill_01.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.skillTouchBegin,this),this.group_skill_01.addEventListener(egret.TouchEvent.TOUCH_END,this.skillTouchEnd,this),this.group_skill_01.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.skillTouchMove,this),this.group_skill_02.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.skillTouchBegin,this),this.group_skill_02.addEventListener(egret.TouchEvent.TOUCH_END,this.skillTouchEnd,this),this.group_skill_02.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.skillTouchMove,this),this.group_skill_03.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.skillTouchBegin,this),this.group_skill_03.addEventListener(egret.TouchEvent.TOUCH_END,this.skillTouchEnd,this),this.group_skill_03.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.skillTouchMove,this),this.group_skill_04.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.skillTouchBegin,this),this.group_skill_04.addEventListener(egret.TouchEvent.TOUCH_END,this.skillTouchEnd,this),this.group_skill_04.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.skillTouchMove,this)},e.prototype.timerCallFunc=function(){this.times>=this.arr_test.length-1&&this.timer.stop(),this.arr.push(this.arr_test[this.times]),this.changeList(this.arr),this.times++},e.prototype.changeList=function(t){var e=new eui.ArrayCollection(t);if(0===t.length)this.group_skill_list.visible=!1;else{this.group_skill_list.visible=!0;var i=new eui.HorizontalLayout;i.gap=this.layout_gap,this.list_skill.layout=i,t.length<=11?(this.scr_skill.width=t.length*(this.item_width+this.layout_gap),this.scr_skill_bg.left=this.scr_skill.width+60-this.scr_skill_bg_width,this.scr_skill.left=15,this.arrow_L.visible=!1,this.arrow_R.visible=!1):(this.arrow_L.visible=!0,this.arrow_R.visible=!0,this.arrow_L.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moveLeftScroller,this),this.arrow_R.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moveRightScroller,this),this.scr_skill_bg.left=0,this.scr_skill.width=528,this.scr_skill.left=70),this.list_skill.dataProvider=e,this.list_skill.itemRenderer=SkillListItem,this.list_skill.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTapHandler,this)}},e.prototype.onItemTapHandler=function(t){egret.log(t.item),egret.log(t.itemRenderer),egret.log(t.itemIndex),sirius.view_manager.show_module("BottomSkillListItemDes",t.item)},e.prototype.moveLeftScroller=function(){var t=this.scr_skill;return t.viewport.scrollH<=0?(console.log("滚动到最左边了"),void sirius.view_manager.show_popup_text_msg("滚动到最左边了")):void(t.viewport.scrollH-=this.item_width+this.layout_gap)},e.prototype.moveRightScroller=function(){var t=this.scr_skill;return t.viewport.scrollH+t.width>=t.viewport.contentWidth?(console.log("滚动到最右边了"),void sirius.view_manager.show_popup_text_msg("滚动到最右边了")):void(t.viewport.scrollH+=this.item_width+this.layout_gap)},e.prototype.skillClick=function(t){console.log("Click");var e=t.target,i=parseInt(e.count.text);if(!(0>=i)){i--,e.count.text=i+"";var o=e.index;switch(o){case 0:console.log("bottom 1");break;case 1:console.log("bottom 2");break;case 2:console.log("bottom 3");break;case 3:console.log("bottom 4")}}},e.prototype.skillLongClick=function(t){console.log("LongClick");var e=t.target,i=e.index;switch(i){case 0:console.log("LongClick"),sirius.view_manager.show_module("BottomSkillItemDes",{name:"无形之风",des:"无形之风无形之风无形之风无形之风无形之风无形之风无形之风无形之风无形之风"});break;case 1:sirius.view_manager.show_module("BottomSkillItemDes",{name:"世界树",des:"世界树世界树世界树"});break;case 2:sirius.view_manager.show_module("BottomSkillItemDes",{name:"军团之刃",des:"军团之刃军团之刃军团之刃军团之刃军团之刃"});break;case 3:sirius.view_manager.show_module("BottomSkillItemDes",{name:"寂静之魂",des:"寂静之魂寂静之魂寂静之魂"})}},e.prototype.skillTouchBegin=function(t){gp_core.am.actor_boss.trigger_new_attack()},e.prototype.skillTouchCancel=function(t){console.log("touchCancel======"+t.target.index)},e.prototype.skillTouchEnd=function(t){console.log("touchEnd======"+t.target.index),console.log(this.skillBtnTimer.currentCount),t.target.index===this.currentSkillBtn&&(this.skillBtnTimer.currentCount<2?this.skillClick(t):this.skillLongClick(t)),this.skillBtnTimer.stop()},e.prototype.skillTouchMove=function(t){console.log("touchMove======"+t.target.index),t.stopPropagation()},e.prototype.skillTouchReleaseOutside=function(t){console.log("touchReleaseOutside======"+t.target.index)},e.prototype.skillTouchTap=function(t){console.log("tap======"+t.target.index)},e}(eui.Component);__reflect(GameUIViewBottom.prototype,"GameUIViewBottom",["eui.UIComponent","egret.DisplayObject"]);var GameUIViewTop=function(t){function e(){var e=t.call(this)||this;return e.debug_flag=!1,e.skinName="resource/ZL/skins/top/GameUIViewTop.exml",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),console.log(this.btn_area),this.btn_area.touchEnabled=!0,this.btn_area.currentState="goFar",this.btn_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.areaClick,this),this.btn_x.touchEnabled=!0,this.btn_x.currentState="x1",this.btn_x.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xClick,this),this.btn_auto.touchEnabled=!0,this.btn_auto.currentState="auto",this.btn_auto.addEventListener(egret.TouchEvent.TOUCH_TAP,this.autoClick,this),this.setProgress(200,320),this.coin.text="55",this.times.text="X5"},e.prototype.setProgress=function(t,e){this.progress.label.text=t+"\\"+e;var i=t/e;this.progress.value=100*i},e.prototype.areaClick=function(){gp_core.swap_scale_x(),console.log(this.btn_area),"goFar"==this.btn_area.currentState?this.btn_area.currentState="goNear":this.btn_area.currentState="goFar"},e.prototype.xClick=function(){"x1"==this.btn_x.currentState?(gp_core.modify_global_speed(1),this.btn_x.currentState="x2"):(gp_core.modify_global_speed(0),this.btn_x.currentState="x1")},e.prototype.autoClick=function(){this.debug_flag=!this.debug_flag,this.debug_flag?sirius.view_manager.show_module("GameWin"):sirius.view_manager.pop_top_module(),"auto"==this.btn_auto.currentState?this.btn_auto.currentState="handMove":this.btn_auto.currentState="auto"},e}(eui.Component);__reflect(GameUIViewTop.prototype,"GameUIViewTop",["eui.UIComponent","egret.DisplayObject"]);var SkillListItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/ZL/skins/bottom/skill_list_item.exml",e}return __extends(e,t),e.prototype.dataChanged=function(){this.count.text=0===this.data.count?"":this.data.count+"",this.icon.source=this.data.source},e}(eui.ItemRenderer);__reflect(SkillListItem.prototype,"SkillListItem");var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.Component);t.BottomSkill=e,__reflect(e.prototype,"game.BottomSkill")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.Button);t.BottomSkillItem=e,__reflect(e.prototype,"game.BottomSkillItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.Component);t.TopCoin=e,__reflect(e.prototype,"game.TopCoin")}(game||(game={}));var LocalizationManager=function(){function t(){}return t.prototype._retrieve_string_set=function(t,e){var i="ui_local_"+t+"_"+e+"_json";return RES.getRes(i)},t.prototype.choose_language=function(t){this.lan_key=t,this.COMMON=this._retrieve_string_set("common",t),this.LK=this._retrieve_string_set("lk",t),this.YXY=this._retrieve_string_set("yxy",t),this.ZL=this._retrieve_string_set("zl",t)},t.prototype.s=function(t,e,i){return void 0===i&&(i="COMMON"),this[i][t][e]},t.prototype.s1=function(t,e,i,o){void 0===o&&(o="COMMON");var r=this[o][t][e],n=r.replace("@{0}",i);return n},t.prototype.sn=function(t,e,i,o){void 0===o&&(o="COMMON");for(var r=this[o][t][e],n=r,_=i.length,s=0;_>s;s++)n=n.replace("@{"+s+"}",i[s]);return n},t}();__reflect(LocalizationManager.prototype,"LocalizationManager");var character_anim_display=function(t){function e(e,i){var o=t.call(this)||this;return o._res_key=e,o._manager=i,o._character_display=null,o}return __extends(e,t),e.prototype.report_destroy=function(){this._manager._display_destroy(this)},e.prototype.destroy=function(){if(this._manager=null,this._character_display){var t=dragonBones.WorldClock.clock;t.remove(this._character_display.armature),this.removeChild(this._character_display),this._character_display.animation.stop(),this._character_display.removeEvent(dragonBones.EgretEvent.COMPLETE,this._animation_play_end,this),this._character_display.removeEvent(dragonBones.EgretEvent.ANIMATION_FRAME_EVENT,this._ANIM_FRAME_EVENT,this),this._character_display.armature.dispose(),this._character_display.dispose(),this._character_display=null}},e.prototype.res_ready=function(t,e){var i=e.buildArmatureDisplay(t.armature_name,t.character_name);this.addChild(i),dragonBones.WorldClock.clock.add(i.armature),this._character_display=i,this._character_display.addEvent(dragonBones.EgretEvent.COMPLETE,this._animation_play_end,this),this._character_display.addEvent(dragonBones.EgretEvent.ANIMATION_FRAME_EVENT,this._ANIM_FRAME_EVENT,this)},e.prototype._animation_play_end=function(t){},e.prototype._ANIM_FRAME_EVENT=function(t){},e.prototype.play=function(t,e){void 0===e&&(e=0),this._character_display&&this._character_display.animation.play(t,e)},e.prototype.hasAnimation=function(t){return this._character_display?this._character_display.animation.hasAnimation(t):!1},e.prototype.getBoundingBox=function(){return this._character_display.armature.getSlot("root_boundingBox")},e}(egret.DisplayObjectContainer);__reflect(character_anim_display.prototype,"character_anim_display");var character_anim_loader=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._clear=function(){this._res_no=null,this._index=-1,this._factory=null,this._listener=null,this._armature_name=null,this._character_name=null,this._tmp_png=null,this._tmp_tex=null,this._tmp_ske=null},e.prototype._before_destroy=function(){this._clear()},e.prototype.load_character=function(t,e,i,o){this._clear(),this._res_no=t,this._factory=e,this._index=i,this._listener=o,this._load_ske_res()},e.prototype._load_ske_res=function(){var t=this,e=this._res_no+"_ske_json";RES.getResAsync(e,function(e){t._is_destroyed||(t._tmp_ske=e,t._parse_ske(),t._load_tex_config_res())},this)},e.prototype._parse_ske=function(){var t=this._tmp_ske;this._armature_name="Armature",this._character_name=t.name},e.prototype._load_tex_config_res=function(){var t=this,e=this._res_no+"_tex_json";RES.getResAsync(e,function(e){t._is_destroyed||(t._tmp_tex=e,t._load_tex_img_res())},this)},e.prototype._load_tex_img_res=function(){var t=this,e=this._res_no+"_tex_png";RES.getResAsync(e,function(e){t._is_destroyed||(t._tmp_png=e,t._all_loaded())},this)},e.prototype._all_loaded=function(){this._factory.parseDragonBonesData(this._tmp_ske),this._factory.parseTextureAtlasData(this._tmp_tex,this._tmp_png),this._listener&&this._listener.anim_res_success(this._index,this._armature_name,this._character_name),this._clear()},e}(ns_sirius.sirius_base_object);__reflect(character_anim_loader.prototype,"character_anim_loader");var ConfirmDialog=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.view=new eui.Component,this.view.width=594,this.addChild(this.view),this.view.minHeight=224,this.view.horizontalCenter=0,this.view.verticalCenter=0;var t=new eui.Image;this.view.addChild(t),t.width=594,t.height=106,t.top=0,t.source="Univ_Frame_01_png";var e=new eui.Image;this.view.addChild(e),e.width=594,e.height=86,e.bottom=0,e.source="Univ_Frame_03_png",this.middle=new eui.Image,this.view.addChild(this.middle),this.middle.top=106,this.middle.scale9Grid=new egret.Rectangle(10,10,80,30),this.middle.width=594,this.middle.height=32,this.middle.source="Univ_Frame_02_png",this.info=new eui.Label,this.info.width=450,this.info.horizontalCenter=0,this.info.top=40,this.info.size=18,this.info.textColor=7755857,this.view.addChild(this.info);var i=new eui.Group;i.width=180,i.height=75,i.bottom=15,i.left=105,this.view.addChild(i);var o=new eui.Image;o.width=180,o.height=75,o.verticalCenter=0,o.horizontalCenter=0,o.source="Common_Button_Blue_png",i.addChild(o);var r=new eui.Label;r.width=180,r.height=75,r.verticalCenter=0,r.horizontalCenter=0,r.size=26,r.stroke=2,r.strokeColor=5857698,r.textAlign=egret.HorizontalAlign.CENTER,r.verticalAlign=egret.VerticalAlign.MIDDLE,r.text="取消",i.addChild(r);var n=new eui.Group;n.width=180,n.height=75,n.bottom=15,n.right=105,this.view.addChild(n);var _=new eui.Image;_.width=180,_.height=75,o.verticalCenter=0,_.horizontalCenter=0,_.source="Common_Button_Red_png",n.addChild(_);var s=new eui.Label;s.width=180,s.height=75,s.verticalCenter=0,s.horizontalCenter=0,s.size=26,s.stroke=2,s.strokeColor=13384788,s.textAlign=egret.HorizontalAlign.CENTER,s.verticalAlign=egret.VerticalAlign.MIDDLE,s.text="确定",n.addChild(s),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancel,this),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.confirm,this)},e.prototype.cancel=function(){this._cancel_callback&&this._cancel_callback(),sirius.view_manager.clear_alert()},e.prototype.confirm=function(){this._confirm_callback&&this._confirm_callback(),sirius.view_manager.clear_alert()},e.prototype.setInfo=function(t){this.info.text=t,console.log(this.info.height),this.info.height>80&&(this.view.height=this.info.height+150,this.middle.height=this.view.height-192)},e.prototype.setCallBack=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._cancel_callback=e,this._confirm_callback=t},e}(ns_sirius.sirius_view_base);__reflect(ConfirmDialog.prototype,"ConfirmDialog");var character_anim_manager=function(t){function e(){var e=t.call(this)||this;return e._views=new ns_sirius.doubly_linked_list,e}return __extends(e,t),e.prototype._before_destroy=function(){this._loader&&(this._loader.destroy(),this._loader=null),this._factory&&(this._factory.clear(!0),this._factory=null),this._views&&this._views.destroy()},e.prototype._init_defs=function(t){var e=t.length;this._res_defs=new Array(e);for(var i=0;e>i;i++){var o=new character_anim_def;this._res_defs[i]=o,o.loaded=!1,o.res_key=t[i]}},e.prototype.load_res=function(t){t&&0!=t.length&&(this._keys=t,this._init_defs(t),this._loader=new character_anim_loader,this._factory=new dragonBones.EgretFactory,this._load_res_recursively(0))},e.prototype._load_res_recursively=function(t){var e=this._keys.length;if(t>e-1)return void this._all_loaded();var i=this._keys[t];this._loader.load_character(i,this._factory,t,this)},e.prototype.anim_res_success=function(t,e,i){var o=this._res_defs[t];o.loaded=!0,o.armature_name=e,o.character_name=i,this.distribute_res_load_success(o),this._load_res_recursively(t+1)},e.prototype._all_loaded=function(){console.log("全部加载完毕"),this._loader&&(this._loader.destroy(),this._loader=null)},e.prototype.generate_display=function(t){var e=new character_anim_display(t,this),i=this._find_res_def(t);return this._views.push(e),i&&i.loaded&&e.res_ready(i,this._factory),e},e.prototype._display_destroy=function(t){this._views&&0!=this._views.length&&this._views.remove(t)},e.prototype.distribute_res_load_success=function(t){var e=this;this._views.loop(function(i){i.element.res_ready(t,e._factory)})},e.prototype._find_res_def=function(t){for(var e=this._res_defs.length,i=0;e>i;i++)if(this._res_defs[i].res_key===t)return this._res_defs[i];return null},e}(ns_sirius.sirius_base_object);__reflect(character_anim_manager.prototype,"character_anim_manager",["Icharacter_anim_loader_listener"]);var GamePlayCore=function(t){function e(){var e=t.call(this)||this;return egret.Ticker.getInstance().register(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3),ns_sirius.world_clock.update(t)},e),e.layout_config=new GPC_layout_config,e._pan_handler=new GameCorePanHandler,e.ppc=new PerspectiveCore,e._machine=new MWN_machine,e._machine.machine_initialize(e,e,null),e}return __extends(e,t),e.prototype.modify_global_speed=function(t){0==t?(dragonBones.WorldClock.clock.timeScale=1,ns_sirius.world_clock.time_scale=1):(dragonBones.WorldClock.clock.timeScale=2,ns_sirius.world_clock.time_scale=2)},e.prototype._debug_global_speed=function(t){dragonBones.WorldClock.clock.timeScale=t,ns_sirius.world_clock.time_scale=t},e.prototype.core_init=function(t){this.stage=t,this._pan_handler.core_init(this,t)},e.prototype.register_core_view=function(t,e){this.ppc.core_init(this.stage,e),this._game_core_view=t,this._game_core_view.core_init(this)},e.prototype.prepare_game=function(){this._machine.state_change(MWN_GM_State_Enum.PREPARE)},e.prototype.start_game=function(){this._machine.state_change(MWN_GM_State_Enum.RUNNING)},e.prototype.end_game=function(){this._machine.state_change(MWN_GM_State_Enum.END)},e.prototype.sm_state_changed=function(t,e,i){console.log("from : "+t.state_str()+" to : "+e.state_str())},e.prototype._sm_prepare=function(){var t=this,e=3,i=3;this.layout_config.cal_layout(e,i),this.ppc._shader_offset_y=this.layout_config.shader_offset_y_max,this.mdm=new GC_MetadataManager,this.mdm.debug_init(),this._game_core_view.prepare_game(),this._generate_map_layout(),this._game_core_view.room_start_painting(),console.log("========== LAYOUT =========="),console.log(this.layout_config),console.log("========== MAP =========="),console.log(this.map),this.resm=new GameCoreResManager,this.taling_resm=new TalingResManager,this.resm.load_res(function(){t.taling_resm.load_res(function(){appm.game_res_prepare_success()})}),this.effect_resm=new EffectResLoader,this.effect_resm.load_res()},e.prototype._sm_running=function(){this.am=new GP_ActorManager,this.am.manager_init(this),this._game_core_view.start_game(),this.map.debug_generate_defenders()},e.prototype._sm_end=function(){this._dispose_res()},e.prototype.swap_scale_x=function(){this._pan_handler.swap_anim()},e.prototype.mark_perspective_needs_update=function(){this._machine.get_current_state_enum()==MWN_GM_State_Enum.RUNNING&&(this.map.perspective_update(),this._game_core_view.perspective_update())},e.prototype._generate_map_layout=function(){this.map&&this.map.destroy(),this.map=new GameMap,this.map.generate_map_layout(),this.map.perspective_update()},e.prototype._dispose_res=function(){this.map&&(this.map.destroy(),this.map=null),this.am&&(this.am.destroy(),this.am=null),this.mdm&&(this.mdm.destroy(),this.mdm=null),this._game_core_view.game_res_dispose()},e}(ns_sirius.sirius_base_object);__reflect(GamePlayCore.prototype,"GamePlayCore",["ns_sirius.IGP_StateMachineListener"]);var GPC_layout_config=function(){function t(){this.row_gap=40,this.column_gap=40,this.header_gap=100,this.footer_gap=100,this.canvas_fixed_w=1024,this.canvas_fixed_h=512,this.row_count=-1,this.column_count=-1,this.shader_offset_x_min=0,this.shader_offset_x_max=0,this.shader_offset_y_min=0,this.shader_offset_y_max=0,this.canvas_scale_x=0,this.canvas_scale_y=0,this.vertical_fixed=!1}return t.prototype.cal_layout=function(e,i){this.column_count=i,this.row_count=e,this.element_count=this.column_count*this.row_count,this.cell_w=170,this.cell_h=140,this.character_global_scale=1,t.distance_ratio_w_to_h=1,this.boss_w=2*this.cell_w,this.boss_h=2*this.cell_h,this.pawn_born_width=this.cell_w,this.pawn_born_height=this.cell_h,this.room_orig_x=this.boss_w+this.column_gap,this.room_orig_y=this.header_gap;var o=this.row_count*(this.cell_h+this.row_gap),r=this.column_count*(this.cell_w+this.column_gap);this.total_w=r+this.boss_w+this.pawn_born_width+2*this.column_gap,this.total_h=o+this.header_gap+this.footer_gap,this.boss_view_x=0,this.boss_view_y=.5*(this.total_h-this.row_gap)-.5*this.boss_h,this.pawn_born_x=this.total_w-.5*this.pawn_born_width,this.pawn_born_y=.5*this.total_h,this.canvas_scale_x=this.total_w/this.canvas_fixed_w,this.canvas_scale_y=this.total_h/this.canvas_fixed_h;var n=2*this.total_h/sirius.device_info.stage_height;this.shader_offset_y_max=n-2;var _=2*this.total_w/sirius.device_info.initial_optimal_w,s=.5*Math.abs(_-1);this.shader_offset_x_min=-s,this.shader_offset_x_max=s,this.pr_w_ratio=this.canvas_fixed_w/this.total_w,this.pr_h_ratio=this.canvas_fixed_h/this.total_h},t.prototype.rowcolumn_to_uindex=function(t,e){if(0>t||0>e)return-1;if(t>this.row_count-1||e>this.column_count-1)return-1;var i=t*this.column_count+e;return i},t.prototype.uindex_to_rowcolumn=function(t){if(0>t||t>this.element_count-1)return new egret.Point(-1,-1);var e=Math.floor(t/this.column_count),i=t-e*this.column_count;return new egret.Point(e,i)},t.distance_ratio_w_to_h=1,t}();__reflect(GPC_layout_config.prototype,"GPC_layout_config");var GP_ActorManager=function(t){function e(){var e=t.call(this)||this;return e._pawn_born_cursor=0,e._defenders_needs_check_death=!1,e._assaulters_needs_check_death=!1,e._assault_depth_needs_update=!1,e._actors_defence=new Array,e._actors_assault=new Array,e}return __extends(e,t),e.prototype.mark_defenders_check_death=function(){this._defenders_needs_check_death=!0},e.prototype.mark_assaulters_check_death=function(){this._assaulters_needs_check_death=!0},Object.defineProperty(e.prototype,"actor_boss",{get:function(){return this._actor_boss},enumerable:!0,configurable:!0}),e.prototype.mark_assault_depth_update=function(){this._assault_depth_needs_update=!0},e.prototype._before_destroy=function(){for(var t=this._actors_defence.length,e=0;t>e;e++)this._actors_defence[e].destroy();this._actors_defence=null,t=this._actors_assault.length;for(var e=0;t>e;e++)this._actors_assault[e].destroy();this._actors_assault=null,this._actor_boss&&(this._actor_boss.destroy(),this._actor_boss=null),this._gc.stage.removeEventListener(egret.Event.ENTER_FRAME,this._gc_update,this),this._gc=null},e.prototype.manager_init=function(t){this._gc=t,this._gc.stage.addEventListener(egret.Event.ENTER_FRAME,this._gc_update,this)},e.prototype._gc_update=function(t){if(this._gc._machine.get_current_state_enum()==MWN_GM_State_Enum.RUNNING){var e=this._actors_assault.length;this._pawn_born_cursor++;var i=60;if(this._pawn_born_cursor==i){this._pawn_born_cursor=0;var o=gp_core.mdm.debug_assault_template();if(20>e){var r=this.born_pawn(GameCharacterType.Assaulter);r.skill_hierarchy_establish(o),r.put_on_the_map_and_run(gp_core.map.get_birth_room().layout_info.room_pos,MapRoomSlotPosition.empty_slot_pos)}}this._update_actors()}},e.prototype._update_actors=function(){var t=0;t=this._actors_defence.length;for(var e=0;t>e;e++){var i=this._actors_defence[e];i.is_dead()||this._actors_defence[e].frame_update()}t=this._actors_assault.length;for(var e=0;t>e;e++){var o=this._actors_assault[e];o.is_dead()||o.frame_update()}this._actor_boss&&this._actor_boss.frame_update(),this._defenders_needs_check_death&&(this._defenders_needs_check_death=!1,this._actors_defence=this._check_dead_actors(this._actors_defence)),this._assaulters_needs_check_death&&(this._assaulters_needs_check_death=!1,this._actors_assault=this._check_dead_actors(this._actors_assault)),this._assault_depth_needs_update&&(this._assault_depth_needs_update=!1,this._gc.map.assault_depth_update())},e.prototype.loop_moving_character_by_room=function(t,e){if(this._actors_assault)for(var i=this._actors_assault.length,o=0;i>o;o++){var r=this._actors_assault[o];r.current_room_uindex()==t&&e(r)}},e.prototype.born_pawn=function(t){var e,i=this._gc._game_core_view.debug_born_pawn();return t==GameCharacterType.Defender?(e=new GamePawn_Defence,this._actors_defence.push(e)):t==GameCharacterType.Assaulter&&(e=new GamePawn_Assault,this._actors_assault.push(e)),i.bind_entity(e),e.bind_view(i),this.debug_init_battle_infop(e,t),e
},e.prototype.born_boss=function(){var t=this._gc._game_core_view.debug_born_boss(),e=new GameBossEntity;return t.bind_entity(e),e.bind_view(t),this._actor_boss=e,this.debug_init_battle_infop(e,GameCharacterType.Boss),e},e.prototype.debug_init_battle_infop=function(t,e){var i=RES.getRes("defence_num_json"),o=RES.getRes("assault_num_json");e==GameCharacterType.Defender?(t.md_battle.current_life=t.md_battle.total_life=i.life,t.md_battle.current_attack=i.attack,t.md_battle.accuracy=i.accuracy,t.md_battle.dodge=i.dodge,t.md_battle.action_interval=i.action_interval):e==GameCharacterType.Assaulter?(t.md_battle.current_life=t.md_battle.total_life=o.life,t.md_battle.current_attack=o.attack,t.md_battle.accuracy=o.accuracy,t.md_battle.dodge=o.dodge,t.md_battle.action_interval=o.action_interval):e==GameCharacterType.Boss?(t.md_battle.current_life=t.md_battle.total_life=1e4,t.md_battle.current_attack=500,t.md_battle.accuracy=1e3,t.md_battle.dodge=100,t.md_battle.action_interval=1e3):console.error("ERROR !")},e.prototype._check_dead_actors=function(t){for(var e=t.length,i=new Array,o=0;e>o;o++){var r=t[o];r.is_dead()?r.destroy():i.push(r)}return i},e}(ns_sirius.sirius_base_object);__reflect(GP_ActorManager.prototype,"GP_ActorManager");var UICommon;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.timer=new egret.Timer(300,0),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touch_begin,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.touch_end,e),e}return __extends(e,t),e.prototype.touch_begin=function(t){this.timer.reset(),this.timer.start()},e.prototype.touch_end=function(t){this.timer.stop(),this.timer.currentCount<2?this.dispatchEvent(new i(i.click)):this.dispatchEvent(new i(i.longClick))},e}(eui.Group);t.Group=e,__reflect(e.prototype,"UICommon.Group");var i=function(t){function e(e,i,o){return void 0===i&&(i=!1),void 0===o&&(o=!1),t.call(this,e,i,o)||this}return __extends(e,t),e.click="点击",e.longClick="长按",e}(egret.Event);t.ClickEvent=i,__reflect(i.prototype,"UICommon.ClickEvent")}(UICommon||(UICommon={}));var COMMON_consts=function(){function t(){}return t.generate_consts=function(){t.scaleW=sirius.device_info.safe_width/sirius.device_info.design_width,t.font_size_22=22*t.scaleW,t.font_size_20=20*t.scaleW,t.font_size_18=18*t.scaleW,t.font_size_32=32*t.scaleW,t.font_size_24=24*t.scaleW,t.font_size_30=30*t.scaleW,t.font_size_26=26*t.scaleW},t}();__reflect(COMMON_consts.prototype,"COMMON_consts");var GameCorePanHandler=function(t){function e(){var e=t.call(this)||this;return e._scale_is_anim=!1,e._anim_count=20,e._anim_cursor=0,e._start_ox=0,e._start_mouse_x=0,e._start_oy=0,e._start_mouse_y=0,e}return __extends(e,t),e.prototype.core_init=function(t,e){this._gc=t,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouse_down,this),e.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouse_move,this),e.addEventListener(egret.TouchEvent.TOUCH_END,this.mouse_up,this),e.addEventListener(egret.Event.ENTER_FRAME,this._handle_update,this)},e.prototype.swap_anim=function(){this._scale_is_anim||(this._anim_cursor=0,this._gc.layout_config.vertical_fixed=!this._gc.layout_config.vertical_fixed,this._start_scale=this._gc.ppc._shader_last_scale,this._end_scale=this._gc.layout_config.vertical_fixed?.6:1,this._scale_step=this._end_scale-this._start_scale,this._start_offset_y=this._gc.ppc._shader_offset_y,this._gc.ppc._shader_offset_y=gp_core.layout_config.shader_offset_y_max,this._end_offset_y=gp_core.layout_config.shader_offset_y_max,this._offsety_step=this._end_offset_y-this._start_offset_y,this._scale_is_anim=!0)},e.prototype._handle_update=function(t){if(this._scale_is_anim){var e=1e3*this._anim_cursor/this._anim_count/1e3,i=this._start_scale+e*this._scale_step,o=this._start_offset_y+e*this._offsety_step;this._gc.ppc._shader_offset_y=o,this._gc.ppc._shader_last_scale=i,this._gc.mark_perspective_needs_update(),this._anim_cursor++,this._anim_cursor>=this._anim_count&&(this._scale_is_anim=!1)}},e.prototype.mouse_down=function(t){this._scale_is_anim||(this._start_mouse_x=t.stageX,this._start_ox=this._gc.ppc._shader_offset_x,this._start_mouse_y=t.stageY,this._start_oy=this._gc.ppc._shader_offset_y)},e.prototype.mouse_move=function(t){this._scale_is_anim||(this._move_x(t),this._move_y(t),this._gc.mark_perspective_needs_update())},e.prototype._move_x=function(t){var e=t.stageX-this._start_mouse_x,i=this._start_ox+.003*e;i>gp_core.layout_config.shader_offset_x_max?i=gp_core.layout_config.shader_offset_x_max:i<gp_core.layout_config.shader_offset_x_min&&(i=gp_core.layout_config.shader_offset_x_min),this._gc.ppc._shader_offset_x=i},e.prototype._move_y=function(t){if(this._gc.layout_config.vertical_fixed)return void(this._gc.ppc._shader_offset_y=gp_core.layout_config.shader_offset_y_max);var e=t.stageY-this._start_mouse_y,i=this._start_oy-.004*e;i>gp_core.layout_config.shader_offset_y_max?i=gp_core.layout_config.shader_offset_y_max:i<gp_core.layout_config.shader_offset_y_min&&(i=gp_core.layout_config.shader_offset_y_min),this._gc.ppc._shader_offset_y=i},e.prototype.mouse_up=function(t){},e}(egret.HashObject);__reflect(GameCorePanHandler.prototype,"GameCorePanHandler");var PerspectiveCore=function(){function t(){this.buffer_point_2d_glboal=new egret.Point,this.buffer_point_3d_glboal=new egret.Point,this._shader_offset_x=0,this._shader_offset_y=0,this._shader_last_scale=1}return t.prototype.core_init=function(t,e){this._stage=t,this._ref_view=e},t.prototype.convert_2_to_3_global=function(t,e,i){var o=.2,r=.5,n=this._stage.stageWidth,_=this._stage.stageHeight,s=2*t.x/n-1,a=2*-t.y/_+1,l=s*this._shader_last_scale,c=a*this._shader_last_scale+this._shader_last_scale-1,u=.5*(c+1)*o+.1*this._shader_offset_y,h=l+this._shader_offset_x,p=c+this._shader_offset_y,d=h*r/(u+r),f=p*r/(u+r);i&&(i.x=this._shader_last_scale*r/(u+r),i.y=i.x),e.x=(d+1)*n*.5,e.y=-(f-1)*_*.5},t.prototype.cal_3d_pos=function(t,e,i){this._ref_view.localToGlobal(t.x,t.y,this.buffer_point_2d_glboal),this.convert_2_to_3_global(this.buffer_point_2d_glboal,this.buffer_point_3d_glboal,i),this._ref_view.globalToLocal(this.buffer_point_3d_glboal.x,this.buffer_point_3d_glboal.y,e)},t}();__reflect(PerspectiveCore.prototype,"PerspectiveCore");var ns_sirius;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.mm=new t.module_marshal,i.layes=new t.layer_partition,i.sirius_public=new t.SiriusPublic,i}return __extends(i,e),i.prototype.core_init=function(){this.mm.core_init(this),this.layes.core_init(this),this.sirius_public.core_init(this)},i}(t.sirius_base_object);t.SiriusCore=e,__reflect(e.prototype,"ns_sirius.SiriusCore")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.view_manager=new t.app_vh_manager,i.device_info=new t.sirius_device_info,i}return __extends(i,e),i.prototype.core_init=function(t){this._sirius=t,this.view_manager.core_init(t)},i.prototype.debug_foo=function(){this.view_manager.show_popup_text_msg("You are connected to the sirius hierarchy.")},i}(t.sirius_element_module);t.SiriusPublic=e,__reflect(e.prototype,"ns_sirius.SiriusPublic")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(){this._animatebles=new Array,this._timeScale=1}return t.frame_to_ms=function(t){return Math.round(1e3*t/60)},Object.defineProperty(t.prototype,"time_scale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!0,configurable:!0}),t.prototype.update=function(t){if(1!==this._timeScale&&(t*=this._timeScale),0>=t)throw"passedTime should not be negative";for(var e=0,i=0,o=this._animatebles.length;o>e;++e){var r=this._animatebles[e];null!==r?(i>0&&(this._animatebles[e-i]=r,this._animatebles[e]=null),r.update(t)):i++}if(i>0){for(o=this._animatebles.length;o>e;++e){var n=this._animatebles[e];null!==n?this._animatebles[e-i]=n:i++}this._animatebles.length-=i}},t.prototype.add=function(t){t&&this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null,t.clock=null)},t.prototype.removeAt=function(t){t>=0&&(this._animatebles[t].clock=null,this._animatebles[t]=null)},t}();t.anim_clock=e,__reflect(e.prototype,"ns_sirius.anim_clock"),t.world_clock=new e}(ns_sirius||(ns_sirius={}));var MWN_GM_State_Enum=function(){function t(){}return t.DEFAULT=0,t.IDLE=1,t.PREPARE=2,t.RUNNING=3,t.END=5,t}();__reflect(MWN_GM_State_Enum.prototype,"MWN_GM_State_Enum");var MWN_machine=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._before_destroy=function(){this._s_idle&&(this._s_idle.destroy(),this._s_idle=null),this._s_prepare&&(this._s_prepare.destroy(),this._s_prepare=null),this._s_running&&(this._s_running.destroy(),this._s_running=null),this._s_end&&(this._s_end.destroy(),this._s_end=null),t.prototype._before_destroy.call(this)},e.prototype._states_init=function(t){this._s_idle=new GP_State_IDLE,this._s_idle.state_init(this,t),this._s_prepare=new GP_State_PREPARE,this._s_prepare.state_init(this,t),this._s_running=new GP_State_RUNNING,this._s_running.state_init(this,t),this._s_end=new GP_State_END,this._s_end.state_init(this,t)},e.prototype.get_state_by_enum=function(t){switch(t){case MWN_GM_State_Enum.IDLE:return this._s_idle;case MWN_GM_State_Enum.PREPARE:return this._s_prepare;case MWN_GM_State_Enum.RUNNING:return this._s_running;case MWN_GM_State_Enum.END:return this._s_end;default:return this._s_default}},e}(ns_sirius.GP_StateMachine);__reflect(MWN_machine.prototype,"MWN_machine");var ns_sirius;!function(t){var e=function(e){function i(t,i,o){void 0===t&&(t=null),void 0===i&&(i=0),void 0===o&&(o=null);var r=e.call(this)||this;return r._listener=t,r.timer_id=i,r._param=o,r}return __extends(i,e),i.prototype.init=function(t){return void 0===t&&(t=null),this.timer_active(),this},i.prototype.timer_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.timer_deactive=function(){this._clock&&this._clock.remove(this)},i.prototype._before_destroy=function(){this.stop(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._param=null},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tick_cursor",{get:function(){return this._tick_cursor},enumerable:!0,configurable:!0}),i.prototype.start=function(t,e,i,o){return void 0===i&&(i=0),void 0===o&&(o=!1),this._normalized_time=0,this._real_time=0,this._tick_cursor=0,this._is_animating=!0,this._anim_duration=t,this._loop_count=e,o?this._tick_once():i>0&&(this._real_time+=i),this},i.prototype.stop=function(){this._is_animating=!1},i.prototype.update=function(t){this._is_animating&&(this._real_time+=t,this._normalized_time=this._real_time/this._anim_duration,this._normalized_time<1||(this._tick_once(),this._loop_count<=0||this._tick_cursor>=this._loop_count&&(this.stop(),this._post_finish())))},i.prototype._tick_once=function(){this._normalized_time=0,this._real_time=0,this._listener.rtimer_tick(this),this._tick_cursor++},i.prototype._post_finish=function(){this._listener.rtimer_finish(this)},i}(t.sirius_base_object);t.timer_rtime_based=e,__reflect(e.prototype,"ns_sirius.timer_rtime_based",["ns_sirius.IAnimatable"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.design_width=1136,e.design_height=640,e.stage_width=0,e.stage_height=0,e.safe_width=0,e.safe_height=0,e.popup_width=0,e.popup_height=0,e.popup_con_width=0,e.popup_con_height=0,e.initial_optimal_w=0,e}return __extends(e,t),e.prototype.syn_stage_size=function(t,e){this.stage_width=t,this.stage_height=e,this.safe_height=e,this.safe_width=t>this.design_width?this.design_width:t,this.popup_height=.637*this.safe_height,this.popup_width=.746*this.popup_height,this.popup_con_width=Math.floor(.691*this.popup_height),this.popup_con_height=Math.floor(.905*this.popup_height)},e.prototype.device_info_init=function(){var t=Math.ceil(1125*this.design_height/2436);this.stage_width>=this.design_width?this.initial_optimal_w=this.design_width:this.initial_optimal_w=t},e}(t.sirius_base_object);t.sirius_device_info=e,__reflect(e.prototype,"ns_sirius.sirius_device_info")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.after_state_init=function(){},e.prototype.state_enum=function(){return 0},e.prototype.state_str=function(){return"Default"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(t.GP_StateBase);t.GP_State_Default=e,__reflect(e.prototype,"ns_sirius.GP_State_Default")}(ns_sirius||(ns_sirius={}));var sirius,gp_core,appm,AppRootView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.width=sirius.device_info.design_width,e.height=sirius.device_info.design_height,e.horizontalCenter=0,e.top=0,e}return __extends(e,t),e}(ns_sirius.sirius_view_base);__reflect(AppRootView.prototype,"AppRootView",["ns_sirius.Isirius_app_root_view"]);var Main=function(t){function e(){var e=t.call(this)||this;return e._debug_flag=!1,e._debug_index=0,appm=new AppModel,e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){};var i=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",i),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.load_crit_res().then(function(t){e.createGameScene()},function(t){console.log(t)})},e.prototype.load_crit_res=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),[4,appm.crit_loader.load_res()];case 2:return t.sent(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,13,,14]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadConfig("resource/COMMON/COMMON.res.json","resource/")];case 2:return i.sent(),[4,RES.loadConfig("resource/ZL/ZL.res.json","resource/")];case 3:return i.sent(),[4,RES.loadConfig("resource/YXY/YXY.res.json","resource/")];case 4:return i.sent(),[4,RES.loadConfig("resource/LK/LK.res.json","resource/")];case 5:return i.sent(),[4,RES.loadConfig("resource/LK/dy_res/dy_character.res.json","resource/")];case 6:return i.sent(),[4,this.loadTheme()];case 7:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 8:return i.sent(),[4,RES.loadGroup("COMMON",0,t)];case 9:return i.sent(),[4,RES.loadGroup("ZL",0,t)];case 10:return i.sent(),[4,RES.loadGroup("YXY",0,t)];case 11:return i.sent(),[4,RES.loadGroup("LK",0,t)];case 12:return i.sent(),this.stage.removeChild(t),[3,14];case 13:return e=i.sent(),console.error(e),[3,14];case 14:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var o=new eui.Theme("resource/default.thm.json",t.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype._syn_stage_size=function(){var t=this.stage.stageWidth,e=this.stage.stageHeight;sirius.device_info.syn_stage_size(t,e)},e.prototype._resize_handler=function(t){this._syn_stage_size(),this._app_root_view.width=sirius.device_info.safe_width,gp_core.mark_perspective_needs_update()},e.prototype.createGameScene=function(){var t=new ns_sirius.SiriusCore;t.core_init(),sirius=t.sirius_public,this._syn_stage_size(),sirius.device_info.device_info_init(),COMMON_consts.generate_consts(),gp_core=new GamePlayCore,gp_core.core_init(this.stage);var e=new GameCoreView;this.addChild(e),gp_core.register_core_view(e,e.get_coord_convert_ref_view()),this._app_root_view=new AppRootView,this.addChild(this._app_root_view);var i=new GameUIView;this._app_root_view.addChild(i),sirius.view_manager.view_hierarchy_establish(this._app_root_view),this.addEventListener(egret.Event.RESIZE,this._resize_handler,this),this._resize_handler(null),appm.app_init()},e.prototype.onButtonClick=function(t){appm.debug_flag=!appm.debug_flag},e.prototype.btn_debug_click2=function(t){gp_core.resm.remove_all_data()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var GP_State_END=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return MWN_GM_State_Enum.END},e.prototype.state_str=function(){return"END"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._gpcore._sm_end(),this._machine.state_change(MWN_GM_State_Enum.IDLE)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(MWN_State_Base);__reflect(GP_State_END.prototype,"GP_State_END");var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.establish_reflection_table(),e}return __extends(e,t),e.prototype.establish_reflection_table=function(){this._rtable=lk_rtable.concat(yxy_rtable).concat(zl_rtable);for(var t=this._rtable.length,e=0;t>e;e++)this._rtable[e].index=e},e.prototype.register_sm=function(t){this._sm=t},e.prototype.show_module=function(t,e,i,o){void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=null);var r=this._find_module_by_name(t);if(!r)return void console.error("不存在模块 ： "+t);var n=new r.vm,_=new r.view;this._sm.show_module(_,n,e,i,o)},e.prototype.show_sub_module=function(t,e,i,o,r){void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=null);var n=this._find_module_by_name(t);if(!n)return void console.error("不存在模块 ： "+t);var _=new n.vm,s=new n.view;this._sm.show_sub_module(s,_,e,i,o,r)},e.prototype.show_sub_module_init=function(t,e,i,o,r,n){void 0===o&&(o=null),void 0===r&&(r=null),void 0===n&&(n=null),this._sm.show_sub_module(t,e,i,o,r,n)},e.prototype._find_module_by_name=function(t){if(!this._rtable)return null;for(var e=this._rtable.length,i=0;e>i;i++){var o=this._rtable[i];if(o.module_name==t)return o}return null},e}(t.sirius_element_module);t.module_marshal=e,__reflect(e.prototype,"ns_sirius.module_marshal")}(ns_sirius||(ns_sirius={}));var GP_State_IDLE=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return MWN_GM_State_Enum.IDLE},e.prototype.state_str=function(){return"IDLE"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(MWN_State_Base);__reflect(GP_State_IDLE.prototype,"GP_State_IDLE");var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.mark_as_fullfill(),e}return __extends(e,t),e}(t.sirius_view_base);t.sirius_root_layer=e,__reflect(e.prototype,"ns_sirius.sirius_root_layer");var i=function(i){function o(){return i.call(this)||this}return __extends(o,i),o.prototype.view_hierarchy_establish=function(e){this._app_root_view=e;var i=t.app_layer_def,o=i.length;this.sms=new Array(o);for(var r=0;o>r;r++){var n=i[r],_=this._create_layer_by_def(n);this.sms[r]=_}},o.prototype._create_layer_by_def=function(i){var o=new e;this._app_root_view.addChild(o),o.update_visible(!1),i.disable_touch&&(o.touchEnabled=!1);var r=null;return r=i.exclusive?new t.layer_exclusive_manager:1==i.sm_type?new t.layer_module_sm:new t.layer_stack_manager,r.manager_init(o,i.lid,this._sirius),r},o}(t.sirius_element_module);t.layer_partition=i,__reflect(i.prototype,"ns_sirius.layer_partition")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._is_visible=!1,e}return __extends(e,t),e.prototype.manager_init=function(t,e,i){this._root_view=t,this.layer_id=e,this._sirius=i},e.prototype.get_root_view=function(){return this._root_view},e.prototype.attach_target_view=function(t){this._target_view=t},e.prototype.show=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=null),this._is_visible=!0,this._root_view.addChild(this._target_view),this._target_view.attached_to_display_tree(t),this._update_container_visible(),this._target_view},e.prototype.hide=function(){this._is_visible=!1,this._target_view.detaching_from_display_tree(),this._target_view.remove_from_parent(),this._update_container_visible()},e.prototype.clear_all=function(){this.hide()},e.prototype._update_container_visible=function(){this._root_view.update_visible(this._is_visible)},e}(t.sirius_base_object);t.layer_exclusive_manager=e,__reflect(e.prototype,"ns_sirius.layer_exclusive_manager",["ns_sirius.Isirius_layer_manager"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show_module=function(t,e,i,o,r){return void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=null),this._root_view.addChild(t),t.attached_to_display_tree(i),e.vm_pre_init(o,t,this._sirius),t.view_pre_init(i,e,this._sirius),t.view_init(),e.vm_init(),this._s_push(e),this._update_container_visible(),t},e.prototype.show_sub_module=function(t,e,i,o,r,n){return void 0===o&&(o=null),void 0===r&&(r=null),void 0===n&&(n=null),i.addChild(t),t.attached_to_display_tree(o),e.vm_pre_init(r,t,this._sirius),t.view_pre_init(o,e,this._sirius),t.view_init(),e.vm_init(),t},e.prototype.clear_all=function(){if(!this._s_is_empty()){for(var t=0;t<=this._top;t++){var e=this._mstack[t],i=e.pair_view;i.detaching_from_display_tree(),i.destroy(),e.destroy()}this._s_clear(),this._update_container_visible()}},e.prototype.pop_top=function(){if(this._s_is_empty())return void console.log("视图栈已经为空了");var t=this._s_top(),e=t.pair_view;e.detaching_from_display_tree(),e.destroy(),t.destroy(),this._s_pop(),this._update_container_visible()},e.prototype.shift_first=function(){if(this._s_is_empty())return void console.log("视图栈已经为空了");var t=this._s_bottom(),e=t.pair_view;e.detaching_from_display_tree(),e.destroy(),t.destroy(),this._s_shift(),this._update_container_visible()},e}(t.layer_stack_manager);t.layer_module_sm=e,__reflect(e.prototype,"ns_sirius.layer_module_sm")}(ns_sirius||(ns_sirius={}));var GP_State_PREPARE=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return MWN_GM_State_Enum.PREPARE},e.prototype.state_str=function(){return"PREPARE"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._gpcore._sm_prepare()},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(MWN_State_Base);__reflect(GP_State_PREPARE.prototype,"GP_State_PREPARE");var GP_State_RUNNING=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return MWN_GM_State_Enum.RUNNING},e.prototype.state_str=function(){return"RUNNING"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._gpcore._sm_running()},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(MWN_State_Base);__reflect(GP_State_RUNNING.prototype,"GP_State_RUNNING");var AdventureMapItem=function(t){function e(){var e=t.call(this)||this;return e.bg=new eui.Image,e.bg.verticalCenter=0,e.bg.horizontalCenter=0,e.addChild(e.bg),e.lock=new eui.Image,e.lock.verticalCenter=0,e.lock.horizontalCenter=0,e.lock.width=120,e.lock.height=120,e.lock.source="Common_Pic_Lock_png",e.addChild(e.lock),e.lock.visible=!1,e.touchEnabled=!1,e.lock.touchEnabled=!1,e.bg.touchEnabled=!1,e}return __extends(e,t),e.prototype.setType=function(t){switch(t){case 0:this.bg.source="Common_Pic_Event_01_png";break;case 1:this.bg.source="Common_Pic_Event_02_png";break;case 2:this.bg.source="Common_Pic_Event_03_png"}},e.prototype.setState=function(t){switch(t){case 0:this.lock.visible=!1,this.touchEnabled=!1,this.bg.source="Event_Pic_BlankBG_01_png";break;case 1:this.lock.visible=!0,this.touchEnabled=!1;break;case 2:this.lock.visible=!1,this.touchEnabled=!0;break;case 3:this.lock.visible=!1,this.touchEnabled=!1}},e.prototype.setIndex=function(t){this.index=t},e.prototype.getIndex=function(){return this.index},e}(eui.Group);__reflect(AdventureMapItem.prototype,"AdventureMapItem");var ns_sirius;!function(t){t.sirius_network_consts={protocol:"http",host_address:"47.90.211.44:6002"}}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(t){void 0===t&&(t=!0),this.should_parse_json=t}return t}();t.common_req_param=e,__reflect(e.prototype,"ns_sirius.common_req_param");var i=function(i){function o(t){void 0===t&&(t=null);var o=i.call(this)||this;return o._req_param=null,t?o._req_param=t:o._req_param=new e,o}return __extends(o,i),o.prototype._before_destroy=function(){this._req_param=null,this._cb_s=null,this._cb_f=null},o.prototype._handle_fail=function(t){this._cb_f&&this._cb_f(t),this.destroy()},o.prototype._handle_success=function(t){this._cb_s&&this._cb_s(t),this.destroy()},o.prototype.generate_expire=function(){this._expire_dis=new t.DelayDispatcher,this._expire_dis.dispatch(2e4,this,this.handle_req_expired)},o.prototype.handle_req_expired=function(){this._handle_fail("expire")},o.prototype.clear_expire=function(){this._expire_dis&&(this._expire_dis.destroy(),this._expire_dis=null)},o.prototype._combine_url=function(e){var i=t.sirius_network_consts.protocol+"://"+t.sirius_network_consts.host_address+"/"+e;return i},o.prototype.get=function(t,e){return void 0===e&&(e=void 0),__awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(i){return t?(this._url_str=this._combine_url(t),[2,new Promise(function(t,i){e._cb_s=t,e._cb_f=i,e._send_get(e._url_str)})]):[2,new Promise(function(t,e){e("url_error")})]})})},o.prototype.post_fullurl=function(t,e){return void 0===e&&(e=void 0),__awaiter(this,void 0,void 0,function(){var i,o=this;return __generator(this,function(r){return t?(i=JSON.stringify(e),this._url_str=t,[2,new Promise(function(t,e){o._cb_s=t,o._cb_f=e,o._send_post(o._url_str,i)})]):[2,new Promise(function(t,e){e("url_error")})]})})},o.prototype.post=function(t,e){return void 0===e&&(e=void 0),__awaiter(this,void 0,void 0,function(){var i,o=this;return __generator(this,function(r){return t?(i=JSON.stringify(e),this._url_str=this._combine_url(t),[2,new Promise(function(t,e){o._cb_s=t,o._cb_f=e,o._send_post(o._url_str,i)})]):[2,new Promise(function(t,e){e("url_error")})]})})},o.prototype._send_get=function(t){this.generate_expire();var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,this.comp,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.fail,this)},o.prototype._send_post=function(t,e){this.generate_expire();var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(t,egret.HttpMethod.POST),i.setRequestHeader("Content-Type","application/json"),e?i.send(e):i.send(),i.addEventListener(egret.Event.COMPLETE,this.comp,this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,this.fail,this)},o.prototype.comp=function(t){this.clear_expire();var e=(this._url_str,t.currentTarget),i=e.response;if(this._req_param.should_parse_json){var o=JSON.parse(i);this._handle_success(o)}else this._handle_success(i)},o.prototype.fail=function(t){this.clear_expire();var e=t.currentTarget,i=e.response;this._handle_fail(i)},o}(t.sirius_base_object);t.common_req=i,__reflect(i.prototype,"ns_sirius.common_req")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.mark_as_fullfill(),e.set_bg_color(0,.4),e._icon=new eui.Image,e.addChild(e._icon),e._icon.horizontalCenter=0,e._icon.verticalCenter=0,e._icon.width=100,e._icon.height=100,e._icon.source="loading_icon_png",e._icon.rotation,e}return __extends(e,t),e.prototype.start_anim=function(){egret.Tween.get(this._icon,{loop:!0}).to({rotation:360},5e3)},e.prototype.stop_anim=function(){egret.Tween.removeTweens(this._icon)},e}(t.sirius_view_base);t.sirius_default_loading_view=e,__reflect(e.prototype,"ns_sirius.sirius_default_loading_view")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this,i=e.set_bg_color(0,.4);return i.ellipseWidth=40,i.ellipseHeight=40,e.left=20,e.right=20,e.height=40,e.verticalCenter=100,e._txt=new eui.Label,e.addChild(e._txt),e._txt.textColor=16777215,e._txt.left=10,e._txt.right=10,e._txt.size=26,e._txt.percentHeight=100,e._txt.textAlign=egret.HorizontalAlign.CENTER,e._txt.verticalAlign=egret.VerticalAlign.MIDDLE,e}return __extends(e,t),e.prototype.show=function(t){this._txt.text=t,egret.Tween.get(this).to({verticalCenter:0},2e3,egret.Ease.cubicOut).to({alpha:0},1e3,egret.Ease.cubicOut)},e}(t.sirius_view_base);t.popup_text_msg=e,__reflect(e.prototype,"ns_sirius.popup_text_msg")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.view_hierarchy_establish=function(e){this._sirius.layes.view_hierarchy_establish(e),this._module_sm=this._sirius.layes.sms[0],this._alert_sm=this._sirius.layes.sms[1],this._fs_cover_sm=this._sirius.layes.sms[2],this._message_sm=this._sirius.layes.sms[3],this._loading_sm=this._sirius.layes.sms[4],this._global_loading_view=new t.sirius_default_loading_view,this._loading_sm.attach_target_view(this._global_loading_view),this._sirius.mm.register_sm(this._module_sm)},i.prototype.switch_global_loading=function(t){t?(this._global_loading_view.start_anim(),this._loading_sm.show()):(this._global_loading_view.stop_anim(),this._loading_sm.hide())},i.prototype.show_popup_text_msg=function(e){var i=this,o=new t.popup_text_msg;this._message_sm.show_view(o),o.show(e),setTimeout(function(){i._message_sm.shift_first()},3500)},i.prototype.show_module=function(t,e,i,o){void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=null),this._sirius.mm.show_module(t,e,i,o)},i.prototype.show_sub_module=function(t,e,i,o,r){void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=null),this._sirius.mm.show_sub_module(t,e,i,o,r)},i.prototype.show_sub_module_init=function(t,e,i,o,r,n){void 0===o&&(o=null),void 0===r&&(r=null),void 0===n&&(n=null),this._sirius.mm.show_sub_module_init(t,e,i,o,r,n)},i.prototype.pop_top_module=function(){this._module_sm.pop_top()},i.prototype.show_alert=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this._alert_sm.show_view(t,e,i)},i.prototype.clear_alert=function(){this._alert_sm.clear_all()},i}(t.sirius_element_module);t.app_vh_manager=e,__reflect(e.prototype,"ns_sirius.app_vh_manager")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){t.app_layer_def=[{lid:"modules",index:0,exclusive:!1,sm_type:1},{lid:"alert_panel",index:1,exclusive:!1,sm_type:0},{lid:"fullscreen_cover",index:2,exclusive:!1,sm_type:0},{lid:"messages",index:3,exclusive:!1,sm_type:0,disable_touch:!0},{lid:"loading",index:4,exclusive:!0}]}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(t){void 0===t&&(t=0),this._node_type=0,this._node_type=t}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},set:function(t){this._element=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pre",{get:function(){return this._pre},set:function(t){this._pre=t},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){1==this._node_type||2==this._node_type,this._element=null,this._next=null,this._pre=null
},t.prototype.is_head=function(){return 1==this._node_type},t.prototype.is_tail=function(){return 2==this._node_type},t}();t.dll_node=e,__reflect(e.prototype,"ns_sirius.dll_node");var i=function(){function t(t){void 0===t&&(t=0),this.list_id=0,this.list_id=t,this._tail=new e(2),this._tail.next=null,this._tail.element=null,this._head=new e(1),this._head.pre=null,this._head.element=null,this._tail.pre=this._head,this._head.next=this._tail,this._length=0}return Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){for(var t=this._head,e=null;t&&!t.is_tail();)e=t.next,t.destroy(),t=e;this._head=null,this._tail=null,this._length=0},t.prototype.is_empty=function(){return this._head.next==this._tail},t.prototype.push=function(t){var i=new e;i.element=t,i.next=this._tail,i.pre=this._tail.pre,this._tail.pre.next=i,this._tail.pre=i,this._length++},t.prototype.pop=function(){if(!this.is_empty()){this._length--;var t=this._tail.pre,e=t.element;return t.pre.next=this._tail,this._tail.pre=t.pre,t.destroy(),t=null,e}},t.prototype.remove=function(t){if(!this.is_empty()){var e=this.find(t);if(e){this._length--;var i=e.pre,o=e.next;i.next=o,o.pre=i,e.destroy(),e=null}}},t.prototype.find=function(t){if(!t)return null;for(var e=this._head.next;e&&!e.is_tail();){if(e.element==t)return e;e=e.next}return null},t.prototype.find_element_by_property=function(t,e){if(!t)return null;for(var i=this._head.next;i&&!i.is_tail();){if(i.element[t]===e)return i.element;i=i.next}return null},t.prototype.get_head=function(){return this._head},t.prototype.get_tail=function(){return this._tail},t.prototype.loop_complex=function(t){for(var e=this.get_head().next;e&&!e.is_tail();){var i=t(e);if(i)break;e=e.next}},t.prototype.loop=function(t){for(var e=this.get_head().next;e&&!e.is_tail();)t(e),e=e.next},t.prototype.remove_element_by_property=function(t,e){if(!t)return null;for(var i=this._head.next;i&&!i.is_tail();)if(i.element[t]===e){var o=i;o.pre.next=i.next,o.next.pre=i.pre,i=o.next,o.destroy(),o=null}else i=i.next;return null},t}();t.doubly_linked_list=i,__reflect(i.prototype,"ns_sirius.doubly_linked_list")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.ddid=0,e}return __extends(e,t),e.prototype._before_destroy=function(){this._target=null,this._fun=null,this._param=null},e.prototype.dispatch=function(t,e,i,o){var r=this;void 0===o&&(o=null),this._is_destroyed=!1,this._delay_time=t,this._target=e,this._fun=i,this._param=o,setTimeout(function(){r.execute_fun()},t)},e.prototype.execute_fun=function(){this._is_destroyed||this._target&&this._fun&&(this._fun.apply(this._target,this._param),this.destroy())},e}(t.sirius_base_object);t.DelayDispatcher=e,__reflect(e.prototype,"ns_sirius.DelayDispatcher")}(ns_sirius||(ns_sirius={}));var ns_sirius_math;!function(t){function e(t,e,i,o){var r=t-i,n=e-o;return Math.sqrt(r*r+n*n)}t.points_distance=e}(ns_sirius_math||(ns_sirius_math={}));var ns_sirius;!function(t){var e=function(){function t(t){this._stack=new Array(t),this._size=t,this._cursor=0}return t.prototype.pool_init=function(t){for(var e=0;e<this._size;e++)this._stack[e]=new t},t.prototype.borrow=function(){var t=this._stack[this._cursor];return this._cursor++,this._cursor==this._size&&(this._cursor=0),t},t.prototype.get_stack=function(){return this._stack},t.prototype.destroy=function(){this._stack=null},t}();t.rotational_deprived_fixed_pool=e,__reflect(e.prototype,"ns_sirius.rotational_deprived_fixed_pool")}(ns_sirius||(ns_sirius={}));