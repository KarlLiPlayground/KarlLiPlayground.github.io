var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(n,o){function _(t){try{a(r.next(t))}catch(e){o(e)}}function s(t){try{a(r["throw"](t))}catch(e){o(e)}}function a(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(_,s)}a((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return r([t,e])}}function r(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(_=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(_=_.call(o,i[1])).done)return _;switch(o=0,_&&(i=[0,_.value]),i[0]){case 0:case 1:_=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(_=a.trys,!(_=_.length>0&&_[_.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!_||i[1]>_[0]&&i[1]<_[3])){a.label=i[1];break}if(6===i[0]&&a.label<_[1]){a.label=_[1],_=i;break}if(_&&a.label<_[2]){a.label=_[2],a.ops.push(i);break}_[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(r){i=[6,r],o=0}finally{n=_=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,o,_,s,a={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},ns_sirius;!function(t){var e=function(){function t(){this._is_destroyed=!1}return Object.defineProperty(t.prototype,"is_destroyed",{get:function(){return this._is_destroyed},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},t.prototype._before_destroy=function(){},t}();t.sirius_base_object=e,__reflect(e.prototype,"ns_sirius.sirius_base_object",["ns_sirius.Isirius_base_object"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._layer_index=0,console.log("[ "+e.constructor.name+" ] ALLOC"),e.pair_view=null,e.init_param=null,e}return __extends(e,t),e.prototype.register_layer_index=function(t){this._layer_index=t},Object.defineProperty(e.prototype,"mkey",{get:function(){return this._mkey},enumerable:!0,configurable:!0}),e.prototype.register_module_key=function(t){this._mkey=t},e.prototype.local_view=function(){var t=this.pair_view;return t},e.prototype._before_destroy=function(){console.log("[ "+this.constructor.name+" ] destroy"),this._vm_before_destroy(),this.init_param=null,this.pair_view=null},e.prototype.vm_pre_init=function(t,e,i){this.init_param=t,this.pair_view=e,this._sirius=i.sirius_public,this._vm_before_init()},e.prototype.vm_init=function(){this._vm_start_init()},e.prototype.module_exit=function(){this._is_destroyed||(sirius.view_manager.remove_module(this,this._layer_index),this.destroy())},e.prototype._vm_before_init=function(){},e.prototype._vm_start_init=function(){},e.prototype._vm_before_destroy=function(){},e}(t.sirius_base_object);t.module_vm_base=e,__reflect(e.prototype,"ns_sirius.module_vm_base")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e.mark_as_fullfill(),console.log("[ "+e.constructor.name+" ] ALLOC"),e}return __extends(e,t),e.prototype.local_vm=function(){var t=this.pair_vm;return t},e.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},e.prototype._remove_self_from_nfc=function(){sirius.nfc.remove_target(this)},e.prototype._before_destroy=function(){console.log("[ "+this.constructor.name+" ] destroy"),this._view_before_destroy(),this.remove_all_children(),this.remove_from_parent(),this.init_param=null,this.pair_vm=null},e.prototype.view_pre_init=function(t,e,i){this.init_param=t,this.pair_vm=e,this._sirius=i.sirius_public,this._view_before_init()},e.prototype.view_init=function(){this._view_start_init()},e.prototype.module_exit=function(){this.pair_vm&&this.pair_vm.module_exit()},e.prototype.attached_to_display_tree=function(t){},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e.prototype.remove_all_children=function(){this.removeChildren()},e.prototype.remove_from_parent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.update_visible=function(t){this.visible=t},e.prototype.mark_as_fullfill=function(){this.percentWidth=100,this.percentHeight=100,this.x=0,this.y=0},e.prototype.set_bg_color=function(t,e){void 0===e&&(e=1);var i=new eui.Rect;return this.addChildAt(i,0),i.fillColor=t,i.percentWidth=100,i.percentHeight=100,i.alpha=e,i},e}(eui.Component);t.sirius_module_view=e,__reflect(e.prototype,"ns_sirius.sirius_module_view",["ns_sirius.Isirius_view_base","ns_sirius.Isirius_base_object"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e}return __extends(e,t),e.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},e.prototype._before_destroy=function(){this._view_before_destroy(),this.remove_all_children(),this.remove_from_parent()},e.prototype.attached_to_display_tree=function(t){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e.prototype.remove_all_children=function(){this.removeChildren()},e.prototype.remove_from_parent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.update_visible=function(t){this.visible=t},e.prototype.mark_as_fullfill=function(){this.percentWidth=100,this.percentHeight=100,this.x=0,this.y=0},e.prototype.set_bg_color=function(t,e){void 0===e&&(e=1);var i=new eui.Rect;return this.addChildAt(i,0),i.fillColor=t,i.percentWidth=100,i.percentHeight=100,i.alpha=e,i},e}(eui.Group);t.sirius_view_base=e,__reflect(e.prototype,"ns_sirius.sirius_view_base",["ns_sirius.Isirius_view_base","ns_sirius.Isirius_base_object"]);var i=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e}return __extends(e,t),e.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},e.prototype._before_destroy=function(){this._view_before_destroy(),this.remove_all_children(),this.remove_from_parent()},e.prototype.attached_to_display_tree=function(t){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e.prototype.remove_all_children=function(){this.removeChildren()},e.prototype.remove_from_parent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.update_visible=function(t){this.visible=t},e.prototype.mark_as_fullfill=function(){},e.prototype.set_bg_color=function(t,e){return void 0===e&&(e=1),null},e}(egret.DisplayObjectContainer);t.sirius_game_view_base=i,__reflect(i.prototype,"ns_sirius.sirius_game_view_base",["ns_sirius.Isirius_view_base","ns_sirius.Isirius_base_object"])}(ns_sirius||(ns_sirius={}));var ActorEntity=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._status_init=function(t){this.s=this._create_status(),this.s.sinit(t)},e.prototype.actor_init=function(t,e){this.param=e,this._status_init(t),this.view=this._create_view(),this.view.bind_ee(this),this.view.visible=!1},e.prototype.destroy=function(){this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.s&&this.s.destroy(),this.s=null,t.prototype.destroy.call(this)},e.prototype._syn_pos=function(){this._is_destroyed||this.view.syn_pos(this.s.pos)},e}(ns_sirius.sirius_base_object);__reflect(ActorEntity.prototype,"ActorEntity");var ActorEntityStatus=function(t){function e(){var e=t.call(this)||this;return e.immortal=!1,e}return __extends(e,t),e.prototype.sinit=function(t){this.size=new ns_sirius.Size(t.width,t.height),this.half_size=new ns_sirius.Size(.5*t.width,.5*t.height),this.rec=new egret.Rectangle,this.rec.width=this.size.width,this.rec.height=this.size.height,this.pos=new egret.Point,this.reset_static_values(),this.reset_dynamic_values()},e.prototype.cal_rect=function(){this.rec.x=this.pos.x-this.half_size.width,this.rec.y=this.pos.y-this.half_size.height},e}(ns_sirius.sirius_base_object);__reflect(ActorEntityStatus.prototype,"ActorEntityStatus");var ActorDisplay=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.syn_all_status=function(t){this.syn_pos(t.pos),this.syn_health(t.health)},e.prototype.syn_pos=function(t){this.x=t.x,this.y=t.y},e.prototype.syn_health=function(t){},e}(ns_sirius.sirius_view_base);__reflect(ActorDisplay.prototype,"ActorDisplay");var AppModuleViewBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.attached_to_display_tree=function(t){},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e}(ns_sirius.sirius_module_view);__reflect(AppModuleViewBase.prototype,"AppModuleViewBase");var AppModuleVMBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._vm_before_init=function(){},e.prototype._vm_start_init=function(){},e.prototype._vm_before_destroy=function(){},e}(ns_sirius.module_vm_base);__reflect(AppModuleVMBase.prototype,"AppModuleVMBase");var ns_sirius;!function(t){var e=function(){function t(){}return t.prototype.cal_magnitude=function(){this.gravity_magnitude=Math.sqrt(this.gravity_vector.x*this.gravity_vector.x+this.gravity_vector.y*this.gravity_vector.y),this.speed_magnitude=Math.sqrt(this.speed_vector.x*this.speed_vector.x+this.speed_vector.y*this.speed_vector.y)},t}();t.anim_gravity_param=e,__reflect(e.prototype,"ns_sirius.anim_gravity_param");var i=function(e){function i(t,i,r){void 0===t&&(t=null),void 0===i&&(i=null),void 0===r&&(r=0);var n=e.call(this)||this;return n._is_destroyed=!1,n._cur_pos=new egret.Point,n._listener=t,n.anim_id=r,n._target_view=i,n._after_init(),n}return __extends(i,e),i.prototype._before_destroy=function(){this._is_destroyed=!0,this.stop(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._param=null,this._target_view=null},i.prototype._after_init=function(){},i.prototype.init=function(t){return void 0===t&&(t=null),this.anim_active(t),this},i.prototype.anim_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.anim_deactive=function(){this._clock&&this._clock.remove(this)},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!0,configurable:!0}),i.prototype.start=function(t){this._param=t,this._param.cal_magnitude(),this._real_time=0,this._is_animating=!0,this._cur_pos.copyFrom(this._param.start_position),this._reset_anim_properties()},i.prototype.stop=function(){this._is_animating=!1,this._real_time=0,this._listener&&this._listener.anim_gravity_comp(this),this._reset_anim_properties()},i.prototype._before_update=function(t){},i.prototype._update_position=function(t){var e=this._real_time/1e3;this._cur_pos.y=this._param.start_position.y+this._param.speed_vector.y*e+.5*this._param.gravity_magnitude*e*e},i.prototype.update=function(t){this._is_animating&&(this._before_update(t),this._update_position(t),this._anim_update(t),this._real_time+=t)},i.prototype._syn_view_pos=function(){this._target_view.y=this._cur_pos.y,this._target_view.x=this._cur_pos.x},i.prototype.util_linear_interpolation=function(t,e,i){return t+(e-t)*i},i}(t.sirius_base_object);t.anim_gravity=i,__reflect(i.prototype,"ns_sirius.anim_gravity",["ns_sirius.IAnimatable"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(e){function i(t,i,r,n){void 0===t&&(t=null),void 0===i&&(i=null),void 0===r&&(r=0),void 0===n&&(n=null);var o=e.call(this)||this;return o._is_destroyed=!1,o._listener=t,o.anim_id=r,o._param=n,o._target_view=i,o}return __extends(i,e),i.prototype.get_param=function(){return this._param},i.prototype.init=function(t){return void 0===t&&(t=null),this.anim_active(t),this},i.prototype.anim_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.anim_deactive=function(){this._clock&&this._clock.remove(this)},i.prototype._before_destroy=function(){this._is_destroyed=!0,this.stop(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._param=null,this._target_view=null},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!0,configurable:!0}),i.prototype.is_disposable=function(){return!1},Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!0,configurable:!0}),i.prototype.start=function(){this._normalized_time=0,this._real_time=0,this._anim_duration=this.animation_duration(),this._is_animating=!0,this._reset_anim_properties()},i.prototype.stop=function(){this._is_animating=!1,this._normalized_time=0,this._real_time=0,this._reset_anim_properties()},i.prototype.update=function(t){this._is_animating&&(this._real_time+=t,this._normalized_time=this._real_time/this._anim_duration,this._normalized_time>1?this._anim_update(1):this._anim_update(this._normalized_time),this._normalized_time<1||(this.stop(),this._listener&&this._listener.single_anim_comp(this),this.is_disposable()&&this.destroy()))},i.prototype.util_linear_interpolation=function(t,e,i){return t+(e-t)*i},i}(t.sirius_base_object);t.single_animation=e,__reflect(e.prototype,"ns_sirius.single_animation",["ns_sirius.IAnimatable"])}(ns_sirius||(ns_sirius={}));var EnemyCar=function(t){function e(){var e=t.call(this)||this;return e._column_index=-1,e}return __extends(e,t),Object.defineProperty(e.prototype,"column_index",{get:function(){return this._column_index},enumerable:!0,configurable:!0}),e.prototype._create_status=function(){return new EnemyEntityStatus},e.prototype._create_view=function(){return gp_core.playground.create_enemy_STATIC()},e.prototype.frame_update=function(){ns_sirius.pool_data(this).is_free||(this.s.pos.y>this.s.half_size.height&&(this.s.immortal=!1),this._update_position(),this._update_position_info(),this.s.pos.y>game_config.dead_line_bottom&&this._giveback_entity(),this._syn_pos())},e.prototype._update_position=function(){var t=gp_core.inter_status.world_speed+this.s.move_speed_offset;this.s.pos.y+=t},e.prototype._update_position_info=function(){this.s.cal_rect()},e.prototype.receive_dmg=function(t){this.s.immortal||(this.s.health-=t,this.view.syn_health(this.s.health),this.view.start_vibration_anim(),this.s.health<=0&&this.prepare_to_die())},e.prototype.prepare_to_die=function(){game_view.core.layer_car_explo.display_explosion(this.s.pos),game_view.core.coin_layer.display_effect(this.s.pos),this.s.health=0,this._giveback_entity()},e.prototype._pos_x=function(){this._column_index<0&&console.error("_column_index < 0");var t=game_config.column_middle_pos[this._column_index];return t},e.prototype._regenerate_pos=function(t){this.s.pos.x=this._pos_x();var e=game_param.numerical.born.enemy_born_y_dispersion;if(e>0){var i=Math.round(ns_sirius.random_region(-e,e));this.s.pos.y+=i}},e.prototype.reborn_from_column=function(t){this._column_index=t,this.s.reset_dynamic_values(),this._regenerate_pos(t),this.view.visible=!0,this.view.syn_all_status(this.s)},e.prototype.pool_status_goto_idle=function(){this.view.visible=!1},e.prototype.pool_status_goto_busy=function(){},e.prototype._giveback_entity=function(){gp_core.factory.enemy.giveback(this)},e}(ActorEntity);__reflect(EnemyCar.prototype,"EnemyCar",["ns_sirius.Ipool_obj","ns_sirius.Isirius_base_object"]);var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._machine=null,e}return __extends(e,t),e.prototype._before_destroy=function(){this._machine=null},e.prototype.state_init=function(t,e){this._machine=t,this._convert_context(e),this._behaviors_init(),this._after_state_init()},e.prototype._convert_context=function(t){},e.prototype._behaviors_init=function(){},e.prototype._after_state_init=function(){},e.prototype.state_enum=function(){return 0},e.prototype.state_str=function(){return""},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e.prototype.state_update=function(){},e}(t.sirius_base_object);t.GP_StateBase=e,__reflect(e.prototype,"ns_sirius.GP_StateBase")}(ns_sirius||(ns_sirius={}));var EnemyEntityStatus=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.reset_static_values=function(){this.sprite=Math.random()>.5?"car_red_02_png":"car_blue_02_png",this.move_speed_offset=rand_region.rand_in_game(game_param.numerical.speed.enemy_1_speed_offset_base,game_param.numerical.speed.enemy_1_speed_offset_dispersion,game_param.numerical.speed.enemy_1_speed_offset_progress_coe)},e.prototype.reset_dynamic_values=function(){this.immortal=!0,this._reset_health(),this.pos.y=game_config.enemy_born_y},e.prototype._reset_health=function(){var t=rand_region.rand_in_game(game_param.numerical.probability.enemy_1_born,0,game_param.numerical.probability.enemy_1_born_progress_coe),e=0;e=ns_probability.dice(t)?rand_region.rand_in_game(game_param.numerical.health.enemy_1_base,game_param.numerical.health.enemy_1_dispersion,game_param.numerical.health.enemy_1_progress_coe):rand_region.rand_in_game(game_param.numerical.health.enemy_2_base,game_param.numerical.health.enemy_2_dispersion,game_param.numerical.health.enemy_2_progress_coe),this.health_total=this.health=e},e}(ActorEntityStatus);__reflect(EnemyEntityStatus.prototype,"EnemyEntityStatus");var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._mstack=new Array,e._top=-1,e}return __extends(e,t),e.prototype.manager_init=function(t,e,i){this._root_view=t,this.layer_id=e,this._sirius=i},e.prototype.get_root_view=function(){return this._root_view},e.prototype._s_is_empty=function(){return this._top<0?!0:!1},e.prototype._s_push=function(t){this._top<0&&(this._top=-1),this._top++,this._mstack[this._top]=t},e.prototype._s_pop=function(){this._s_is_empty()||(this._mstack[this._top]=null,this._top--)},e.prototype._s_shift=function(){if(!this._s_is_empty()){for(var t=0;t<this._top;t++)this._mstack[t]=this._mstack[t+1];this._mstack[this._top]=null,this._top--}},e.prototype._s_remove=function(t){if(!(this._s_is_empty()||0>t)){for(var e=t;e<this._top;e++)this._mstack[e]=this._mstack[e+1];this._mstack[this._top]=null,this._top--}},e.prototype._s_clear=function(){if(!this._s_is_empty()){for(var t=0;t<=this._top;t++)this._mstack[t]=null;this._top=-1}},e.prototype._s_top=function(){return this._s_is_empty()?null:this._mstack[this._top]},e.prototype._s_bottom=function(){return this._s_is_empty()?null:this._mstack[0]},e.prototype._update_container_visible=function(){this._s_is_empty()?this._root_view.update_visible(!1):this._root_view.update_visible(!0)},e}(t.sirius_base_object);t.layer_stack_manager=e,__reflect(e.prototype,"ns_sirius.layer_stack_manager",["ns_sirius.Isirius_layer_manager"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){function e(){var t=egret.TextField.prototype.$getLinesArr2;egret.TextField.prototype.$getLinesArr2=function(){return this.$TextField[19]=!0,t.call(this)}}t.egret_enhance=e}(ns_sirius||(ns_sirius={}));var FactoryUpdaterBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.pool_arr=function(){return this._entity_pool.get_array()},e.prototype.updater_init=function(){this._pool_init()},e.prototype.frame_update=function(t){this._entity_pool.enumerate_all_busy(function(t){t.frame_update()})},e.prototype.giveback=function(t){this._entity_pool.giveback(t)},e.prototype.pool_reset=function(){this._entity_pool.pool_reset()},e}(ns_sirius.sirius_base_object);__reflect(FactoryUpdaterBase.prototype,"FactoryUpdaterBase");var CarDisplay=function(t){function e(){var e=t.call(this)||this,i=[1,0,0,0,0,0,.4,0,0,0,0,0,.4,0,0,0,0,0,1,0];return e._vibration_filter=new egret.ColorMatrixFilter(i),e}return __extends(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._vibration_anim&&(this._vibration_anim.destroy(),this._vibration_anim=null)},e.prototype._create_bg_display=function(t,e){var i=new eui.Rect;this.addChild(i),i.fillColor=16777215*Math.random(),i.width=t,i.height=e,i.x=-Math.round(.5*t),i.y=-Math.round(.5*e),this.bgrect=i},e.prototype._create_sprite=function(t){var e=new eui.Image(t.s.sprite);this.addChild(e),e.width=t.s.size.width,e.height=t.s.size.height,e.x=-Math.round(.5*t.s.size.width),e.y=-Math.round(.5*t.s.size.height),this.sprite=e},e.prototype.bind_ee=function(t){var e=t.s.size.width,i=t.s.size.height;this._create_sprite(t),this.lbl_con=new egret.DisplayObjectContainer,this.addChild(this.lbl_con),this.lbl_con.x=0,this.lbl_con.y=0,this.lbl=new eui.Label,this.lbl_con.addChild(this.lbl),this.lbl.width=e,this.lbl.height=i,this.lbl.x=-Math.round(.5*e),this.lbl.y=-Math.round(.5*i),this.lbl.textAlign="center",this.lbl.verticalAlign="middle",this.lbl.text=t.s.health+"",this._vibration_anim=new GCCV_vibration(this,this.lbl_con,1).init()},e.prototype.frame_update=function(){},e.prototype.syn_health=function(t){this.lbl.text=t+""},e.prototype.start_vibration_anim=function(){this._vibration_anim.start()},e.prototype.single_anim_comp=function(t){},e}(ActorDisplay);__reflect(CarDisplay.prototype,"CarDisplay",["ns_sirius.Isirius_base_object"]);var TestModuleVM=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._vm_before_init=function(){},e.prototype._vm_start_init=function(){},e.prototype._vm_before_destroy=function(){},e}(AppModuleVMBase);__reflect(TestModuleVM.prototype,"TestModuleVM");var ns_sirius;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.core_init=function(t){this._sirius=t},e}(t.sirius_base_object);t.sirius_element_module=e,__reflect(e.prototype,"ns_sirius.sirius_element_module")}(ns_sirius||(ns_sirius={}));var TestModuleView=function(t){function e(){var e=t.call(this)||this;return e.textField=new egret.TextField,e.addChild(e.textField),e.textField.size=32,e.textField.textAlign="left",e.textField.verticalAlign="top",e.textField.x=50,e.textField.y=100,e.textField.width=400,e.textField.textColor=16777215,e.textField.text="confirm",e.textField.background=!0,e.textField.backgroundColor=23223,e.titleField=new egret.TextField,e.addChild(e.titleField),e.titleField.size=22,e.titleField.textAlign="center",e.titleField.verticalAlign="top",e.titleField.x=50,e.titleField.width=400,e.titleField.y=300,e.titleField.height=80,e.titleField.textColor=16777215,e.titleField.text="这是测试模块1",setTimeout(function(){e._is_destroyed||e._sirius.debug_foo()},1e3),e}return __extends(e,t),e.prototype.attached_to_display_tree=function(t){},e.prototype._view_before_init=function(){},e.prototype._view_start_init=function(){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e}(AppModuleViewBase);__reflect(TestModuleView.prototype,"TestModuleView");var rand_region;!function(t){function e(t,e){var i=Math.round(ns_sirius.random_region(-e,e)),r=t+i;return r}function i(t,i){return Math.round(e(t,i))}function r(t,e,i){var r=Math.round(ns_sirius.random_region(-e,e)),n=Math.round(i*gp_core.stage_len_cal.percent/100),o=t+r+n;return o}function n(t,e,i){return Math.round(r(t,e,i))}function o(t,e,i,r){var n=Math.round(ns_sirius.random_region(-e,e)),o=Math.round(i*r),_=t+n+o;return _}function _(t,e,i,r){return Math.round(o(t,e,i,r))}t.rand=e,t.rand_round=i,t.rand_in_game=r,t.rand_in_game_round=n,t.rand_pre=o,t.rand_pre_round=_}(rand_region||(rand_region={}));var game_config;!function(t){function e(e){t.initial_screen_h=e,t.playground_w=t.stage_design_w-2*t.gap_horizontal,t.playground_h=Math.ceil(e)-2*t.gap_vertical,t.column_width=Math.floor(t.playground_w/t.column_count),t.enemy_w=Math.round(.8*t.column_width),t.enemy_h=Math.round(194*t.enemy_w/122),t.enemy_hw=Math.round(.5*t.enemy_w),t.enemy_hh=Math.round(.5*t.enemy_h),t.block_w=t.enemy_w,t.block_h=t.enemy_w,t.player_w=t.enemy_w,t.player_h=Math.round(1001*t.enemy_w/474*.75),t.player_hw=Math.round(.5*t.player_w),t.player_hh=Math.round(.5*t.player_h)}function i(){t.min_x=t.player_hw,t.max_x=t.playground_w-t.player_hw}function r(){t.column_middle_pos=new Array(t.column_count);for(var e=0;e<t.column_count;e++){var i=e*t.column_width+.5*t.column_width;t.column_middle_pos[e]=i}t.enemy_born_y=-150,t.player_default_y=t.playground_h-Math.floor(1400/6),t.dead_line_top=-t.enemy_h,t.dead_line_bottom=t.playground_h+t.enemy_h,t.dead_line_left=-t.gap_horizontal-t.enemy_w,t.dead_line_right=t.playground_w+t.gap_horizontal+t.enemy_w,t.block_tip_pos_y=150,t.block_tip_disappear_y=t.block_tip_pos_y-t.enemy_hh-10}function n(t){e(t),i(),r()}t.stage_design_w=640,t.stage_design_h=1136,t.gap_horizontal=10,t.gap_vertical=0,t.column_count=5,t.column_max_index=4,t.coin_radius=45,t.initial_screen_h=0,t.screen_w=0,t.screen_h=0,t.playground_w=0,t.playground_h=0,t.column_width=0,t.enemy_w=0,t.enemy_h=0,t.enemy_hw=0,t.enemy_hh=0,t.block_w=0,t.block_h=0,t.player_w=0,t.player_h=0,t.player_hw=0,t.player_hh=0,t.min_x=0,t.max_x=0,t.enemy_born_y=0,t.player_default_y=0,t.dead_line_top=0,t.dead_line_bottom=0,t.dead_line_left=0,t.dead_line_right=0,t.block_tip_pos_y=0,t.block_tip_disappear_y=0,t.config_init=n}(game_config||(game_config={}));var GameInterStatus=function(t){function e(){var e=t.call(this)||this;return e.world_speed=game_param.numerical.speed.world_move_speed,e}return __extends(e,t),e.prototype.retrieve_coin_count=function(){return this.coin_needs_update=!1,this._coin_count},e.prototype.frame_update=function(){var t=game_param.numerical.speed.world_move_speed_progress_coe*gp_core.stage_len_cal.percent/100,e=game_param.numerical.speed.world_move_speed+t;this.world_speed=e},e.prototype.reset_before_game=function(){this.coin_needs_update=!0,this._coin_count=0,this.world_speed=game_param.numerical.speed.world_move_speed},e.prototype.coin_increase=function(t){this._coin_count+=t,this.coin_needs_update=!0},e}(ns_sirius.sirius_base_object);__reflect(GameInterStatus.prototype,"GameInterStatus");var GamePlayCore=function(t){function e(){var e=t.call(this)||this;return e._frame_cursor=0,game_param.establish_params(),e}return __extends(e,t),e.prototype.core_init=function(t,e){this.playground=game_view.core.playground,this.view=t,this.stage_len_cal=new StageLengthCal,this.inter_status=new GameInterStatus,this.scene_info=new SceneInfo,this.ih=new InputHandler,this.ih.session_start(e),this.player=new PlayerEntity,this.player.actor_init(new ns_sirius.Size(game_config.player_w,game_config.player_h),null),this.factory=new EntityFactory,this.factory.core_init(),this.game_event=new GameEventHandler,egret.Ticker.getInstance().register(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3),ns_sirius.world_clock.update(t)},this),ns_sirius.world_clock.add(this),this.game_pause()},e.prototype.game_start=function(){this._frame_cursor=0,this.stage_len_cal.start_game(),this.inter_status.reset_before_game(),this.game_event.reset_mark(),this.scene_info.reset_lane_info(),this.game_resume()},e.prototype.game_pause=function(){ns_sirius.world_clock.time_scale=0},e.prototype.game_resume=function(){ns_sirius.world_clock.time_scale=1},e.prototype.update=function(t){this._frame_cursor++,this.stage_len_cal.frame_update(),this.inter_status.frame_update(),this.game_event.frame_update(),this.factory.frame_update(this._frame_cursor),this.ih.motion_detector.frame_update(),this.player.frame_update(),game_view.frame_update()},e.prototype.game_over=function(){this.game_pause();var t=new eui.Panel;t.title="GameOver",t.horizontalCenter=0,t.verticalCenter=0,root_view.addChild(t),t.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._game_again,this),t.closeButton.label="Retry"},e.prototype._game_again=function(){this.view.coin_layer.reset(),this.view.layer_car_explo.reset(),this.player.s.reset_dynamic_values(),this.player.view.syn_all_status(this.player.s),this.ih.end_touch_session(),this.factory.game_again(),this.game_start()},e}(ns_sirius.sirius_base_object);__reflect(GamePlayCore.prototype,"GamePlayCore",["ns_sirius.IAnimatable"]);var EntityFactory=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.core_init=function(){this.enemy=new Updater_Enemy,this.enemy.updater_init(),this.barrier=new Updater_Evt_Barrier,this.barrier.updater_init(),this.enemy_with_emitter=new Updater_Evt_Enemy_WE,this.enemy_with_emitter.updater_init(),this.enemy_n=new Updater_Evt_Enemy_N,this.enemy_n.updater_init()},e.prototype.frame_update=function(t){this.enemy.local_born_entity(t),this.barrier.local_born_entity(t),this.enemy_with_emitter.local_born_entity(t),this.enemy_n.local_born_entity(t),this.enemy.frame_update(t),this.barrier.frame_update(t),this.enemy_with_emitter.frame_update(t),this.enemy_n.frame_update(t)},e.prototype.game_again=function(){this.enemy.pool_reset(),this.barrier.pool_reset(),this.enemy_with_emitter.pool_reset(),this.enemy_n.pool_reset()},e}(ns_sirius.sirius_base_object);__reflect(EntityFactory.prototype,"EntityFactory");var gp_core,game_view,root_view,sirius,release_config;ns_sirius.egret_enhance();var Main=function(t){function e(){var e=t.call(this)||this;return root_view=e,release_config=new AppReleaseConfig,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return e=i.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var r=new eui.Theme("resource/default.thm.json",t.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=this;this.stage.addEventListener(egret.Event.RESIZE,function(e){game_config.screen_w=t.stage.stageWidth,game_config.screen_h=t.stage.stageHeight},this),game_config.config_init(this.stage.stageHeight);var e=new GameViewWrapper;this.addChild(e),e.percentWidth=100,e.percentHeight=100,e.bottom=0,e.horizontalCenter=0,game_view=e,gp_core=new GamePlayCore,gp_core.core_init(game_view.core,game_view.touch_area),setTimeout(function(){gp_core.game_start()
},100)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.onButtonClick=function(t){},e.prototype.onButtonClick2=function(t){gp_core.game_pause()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var Updater_Enemy=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._sample_1=[[0],[1],[2],[3],[4]],e._sample_2=[[0,1],[0,2],[0,3],[0,4],[1,2],[1,3],[1,4],[2,3],[2,4],[3,4]],e._sample_3=[[0,1,2],[0,2,4],[1,3,4],[0,2,3],[1,2,4],[2,3,4],[0,3,4]],e._sample_4=[[0,1,2,3],[0,1,2,4],[0,1,3,4],[0,2,3,4],[1,2,3,4]],e._sample_5=[[0,1,2,3,4]],e}return __extends(e,t),e.prototype._pool_init=function(){this._entity_pool=new ns_sirius.dynamic_pool(15),this._entity_pool.pool_init(EnemyCar,function(t){t.actor_init(new ns_sirius.Size(game_config.enemy_w,game_config.enemy_h),null)})},e.prototype.local_born_entity=function(t){var e=gp_core.game_event.cur_evt();if(!e||e.status===game_event_status.preparing){var i=(gp_core.stage_len_cal.len,rand_region.rand_in_game_round(game_param.numerical.born.enemy_born_base,0,game_param.numerical.born.enemy_born_progress_coe));1>i&&(i=1),t%i===0&&this._born_enemies()}},e.prototype._born_single_enemy=function(t){if(gp_core.scene_info.query_lane_occupying_free(t)){var e=this._entity_pool.borrow();e&&e.reborn_from_column(t)}},e.prototype._get_sample=function(){var t=rand_region.rand_in_game_round(game_param.numerical.probability.born_min,0,game_param.numerical.probability.born_min_progress_coe),e=rand_region.rand_in_game_round(game_param.numerical.probability.born_max,0,game_param.numerical.probability.born_max_progress_coe),i=ns_sirius.random_region_int(t,e+1,1);return 1===i?this._sample_1:2===i?this._sample_2:3===i?this._sample_3:4===i?this._sample_4:5===i?this._sample_5:(console.error("Updater_Enemy : _get_sample "+i),null)},e.prototype._born_enemies=function(){for(var t=this._get_sample(),e=t.length,i=ns_sirius.random_region_int(0,e,1),r=t[i],n=0;n<r.length;n++)this._born_single_enemy(r[n])},e.prototype.evt_trigger=function(t){},e}(FactoryUpdaterBase);__reflect(Updater_Enemy.prototype,"Updater_Enemy");var Updater_Evt_Barrier=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._local_cursor=-1,e._samples_4=[[0,1,3,4],[0,1,2,3],[1,2,3,4],[0,2,3,4],[0,1,2,4]],e._samples_3=[[0,1,3],[1,2,4],[0,2,3],[2,3,4],[2,3,4]],e._samples_2=[[0,1],[1,2],[2,3],[3,4],[2,4]],e}return __extends(e,t),e.generate_evt_data=function(t,e){for(var i=t.evt_trigger,r=new Array,n=rand_region.rand_in_game_round(game_param.numerical.barrier.barrier_row_distance,0,game_param.numerical.barrier.barrier_row_distance_process_coe),o=Math.floor(ns_sirius.random_region(game_param.numerical.barrier.barrier_row_min,game_param.numerical.barrier.barrier_row_max+1)),_=0;o>_;_++)r.push(i+_*n);t.evt_data=r,t.region_end=r[o-1]+game_param.numerical.event.evt_region_tail_gap},e.prototype._pool_init=function(){this._entity_pool=new ns_sirius.dynamic_pool(10),this._entity_pool.pool_init(BlockEntity,function(t){t.actor_init(new ns_sirius.Size(game_config.block_w,game_config.block_h),null)})},e.prototype.local_born_entity=function(t){this._should_born_barrier()},e.prototype._cur_mark=function(){return this._local_mark?this._local_cursor>this._local_mark.length-1?-1:this._local_mark[this._local_cursor]:-1},e.prototype._trigger_cur_mark=function(){this._local_cursor++},e.prototype._should_born_barrier=function(){var t=this._cur_mark();if(!(0>t)){var e=gp_core.stage_len_cal.len,i=gp_core.inter_status.world_speed;t+i>e&&e>=t-i&&(this._trigger_cur_mark(),this._born_blocks())}},e.prototype._born_single_block=function(t){var e=this._entity_pool.borrow();e&&e.reborn_from_column(t)},e.prototype._cal_player_column_index=function(){var t=gp_core.player.s.pos.x,e=Math.floor(t/game_config.column_width);return 0>e&&(e=0),e>game_config.column_max_index&&(e=game_config.column_max_index),e},e.prototype._get_sample_arr=function(){var t=rand_region.rand_in_game_round(game_param.numerical.barrier.barrier_born_rand_min,0,game_param.numerical.barrier.barrier_born_rand_min_process_coe),e=game_param.numerical.barrier.barrier_born_rand_max,i=Math.floor(ns_sirius.random_region(t,e+1));return 2===i?this._samples_2:3===i?this._samples_3:4===i?this._samples_4:(console.error("Updater_Barrier : _get_sample "+i),null)},e.prototype._born_blocks=function(){var t=this._get_sample_arr();if(t)for(var e=this._cal_player_column_index(),i=t[e],r=0;r<i.length;r++)this._born_single_block(i[r])},e.prototype.evt_trigger=function(t){this._local_cursor=0,this._local_mark=t.evt_data},e}(FactoryUpdaterBase);__reflect(Updater_Evt_Barrier.prototype,"Updater_Evt_Barrier");var Updater_Evt_Enemy_N_Info=function(){function t(){}return t}();__reflect(Updater_Evt_Enemy_N_Info.prototype,"Updater_Evt_Enemy_N_Info");var Updater_Evt_Enemy_N=function(t){function e(){var e=t.call(this)||this;return e._local_cursor=-1,e._sample_1=[[0],[1],[2],[3],[4]],e._sample_2=[[0,1],[1,2],[2,3],[0,4],[3,4]],e._sample_3=[[0,1,2],[0,1,2],[0,2,3],[0,3,4],[1,2,4]],e._sample_4=[[0,1,2,3],[0,1,2,4],[0,2,3,4],[0,1,3,4],[1,2,3,4]],e._sample_5=[[0,1,2,3,4],[0,1,2,3,4],[0,1,2,3,4],[0,1,2,3,4],[0,1,2,3,4]],e._rand_info=new Updater_Evt_Enemy_N_Info,e._local_mark=null,e._local_cursor=0,e}return __extends(e,t),e.generate_evt_data=function(t,e){for(var i=t.evt_trigger,r=new Array,n=rand_region.rand_in_game_round(game_param.numerical.enemy_numerous.row_distance,0,game_param.numerical.enemy_numerous.row_distance_process_coe),o=Math.floor(ns_sirius.random_region(game_param.numerical.enemy_numerous.row_min,game_param.numerical.enemy_numerous.row_max+1)),_=0;o>_;_++)r.push(i+_*n);t.evt_data=r,t.region_end=r[o-1]+game_param.numerical.event.evt_region_tail_gap},e.prototype._pool_init=function(){this._entity_pool=new ns_sirius.dynamic_pool(15),this._entity_pool.pool_init(EnemyCarN,function(t){t.actor_init(new ns_sirius.Size(game_config.enemy_w,game_config.enemy_h),null)})},e.prototype.local_born_entity=function(t){this._should_born_n()},e.prototype._cur_mark=function(){return this._local_mark?this._local_cursor>this._local_mark.length-1?-1:this._local_mark[this._local_cursor]:-1},e.prototype._trigger_cur_mark=function(){this._local_cursor++},e.prototype._should_born_n=function(){var t=this._cur_mark();if(!(0>t)){var e=gp_core.stage_len_cal.len,i=gp_core.inter_status.world_speed;t+i>e&&e>=t-i&&(this._trigger_cur_mark(),this._born_enemies())}},e.prototype._born_single_enemy=function(t,e){var i=this._entity_pool.borrow();i&&(i.health_type=e,i.reborn_from_column(t))},e.prototype._get_sample_arr=function(){var t=game_param.numerical.enemy_numerous.born_random_max,e=game_param.numerical.enemy_numerous.born_random_min,i=Math.floor(ns_sirius.random_region(e,t+1)),r=Math.round(game_param.numerical.enemy_numerous.fixed_count),n=i-r,o=rand_region.rand_in_game(game_param.numerical.enemy_numerous.enemy_2_probability,0,game_param.numerical.enemy_numerous.enemy_2_probability_progresss_coe),_=Math.floor(o*n),s=n-_,a=r+_,l=s;return this._rand_info.e3_start_cursor=ns_sirius.random_region(0,a+1),this._rand_info.e3_end_cursor=this._rand_info.e3_start_cursor+l-1,1===i?this._sample_1:2===i?this._sample_2:3===i?this._sample_3:4===i?this._sample_4:5===i?this._sample_5:(console.error("Updater_Evt_Enemy_N : _get_sample "+i),null)},e.prototype._cal_player_column_index=function(){var t=gp_core.player.s.pos.x,e=Math.floor(t/game_config.column_width);return 0>e&&(e=0),e>game_config.column_max_index&&(e=game_config.column_max_index),e},e.prototype._born_enemies=function(){var t=this._get_sample_arr();if(t)for(var e=this._cal_player_column_index(),i=t[e],r=0;r<i.length;r++){var n=0;r>=this._rand_info.e3_start_cursor&&r<=this._rand_info.e3_end_cursor&&(n=1),this._born_single_enemy(i[r],n)}},e.prototype.evt_trigger=function(t){this._local_cursor=0,this._local_mark=t.evt_data},e}(FactoryUpdaterBase);__reflect(Updater_Evt_Enemy_N.prototype,"Updater_Evt_Enemy_N");var Updater_Evt_Enemy_WE=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._sample_1=[[0],[1],[2],[3],[4]],e._sample_2=[[0,1],[1,3],[2,4],[3,4],[0,4]],e._sample_3=[[0,2,4],[1,3,4],[0,2,3],[1,3,4],[2,3,4]],e._sample_4=[[0,1,2,3],[0,1,2,4],[0,2,3,4],[0,1,3,4],[1,2,3,4]],e}return __extends(e,t),e.generate_evt_data=function(t,e){},e.prototype._pool_init=function(){this._entity_pool=new ns_sirius.dynamic_pool(5),this._entity_pool.pool_init(EnemyCarWithEmitter,function(t){t.actor_init(new ns_sirius.Size(game_config.enemy_w,game_config.enemy_h),null)})},e.prototype.local_born_entity=function(t){},e.prototype._born_single_enemy=function(t){var e=this._entity_pool.borrow();e&&e.reborn_from_column(t)},e.prototype._cal_player_column_index=function(){var t=gp_core.player.s.pos.x,e=Math.floor(t/game_config.column_width);return 0>e&&(e=0),e>game_config.column_max_index&&(e=game_config.column_max_index),e},e.prototype._get_sample_arr=function(){var t=rand_region.rand_in_game_round(game_param.numerical.enemy_with_bullet.born_random_max,0,game_param.numerical.enemy_with_bullet.born_random_max_progress_coe),e=game_param.numerical.enemy_with_bullet.born_random_min,i=Math.floor(ns_sirius.random_region(e,t+1));return 1===i?this._sample_1:2===i?this._sample_2:3===i?this._sample_3:4===i?this._sample_4:(console.error("Updater_Enemy_With_Emitter : _get_sample "+i),null)},e.prototype._born_enemies=function(){var t=this._get_sample_arr();if(t)for(var e=this._cal_player_column_index(),i=t[e],r=0;r<i.length;r++)this._born_single_enemy(i[r])},e.prototype.evt_trigger=function(t){this._born_enemies()},e}(FactoryUpdaterBase);__reflect(Updater_Evt_Enemy_WE.prototype,"Updater_Evt_Enemy_WE");var game_event_type;!function(t){t[t.bullet_enemy=0]="bullet_enemy",t[t.enemy_numerous=1]="enemy_numerous",t[t.barrier=2]="barrier"}(game_event_type||(game_event_type={}));var game_event_status;!function(t){t[t.preparing=0]="preparing",t[t.enter=1]="enter",t[t.triggered=2]="triggered",t[t.past=3]="past"}(game_event_status||(game_event_status={}));var game_event_entity=function(){function t(){}return t.prototype.change_status=function(t,e){return t===this.status?!1:(this.status=t,e(),!0)},t}();__reflect(game_event_entity.prototype,"game_event_entity");var GameEventHandler=function(t){function e(){var e=t.call(this)||this;return e._probability_arr=new Array(4),e._probability_arr[0]=0,e._probability_arr[3]=1,e._probability_arr[1]=game_param.numerical.event.probability_bullet_enemy,e._probability_arr[2]=e._probability_arr[1]+game_param.numerical.event.probability_enemy2,e}return __extends(e,t),e.prototype.reset_mark=function(){var t=game_param.numerical,e=t.length.stage_length;this._events=new Array;for(var i=rand_region.rand_round(t.event.start,t.event.start_dispersion),r=game_param.numerical.event.evt_region_head_gap,n=game_param.numerical.event.evt_region_tail_gap;e>=i;){var o=i/e,_=new game_event_entity;_.index=this._events.length,_.evt_trigger=i,_.region_start=i-r,_.region_end=i+n,_.type=rand.rand_array(this._probability_arr),_.status=game_event_status.preparing,_.evt_data=null,this._generate_evt_data(_,o),this._events.push(_);var s=rand_region.rand_pre_round(t.event.interval,t.event.interval_dispersion,t.event.interval_progress_coe,o);i+=s}this._evt_cursor=0},e.prototype.cur_evt=function(){return this._evt_cursor>this._events.length-1?null:this._events[this._evt_cursor]},e.prototype._generate_evt_data=function(t,e){switch(t.type){case game_event_type.barrier:Updater_Evt_Barrier.generate_evt_data(t,e);break;case game_event_type.bullet_enemy:Updater_Evt_Enemy_WE.generate_evt_data(t,e);break;case game_event_type.enemy_numerous:Updater_Evt_Enemy_N.generate_evt_data(t,e)}},e.prototype.frame_update=function(){var t=this,e=this.cur_evt();if(e){var i=gp_core.stage_len_cal.len,r=e.evt_trigger,n=(gp_core.inter_status.world_speed,i/r);i<e.region_start||(i>=e.region_end?e.change_status(game_event_status.past,function(){t._evt_cursor++}):i>=e.evt_trigger?e.change_status(game_event_status.triggered,function(){t._evt_trigger(e,n)}):i>=e.region_start&&e.change_status(game_event_status.enter,function(){}))}},e.prototype._evt_trigger=function(t,e){switch(t.type){case game_event_type.barrier:gp_core.factory.barrier.evt_trigger(t);break;case game_event_type.bullet_enemy:gp_core.factory.enemy_with_emitter.evt_trigger(t);break;case game_event_type.enemy_numerous:gp_core.factory.enemy_n.evt_trigger(t)}},e}(ns_sirius.sirius_base_object);__reflect(GameEventHandler.prototype,"GameEventHandler");var LaneOccupyingStatus;!function(t){t[t.idle=0]="idle",t[t.enemy_with_bullet=1]="enemy_with_bullet"}(LaneOccupyingStatus||(LaneOccupyingStatus={}));var LaneInfo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.reset_info=function(){this.occupying=LaneOccupyingStatus.idle},e}(ns_sirius.sirius_base_object);__reflect(LaneInfo.prototype,"LaneInfo");var SceneInfo=function(t){function e(){var e=t.call(this)||this;e._lane_occupying=new Array(game_config.column_count);for(var i=0;i<game_config.column_count;i++)e._lane_occupying[i]=new LaneInfo;return e.reset_lane_info(),e}return __extends(e,t),e.prototype.reset_lane_info=function(){for(var t=0;t<game_config.column_count;t++)this._lane_occupying[t].reset_info()},e.prototype.occupy_lane=function(t,e){0>t||(this._lane_occupying[t].occupying=e)},e.prototype.query_lane_occupying_free=function(t){return this._lane_occupying[t].occupying===LaneOccupyingStatus.idle?!0:!1},e}(ns_sirius.sirius_base_object);__reflect(SceneInfo.prototype,"SceneInfo");var StageLengthCal=function(t){function e(){var e=t.call(this)||this;return e.len=0,e.percent=0,e._cal_fr(),e}return __extends(e,t),e.prototype._cal_fr=function(){for(var t=0,e=0,i=game_param.numerical.length.stage_length;i>e;){var r=e/i,n=r*game_param.numerical.speed.world_move_speed_progress_coe,o=game_param.numerical.speed.world_move_speed+n;if(e+=o,t++,e>=i)break}this.total_frame_count=t},e.prototype.start_game=function(){this.len=0,this.percent=0},e.prototype._before_destroy=function(){},e.prototype.frame_update=function(){this.len+=gp_core.inter_status.world_speed;var t=Math.round(100*this.len/game_param.numerical.length.stage_length);this.percent=t,t>=100&&gp_core.game_over()},e}(ns_sirius.sirius_base_object);__reflect(StageLengthCal.prototype,"StageLengthCal");var BulletEntity=function(){function t(){this.is_destroyed=!1}return t.prototype.bullet_init=function(t,e,i){this.car=e,this.e=i,this.s=new BulletStatus,this.view=t,this.view.bind_ee(this),this._syn_pos_with_emitter(),this.pool_status_goto_idle()},t.prototype.destroy=function(){this.is_destroyed=!0,this.view.parent&&this.view.parent.removeChild(this.view),this.car=null,this.view=null,this.s=null,this.e=null},t.prototype.frame_update=function(){if(!this._is_idle){this.s.pos.y-=game_param.numerical.speed.bullet_speed,this.s.cal_rect();var t=this._judge_contract_enemy();if(t){var e=game_param.numerical.dmg.player_bullet_dmg;return t.receive_dmg(e),void this.e.recycle_bullet(this)}var i=this._judge_contract_enemy_we();if(i){var e=game_param.numerical.dmg.player_bullet_dmg;return i.receive_dmg(e),void this.e.recycle_bullet(this)}var r=this._judge_contract_enemy_n();if(r){var e=game_param.numerical.dmg.player_bullet_dmg;return r.receive_dmg(e),void this.e.recycle_bullet(this)}var n=this._judge_contract_block();if(n){var e=game_param.numerical.dmg.player_bullet_dmg;return n.receive_dmg(e),void this.e.recycle_bullet(this)}return this.s.pos.y<0?void this.e.recycle_bullet(this):void this._syn_pos()}},t.prototype._syn_pos=function(){this.is_destroyed||(this.view.x=this.s.pos.x,this.view.y=this.s.pos.y)},t.prototype._judge_contract_enemy=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.enemy.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},t.prototype._judge_contract_enemy_we=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.enemy_with_emitter.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},t.prototype._judge_contract_enemy_n=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.enemy_n.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},t.prototype._judge_contract_block=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.barrier.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},t.prototype.pool_status_goto_idle=function(){this._is_idle=!0,this.view.visible=!1},t.prototype.pool_status_goto_busy=function(){this._is_idle=!1,this._syn_pos_with_emitter(),this.view.visible=!0},t.prototype._syn_pos_with_emitter=function(){this.s.pos.x=this.car._emit_pos.x,this.s.pos.y=this.car._emit_pos.y-this.s.size.height,this._syn_pos()},t}();__reflect(BulletEntity.prototype,"BulletEntity");var EnemyBulletEntity=function(){function t(){this.is_destroyed=!1}return t.prototype.bullet_init=function(t,e,i){this.car=e,this.e=i,this.s=new BulletStatus,this.s.sprite="bullet_demo_png",this.view=t,this.view.bind_ee(this),this._syn_pos_with_emitter(),this.pool_status_goto_idle()},t.prototype.destroy=function(){this.is_destroyed=!0,this.view.parent&&this.view.parent.removeChild(this.view),this.car=null,this.view=null,this.s=null,this.e=null},t.prototype.frame_update=function(){if(!this._is_idle){this.s.pos.x+=this.s.speed.x,this.s.pos.y+=this.s.speed.y,this.s.cal_rect();var t=this._judge_contract_player();if(t){var e=game_param.numerical.enemy_with_bullet.bullet_dmg;return t.receive_dmg(e),void this.e.recycle_bullet(this)}return this.s.pos.y>game_config.dead_line_bottom?void this.e.recycle_bullet(this):this.s.pos.x<game_config.dead_line_left||this.s.pos.x>game_config.dead_line_right?void this.e.recycle_bullet(this):void this._syn_pos()}},t.prototype._judge_contract_player=function(){if(this.is_destroyed)return null;var t=gp_core.player.s.rec;return this.s.rec.intersects(t)?gp_core.player:null},t.prototype._syn_pos=function(){this.is_destroyed||(this.view.x=this.s.pos.x,this.view.y=this.s.pos.y)},t.prototype.pool_status_goto_idle=function(){this._is_idle=!0,this.view.visible=!1},t.prototype.pool_status_goto_busy=function(){this._is_idle=!1,this._syn_pos_with_emitter(),this.view.visible=!0},t.prototype._syn_pos_with_emitter=function(){this.s.pos.x=this.car._emit_pos.x,this.s.pos.y=this.car._emit_pos.y-this.s.size.height;var t=ns_vector.diff_target_module_angle(this.s.pos,gp_core.player.s.pos,game_param.numerical.enemy_with_bullet.bullet_speed,this.s.speed),e=ns_vector.radian_to_angle(t);this.view.rotation=e,this._syn_pos()},t}();__reflect(EnemyBulletEntity.prototype,"EnemyBulletEntity");var BulletStatus=function(){function t(){this.pos=new egret.Point,this.speed=new egret.Point,this.size=new ns_sirius.Size(10,20),this.half_size=new ns_sirius.Size(5,10),this.rec=new egret.Rectangle,this.rec.width=this.size.width,this.rec.height=this.size.height,this.sprite="bullet_png"}return t.prototype.cal_rect=function(){this.rec.x=this.pos.x-this.half_size.width,this.rec.y=this.pos.y-this.half_size.height},t}();__reflect(BulletStatus.prototype,"BulletStatus");var EnemyBulletEmitter=function(){function t(){this._born_cursor=0}return t.prototype.emitter_init=function(t){var e=this;this.car=t,this.bullet_pool=new ns_sirius.dynamic_pool(30),this.bullet_pool.pool_init(EnemyBulletEntity,function(t){var i=gp_core.playground.create_enemy_bullet_STATIC();t.bullet_init(i,e.car,e)})},t.prototype.frame_update=function(){0===this._born_cursor&&this._born_bullet(),this._born_cursor++;var t=game_param.numerical.enemy_with_bullet.bullet_emit;this._born_cursor>t&&(this._born_cursor=0);for(var e=this.bullet_pool.get_array(),i=0;i<e.length;i++){var r=e[i];r.is_destroyed||r.frame_update()}},t.prototype._born_bullet=function(){var t=game_param.internal.length.enemy_with_bullet_dumb_gap;this.car._emit_pos.y>gp_core.player.s.pos.y-t||this.bullet_pool.borrow()},t.prototype.recycle_bullet=function(t){this.bullet_pool.giveback(t)},t}();__reflect(EnemyBulletEmitter.prototype,"EnemyBulletEmitter");var BulletEmitter=function(){function t(){this._born_cursor=0}return t.prototype.emitter_init=function(t){var e=this;this.car=t,this.bullet_pool=new ns_sirius.dynamic_pool(50),this.bullet_pool.pool_init(BulletEntity,function(t){var i=gp_core.playground.create_bullet_STATIC();t.bullet_init(i,e.car,e)})},t.prototype.frame_update=function(){this._born_cursor++;var t=game_param.numerical.born.bullet_emit;this._born_cursor>t&&(this._born_cursor=0,this._born_bullet());for(var e=this.bullet_pool.get_array(),i=0;i<e.length;i++){var r=e[i];r.is_destroyed||r.frame_update()}},t.prototype._born_bullet=function(){this.bullet_pool.borrow()},t.prototype.recycle_bullet=function(t){this.bullet_pool.giveback(t)},t}();__reflect(BulletEmitter.prototype,"BulletEmitter");var game_param;!function(t){function e(){t.internal=new t.internal_param,t.numerical=new t.numerical_param,t.lv_config=new t.level_debug_config,t.parse_internal_param(RES.getRes("internal_param_json"),t.internal),t.parse_numerical_param(RES.getRes("numerical_param_json"),t.numerical),t.parse_level_debug(RES.getRes("level_debug_config_json"),t.lv_config),t.trim_region_internal(t.internal),t.trim_region_numerical(t.numerical),t.trim_level_debug(t.lv_config)}t.establish_params=e}(game_param||(game_param={}));var game_param;!function(t){function e(t,e){e.speed=t.speed,e.health=t.health,e.interval=t.interval,e.length=t.length,e.sensitivity=t.sensitivity,e.coefficient=t.coefficient,e.coin_anim=t.coin_anim}function i(e){t.numerical_param;var i=Math.round(1-t.numerical.speed.world_move_speed),r=e.speed.barrier_move_speed_offset;i>r?r=i:r>40&&(r=40),e.speed.barrier_move_speed_offset=r}function r(t){t.health.player_health<1&&(t.health.player_health=1)}function n(t){}function o(t){t.length.enemy_with_bullet_dumb_gap<10&&(t.length.enemy_with_bullet_dumb_gap=10)}function _(t){}function s(t){t.coefficient.player_collide_coin_coe<.5&&(t.coefficient.player_collide_coin_coe=.5)}function a(t){t.coin_anim.fall_accelerator<100&&(t.coin_anim.fall_accelerator=100),t.coin_anim.initial_speed<50&&(t.coin_anim.initial_speed=50)}function l(t){i(t),n(t),r(t),o(t),_(t),s(t),a(t)}var u=function(){function t(){}return t}();__reflect(u.prototype,"speed");var p=function(){function t(){}return t}();__reflect(p.prototype,"health");var c=function(){function t(){}return t}();__reflect(c.prototype,"interval");var h=function(){function t(){}return t}();__reflect(h.prototype,"length");var d=function(){function t(){}return t}();__reflect(d.prototype,"sensitivity");var m=function(){function t(){}return t}();__reflect(m.prototype,"coefficient");var f=function(){function t(){}return t}();__reflect(f.prototype,"coin_anim");var y=function(){function t(){}return t}();t.internal_param=y,__reflect(y.prototype,"game_param.internal_param"),t.parse_internal_param=e,t.trim_region_internal=l}(game_param||(game_param={}));var game_param;!function(t){function e(t,e){e.debug=t.debug}function i(t){}var r=function(){function t(){}return t}();__reflect(r.prototype,"debug");var n=function(){function t(){}return t}();t.level_debug_config=n,__reflect(n.prototype,"game_param.level_debug_config"),t.parse_level_debug=e,t.trim_level_debug=i}(game_param||(game_param={}));var game_param;!function(t){function e(t,e){e.speed=t.speed,e.dmg=t.dmg,e.health=t.health,e.born=t.born,e.length=t.length,e.probability=t.probability,e.event=t.event,e.barrier=t.barrier,e.enemy_with_bullet=t.enemy_with_bullet,e.enemy_numerous=t.enemy_numerous}function i(t){t.speed.world_move_speed<1&&(t.speed.world_move_speed=1);var e=t.speed.enemy_1_speed_offset_base,i=Math.round(1-t.speed.world_move_speed);i>e?e=i:e>40&&(e=40),t.speed.enemy_1_speed_offset_base=e}function r(t){t.health.barrier_health<1&&(t.health.barrier_health=1),t.health.enemy_1_base<0&&(t.health.enemy_1_base=0),t.health.enemy_1_dispersion<0&&(t.health.enemy_1_dispersion=0),t.health.enemy_1_progress_coe<0&&(t.health.enemy_1_progress_coe=0)}function n(t){t.born.bullet_emit<1&&(t.born.bullet_emit=1),t.barrier.barrier_row_distance<10&&(t.barrier.barrier_row_distance=10)}function o(t){t.length.stage_length<300&&(t.length.stage_length=300)}function _(t){}function s(t){i(t),n(t),r(t),o(t),_(t)}var a=function(){function t(){}return t}();__reflect(a.prototype,"speed");var l=function(){function t(){}return t}();__reflect(l.prototype,"dmg");var u=function(){function t(){}return t}();__reflect(u.prototype,"health");var p=function(){function t(){}return t}();__reflect(p.prototype,"born");var c=function(){function t(){}return t}();__reflect(c.prototype,"barrier");var h=function(){function t(){}return t}();__reflect(h.prototype,"length");var d=function(){function t(){}return t}();__reflect(d.prototype,"probability");var m=function(){function t(){}return t}();__reflect(m.prototype,"event");var f=function(){function t(){}return t}();__reflect(f.prototype,"enemy_with_bullet");var y=function(){function t(){}return t}();__reflect(y.prototype,"enemy_numerous");var g=function(){function t(){}return t}();t.numerical_param=g,__reflect(g.prototype,"game_param.numerical_param"),t.parse_numerical_param=e,t.trim_region_numerical=s}(game_param||(game_param={}));var InputHandler=function(){function t(){this._start_player=new egret.Point,this._start_mouse=new egret.Point,this._mouse_is_down=!1}return t.prototype.session_start=function(t){this.cw=game_config.playground_w,this.ch=game_config.playground_h,this.map_offset=0,this.map_offset_max=Math.round(.4*game_config.column_width),this.player_pos=new egret.Point(.5*this.cw,game_config.player_default_y),this.motion_detector=new PlayerMotionDetector,this.motion_detector.session_start(),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._handle_touch_down,this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this._handle_touch_move,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this._handle_touch_up,this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this._handle_touch_up,this)},t.prototype._handle_touch_down=function(t){this._start_mouse.x=t.stageX,this._start_mouse.y=t.stageY,this._start_player.copyFrom(this.player_pos),this._start_map_offset=this.map_offset,this.motion_detector.enable(this._start_mouse.x),this._mouse_is_down=!0},t.prototype._handle_touch_move=function(t){var e=t.stageX-this._start_mouse.x;this._handle_player_move(e),this._handle_map_offset(e),this.motion_detector.update_cur_mouse_x(t.stageX)},t.prototype._handle_player_move=function(t){if(this._mouse_is_down){var e=this._start_player.x+1.5*t;e<game_config.min_x&&(e=game_config.min_x),e>game_config.max_x&&(e=game_config.max_x),this.player_pos.x=e}},t.prototype._handle_map_offset=function(t){if(!(game_param.internal.sensitivity.camera_motion<=0)){var e=this._start_map_offset+t*game_param.internal.sensitivity.camera_motion/100;e<-this.map_offset_max&&(e=-this.map_offset_max),e>this.map_offset_max&&(e=this.map_offset_max),this.map_offset=e}},t.prototype._handle_touch_up=function(t){this.motion_detector.disable()},t.prototype.end_touch_session=function(){this._mouse_is_down=!1,this.player_pos.x=.5*game_config.playground_w},t}();__reflect(InputHandler.prototype,"InputHandler");var PlayerMotionDetector=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.session_start=function(){this._enabled=!1},e.prototype.enable=function(t){this._enabled=!0,this._cur_mouse_x=this._previouse_mouse_x=t},e.prototype.disable=function(){this._enabled=!1,gp_core.player._motion_sm.change_state(player_motion_status.still)},e.prototype.update_cur_mouse_x=function(t){this._cur_mouse_x=t},e.prototype.frame_update=function(){if(this._enabled){var t=this._cur_mouse_x-this._previouse_mouse_x;this._previouse_mouse_x=this._cur_mouse_x;var e=0;t>e?gp_core.player._motion_sm.change_state(player_motion_status.right):-e>t?gp_core.player._motion_sm.change_state(player_motion_status.left):gp_core.player._motion_sm.change_state(player_motion_status.still)}},e}(ns_sirius.sirius_base_object);__reflect(PlayerMotionDetector.prototype,"PlayerMotionDetector");var GameCoreView=function(t){function e(){var e=t.call(this)||this;e.touchEnabled=!1,e.touchChildren=!1;var i=new DecorationCover;e.addChild(i),i.horizontalCenter=0,i.width=game_config.playground_w,i.height=game_config.playground_h,i.bottom=0,e.road_lines=i;var r=new Playground;e.addChild(r),r.horizontalCenter=0,r.width=game_config.playground_w,r.height=game_config.playground_h,r.bottom=0,e.playground=r;var n=new car_explosion_layer;e.addChild(n),n.horizontalCenter=0,n.width=game_config.playground_w,n.height=game_config.playground_h,n.bottom=0,e.layer_car_explo=n;var o=new coin_layer;return e.addChild(o),o.horizontalCenter=0,o.width=game_config.playground_w,o.height=game_config.playground_h,o.bottom=0,e.coin_layer=o,e}return __extends(e,t),e.prototype.frame_update=function(){this.road_lines.frame_update(),this._update_map_offset()},e.prototype._update_map_offset=function(){var t=gp_core.ih.map_offset;this.road_lines.horizontalCenter=t,this.playground.horizontalCenter=t,this.layer_car_explo.horizontalCenter=t,this.coin_layer.horizontalCenter=t},e}(eui.Group);__reflect(GameCoreView.prototype,"GameCoreView");var car_explosion_layer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e._pool=new ns_sirius.dynamic_pool(3),e._pool.pool_init(egret_comps.sync_mc_display,function(t){e.addChild(t),t.load("car_explosion_mc_json","car_explosion_tex_png",{scale:2.8})}),e}return __extends(e,t),e.prototype.display_explosion=function(t){var e=this,i=this._pool.borrow();i&&(i.x=t.x,i.y=t.y,i.play(function(){e._pool.giveback(i)}))},e.prototype.reset=function(){this._pool.pool_reset()},e.prototype.destroy=function(){this._pool.destroy()},e}(eui.Group);__reflect(car_explosion_layer.prototype,"car_explosion_layer");var coin_layer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e._pool=new ns_sirius.dynamic_pool(4),e._pool.pool_init(CoinAnimView,function(t){e.addChild(t)}),e}return __extends(e,t),e.prototype.display_effect=function(t){var e=this._pool.borrow();if(e){var i=new ns_sirius.anim_gravity_param;i.gravity_vector=new egret.Point(0,game_param.internal.coin_anim.fall_accelerator);var r=game_param.internal.coin_anim.initial_speed,n=ns_sirius.random_region(.75*-Math.PI,.25*-Math.PI),o=r*Math.cos(n),_=r*Math.sin(n);i.speed_vector=new egret.Point(o,_),i.start_position=new egret.Point(t.x,t.y),e.start_anim(i)}},e.prototype.giveback=function(t){this._pool.giveback(t)},e.prototype.reset=function(){this._pool.pool_reset()},e.prototype.destroy=function(){this._pool.destroy()},e}(eui.Group);__reflect(coin_layer.prototype,"coin_layer");var BulletDisplay=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._create_bg_display=function(t,e){var i=new eui.Rect;this.addChild(i),i.fillColor=0,i.width=t,i.height=e,i.x=-Math.round(.5*t),i.y=-Math.round(.5*e),this.bgrect=i},e.prototype._create_sprite=function(t){var e=new eui.Image(t.s.sprite);this.addChild(e),e.width=22,e.height=66,e.x=-Math.round(.5*e.width),e.y=-Math.round(.5*e.height),this.sprite=e},e.prototype.bind_ee=function(t){var e=t.s.size.width,i=t.s.size.height;this._create_bg_display(e,i),this._create_sprite(t)},e}(egret.DisplayObjectContainer);__reflect(BulletDisplay.prototype,"BulletDisplay");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);
var EnemyBulletDisplay=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._create_bg_display=function(t,e){var i=new eui.Rect;this.addChild(i),i.fillColor=0,i.width=t,i.height=e,i.x=-Math.round(.5*t),i.y=-Math.round(.5*e),this.bgrect=i},e.prototype._create_sprite=function(t){var e=new eui.Image(t.s.sprite);this.addChild(e),e.width=22,e.height=66,e.x=-Math.round(.5*e.width),e.y=-Math.round(.5*e.height),this.sprite=e},e.prototype.bind_ee=function(t){var e=t.s.size.width,i=t.s.size.height;this._create_bg_display(e,i),this._create_sprite(t)},e}(egret.DisplayObjectContainer);__reflect(EnemyBulletDisplay.prototype,"EnemyBulletDisplay");var PlayerDisplay=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._create_turret=function(t){var e=new eui.Image("gun_png");this.display.addChild(e),e.width=40,e.height=40,e.x=-Math.round(.5*e.width),e.y=-t.s.size.height-e.height,this.turret=e},e.prototype.bind_ee=function(e){t.prototype.bind_ee.call(this,e);var i=new egret.DisplayObjectContainer;this.addChild(i),i.y=e.s.half_size.height,this.display=i,this._create_turret(e),this.display.addChild(this.sprite),this.sprite.y=-e.s.size.height,this.addChild(this.lbl)},e.prototype.start_vibration_anim=function(){t.prototype.start_vibration_anim.call(this),this.sprite.filters=[this._vibration_filter]},e.prototype.single_anim_comp=function(e){t.prototype.single_anim_comp.call(this,e),1==e.anim_id&&(this.sprite.filters=null)},e}(CarDisplay);__reflect(PlayerDisplay.prototype,"PlayerDisplay");var GCCV_vibration=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.animation_duration=function(){var t=ns_sirius.anim_clock.frame_to_ms(25);return t},e.prototype._anim_update=function(t){var e=this._target_view,i=2-t;e.scaleX=i,e.scaleY=i},e.prototype._reset_anim_properties=function(){var t=this._target_view,e=1;t.scaleX=e,t.scaleY=e},e}(ns_sirius.single_animation);__reflect(GCCV_vibration.prototype,"GCCV_vibration");var BlockDisplay=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._vibration_anim&&(this._vibration_anim.destroy(),this._vibration_anim=null)},e.prototype.bind_ee=function(t){var e=t.s.size.width,i=t.s.size.height,r=new eui.Rect;this.addChild(r),r.fillColor=8805913,r.width=e,r.height=i,r.x=-t.s.half_size.width,r.y=-t.s.half_size.height,this.lbl_con=new egret.DisplayObjectContainer,this.addChild(this.lbl_con),this.lbl_con.x=0,this.lbl_con.y=0,this.lbl=new eui.Label,this.lbl_con.addChild(this.lbl),this.lbl.width=e,this.lbl.height=i,this.lbl.x=-t.s.half_size.width,this.lbl.y=-t.s.half_size.height,this.lbl.textAlign="center",this.lbl.verticalAlign="middle",this.lbl.text=t.s.health+"",this.lbl.size=30,this._vibration_anim=new GCCV_vibration(this,this.lbl_con,1).init()},e.prototype.syn_health=function(t){this.lbl.text=t+""},e.prototype.start_vibration_anim=function(){this._vibration_anim.start()},e.prototype.single_anim_comp=function(t){},e}(ActorDisplay);__reflect(BlockDisplay.prototype,"BlockDisplay",["ns_sirius.Isirius_base_object"]);var BlockTipDisplay=function(t){function e(){var e=t.call(this)||this,i=new egret.Bitmap;return e.addChild(i),i.texture=RES.getRes("exclamatory_png"),i.x=.5*-i.width,i.y=.5*-i.height,e}return __extends(e,t),e}(ns_sirius.sirius_game_view_base);__reflect(BlockTipDisplay.prototype,"BlockTipDisplay");var Playground=function(t){function e(){var e=t.call(this)||this;return e._bullets_container=new eui.Group,e.addChild(e._bullets_container),e._bullets_container.percentWidth=100,e._bullets_container.percentHeight=100,e}return __extends(e,t),e.prototype.create_player_STATIC=function(){var t=new PlayerDisplay;return this.addChild(t),t},e.prototype.create_enemy_STATIC=function(){var t=new CarDisplay;return this.addChild(t),t},e.prototype.create_bullet_STATIC=function(){var t=new BulletDisplay;return this._bullets_container.addChild(t),t},e.prototype.create_enemy_bullet_STATIC=function(){var t=new EnemyBulletDisplay;return this._bullets_container.addChild(t),t},e.prototype.create_block_STATIC=function(){var t=new BlockDisplay;return this.addChild(t),t},e.prototype.create_block_TIP_STATIC=function(){var t=new BlockTipDisplay;return this.addChild(t),t},e}(eui.Group);__reflect(Playground.prototype,"Playground");var DecorationCover=function(t){function e(){var e=t.call(this)||this;e.line_height=168,e.line_width=4,e.line_gap=225,e.row_h=0,e.line_row_count=0,e._start_offset=0,e.touchEnabled=!1,e.touchChildren=!1,e.row_h=e.line_height+e.line_gap,e.line_row_count=Math.floor(game_config.initial_screen_h/e.row_h)+2,e._rows=new Array(e.line_row_count);for(var i=0;i<e.line_row_count;i++){var r=new DecorationRow(e.line_width,e.line_height);e.addChild(r),e._rows[i]=r,r.percentWidth=100,r.height=e.line_height}return e._update_pos_y(),e}return __extends(e,t),e.prototype._cal_y=function(t){var e=this._start_offset+game_config.initial_screen_h-t*(this.line_height+this.line_gap)-this.line_height;return e},e.prototype._update_pos_y=function(){for(var t=0;t<this.line_row_count;t++)this._rows[t].y=this._cal_y(t)},e.prototype.frame_update=function(){this._start_offset+=gp_core.inter_status.world_speed,this._start_offset>=this.row_h&&(this._start_offset-=this.row_h,this._swap()),this._update_pos_y()},e.prototype._swap=function(){for(var t=this._rows[0],e=0;e<this.line_row_count-1;e++)this._rows[e]=this._rows[e+1];this._rows[this.line_row_count-1]=t},e}(eui.Group);__reflect(DecorationCover.prototype,"DecorationCover");var DecorationRow=function(t){function e(e,i){var r=t.call(this)||this;r.line_width=e,r.line_height=i;for(var n=1;n<game_config.column_count;n++)r._create_line(n*game_config.column_width);return r}return __extends(e,t),e.prototype._create_line=function(t){var e=new eui.Rect;return this.addChild(e),e.fillColor=8885736,e.width=this.line_width,e.height=this.line_height,e.x=t-.5*this.line_width,e.y=0,e},e}(eui.Group);__reflect(DecorationRow.prototype,"DecorationRow");var SimpleProg=function(t){function e(){var e=t.call(this)||this,i=new eui.Rect;return e.addChild(i),i.fillColor=16777215,i.percentWidth=100,i.percentHeight=100,e.back=i,i=new eui.Rect,e.addChild(i),i.fillColor=7929035,i.percentWidth=100,i.percentHeight=100,e.front=i,e}return __extends(e,t),e.prototype.update_prog=function(t){this._update(100*t)},e.prototype.update_percent=function(t){this._update(t)},e.prototype._update=function(t){this.front.percentWidth=Math.round(t)},e}(ns_sirius.sirius_view_base);__reflect(SimpleProg.prototype,"SimpleProg");var StageProgView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e.prog=new SimpleProg,e.addChild(e.prog),e.prog.percentWidth=70,e.prog.horizontalCenter=0,e.prog.height=14,e.prog.top=66,e.prog.update_percent(0),e.lbl_stage=new eui.Label,e.addChild(e.lbl_stage),e.lbl_stage.height=30,e.lbl_stage.top=30,e.lbl_stage.horizontalCenter=0,e.lbl_stage.percentWidth=70,e.lbl_stage.verticalAlign=egret.VerticalAlign.BOTTOM,e.lbl_stage.textAlign=egret.HorizontalAlign.CENTER,e.lbl_stage.text="1",e.lbl_stage.bold=!0,e.lbl_stage.size=20,e.lbl_prog=new eui.Label,e.addChild(e.lbl_prog),e.lbl_prog.height=30,e.lbl_prog.top=30,e.lbl_prog.horizontalCenter=0,e.lbl_prog.percentWidth=70,e.lbl_prog.verticalAlign=egret.VerticalAlign.BOTTOM,e.lbl_prog.textAlign=egret.HorizontalAlign.RIGHT,e.lbl_prog.text="0%",e.lbl_prog.bold=!1,e.lbl_prog.size=16,e.coin_count=new eui.Label,e.addChild(e.coin_count),e.coin_count.height=30,e.coin_count.top=30,e.coin_count.horizontalCenter=0,e.coin_count.percentWidth=70,e.coin_count.verticalAlign=egret.VerticalAlign.BOTTOM,e.coin_count.textAlign=egret.HorizontalAlign.LEFT,e.coin_count.text="0",e.coin_count.bold=!0,e.coin_count.size=20,e.cur_len=new eui.Label,e.addChild(e.cur_len),e.cur_len.height=30,e.cur_len.top=70,e.cur_len.horizontalCenter=0,e.cur_len.percentWidth=70,e.cur_len.verticalAlign=egret.VerticalAlign.BOTTOM,e.cur_len.textAlign=egret.HorizontalAlign.RIGHT,e.cur_len.text="0",e.cur_len.bold=!0,e.cur_len.size=20,e}return __extends(e,t),e.prototype.update_percent=function(t){this.prog.update_percent(t),this.lbl_prog.text=t+"%"},e.prototype.update_len=function(t){this.cur_len.text=Math.round(t)+""},e.prototype.update_coin=function(t){this.coin_count.text=t+""},e}(ns_sirius.sirius_view_base);__reflect(StageProgView.prototype,"StageProgView");var GameUIView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e.prog=new StageProgView,e.addChild(e.prog),e.prog.percentWidth=100,e.prog.height=100,e}return __extends(e,t),e.prototype.frame_update=function(){this.prog.update_percent(gp_core.stage_len_cal.percent),this.prog.update_len(gp_core.stage_len_cal.len),gp_core.inter_status.coin_needs_update&&this.prog.update_coin(gp_core.inter_status.retrieve_coin_count())},e}(ns_sirius.sirius_view_base);__reflect(GameUIView.prototype,"GameUIView");var GameViewWrapper=function(t){function e(){var e=t.call(this)||this,i=new eui.Rect;e.addChild(i),i.fillColor=2764919,i.percentWidth=100,i.percentHeight=100,i.touchEnabled=!0,e.touch_area=i;var r=new GameCoreView;e.addChild(r),r.percentWidth=100,r.percentHeight=100,r.bottom=0,r.horizontalCenter=0,e.core=r;var n=new GameUIView;return e.addChild(n),n.percentWidth=100,n.percentHeight=100,n.bottom=0,n.horizontalCenter=0,e.ui=n,e}return __extends(e,t),e.prototype.frame_update=function(){this.core.frame_update(),this.ui.frame_update()},e}(ns_sirius.sirius_view_base);__reflect(GameViewWrapper.prototype,"GameViewWrapper");var math_lib;!function(t){function e(t,e){return t.containsRect(e)}t.aabb=e}(math_lib||(math_lib={}));var ns_probability;!function(t){function e(t){return 0>=t?!1:t>=1?!0:Math.random()<t}t.dice=e}(ns_probability||(ns_probability={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var rand;!function(t){function e(t){for(var e=Math.random(),i=0;i<t.length-1;i++)if(e>=t[i]&&e<t[i+1])return i;return-1}t.rand_array=e}(rand||(rand={}));var ns_vector;!function(t){function e(t,e,i){var r=e.x-t.x,n=e.y-t.y,o=Math.sqrt(r*r+n*n);i.x=r/o,i.y=n/o}function i(t,e,i,r){var n=e.x-t.x,o=e.y-t.y,_=Math.sqrt(n*n+o*o);r.x=n*i/_,r.y=o*i/_}function r(t,e,i,r){var n=e.x-t.x,o=e.y-t.y,_=Math.sqrt(n*n+o*o);r.x=n*i/_,r.y=o*i/_;var s=-Math.asin(n/_);return s}function n(t){return 180*t/Math.PI}function o(t){return t*Math.PI/180}t.diff_identity=e,t.diff_target_module=i,t.diff_target_module_angle=r,t.radian_to_angle=n,t.angle_to_radian=o}(ns_vector||(ns_vector={}));var ConfigPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/module_skins/config/config.exml",e}return __extends(e,t),e}(eui.Component);__reflect(ConfigPanel.prototype,"ConfigPanel");var BlockEntity=function(t){function e(){var e=t.call(this)||this;return e._column_index=-1,e}return __extends(e,t),e.prototype._create_status=function(){return new BlockEntityStatus},e.prototype._create_view=function(){return gp_core.playground.create_block_STATIC()},e.prototype.actor_init=function(e,i){t.prototype.actor_init.call(this,e,i),this._tip_view=gp_core.playground.create_block_TIP_STATIC(),this._tip_view.y=game_config.block_tip_pos_y,this._tip_view.visible=!1},e.prototype.frame_update=function(){if(!ns_sirius.pool_data(this).is_free){var t=gp_core.inter_status.world_speed+this.s.move_speed_offset;this.s.pos.y+=t,this.s.cal_rect(),this.s.pos.y>game_config.block_tip_disappear_y&&(this._tip_view.visible=!1),this.s.pos.y>game_config.dead_line_bottom&&gp_core.factory.barrier.giveback(this),this._syn_pos()}},e.prototype.receive_dmg=function(t){this.s.immortal||(this.s.health-=t,this.view.syn_health(this.s.health),this.view.start_vibration_anim(),this.s.health<=0&&this.prepare_to_die())},e.prototype.prepare_to_die=function(){game_view.core.layer_car_explo.display_explosion(this.s.pos),game_view.core.coin_layer.display_effect(this.s.pos),this.s.health=0,gp_core.factory.barrier.giveback(this)},e.prototype._pos_x=function(){this._column_index<0&&console.error("_column_index < 0");var t=game_config.column_middle_pos[this._column_index];return t},e.prototype.reborn_from_column=function(t){this._column_index=t,this.s.pos.x=this._pos_x(),this.s.reset_dynamic_values();var e=game_param.numerical.barrier.barrier_born_y_dispersion;if(e>0){var i=Math.round(ns_sirius.random_region(-e,e));this.s.pos.y+=i}this.view.visible=!0,this._tip_view.visible=!0,this.view.syn_all_status(this.s)},e.prototype.pool_status_goto_idle=function(){this.view.visible=!1,this._tip_view.visible=!1},e.prototype.pool_status_goto_busy=function(){},e.prototype._syn_pos=function(){this._is_destroyed||(this.view.syn_pos(this.s.pos),this._tip_view.x=this.s.pos.x)},e}(ActorEntity);__reflect(BlockEntity.prototype,"BlockEntity");var BlockEntityStatus=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.reset_static_values=function(){this.move_speed_offset=game_param.internal.speed.barrier_move_speed_offset},e.prototype.reset_dynamic_values=function(){var t=rand_region.rand_in_game_round(game_param.numerical.barrier.barrier_tip_distance,0,game_param.numerical.barrier.barrier_tip_distance_process_coe);this.pos.y=-t,this.health=game_param.numerical.health.barrier_health},e}(ActorEntityStatus);__reflect(BlockEntityStatus.prototype,"BlockEntityStatus");var ns_sirius;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.mm=new t.module_marshal,i.layes=new t.layer_partition,i.sirius_public=new t.SiriusPublic,i}return __extends(i,e),i.prototype.core_init=function(){this.mm.core_init(this),this.layes.core_init(this),this.sirius_public.core_init(this)},i}(t.sirius_base_object);t.SiriusCore=e,__reflect(e.prototype,"ns_sirius.SiriusCore")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.view_manager=new t.app_vh_manager,i.device_info=new t.sirius_device_info,i.log=new t.sirius_log,i.nfc=new t.NFC,i.storage=new t.sirius_web_serialization,i}return __extends(i,e),i.prototype.core_init=function(t){this._sirius=t,this.view_manager.core_init(t)},i.prototype.debug_foo=function(){this.view_manager.show_popup_text_msg("You are connected to the sirius hierarchy.")},i}(t.sirius_element_module);t.SiriusPublic=e,__reflect(e.prototype,"ns_sirius.SiriusPublic")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(){this._animatebles=new Array,this._timeScale=1}return t.frame_to_ms=function(t){return Math.round(1e3*t/60)},Object.defineProperty(t.prototype,"time_scale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!0,configurable:!0}),t.prototype.update=function(t){if(1!==this._timeScale&&(t*=this._timeScale),0!=t&&!(0>t)){for(var e=0,i=0,r=this._animatebles.length;r>e;++e){var n=this._animatebles[e];null!==n?(i>0&&(this._animatebles[e-i]=n,this._animatebles[e]=null),n.update(t)):i++}if(i>0){for(r=this._animatebles.length;r>e;++e){var o=this._animatebles[e];null!==o?this._animatebles[e-i]=o:i++}this._animatebles.length-=i}}},t.prototype.add=function(t){t&&this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null,t.clock=null)},t.prototype.removeAt=function(t){t>=0&&(this._animatebles[t].clock=null,this._animatebles[t]=null)},t}();t.anim_clock=e,__reflect(e.prototype,"ns_sirius.anim_clock"),t.world_clock=new e,t.timer_clock=new e}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(){this._timeScale=1,this._listeners=new Array}return Object.defineProperty(t.prototype,"time_scale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!0,configurable:!0}),t.prototype.register_listener=function(t){this._listeners.indexOf(t)>=0||this._listeners.push(t)},t.prototype.remove_listener=function(t){var e=this._listeners.indexOf(t);0>e||this._listeners.splice(e,1)},t.prototype.update=function(t){if(1!==this._timeScale&&(t*=this._timeScale),0!=t&&!(0>t))for(var e=0;e<this._listeners.length;e++){var i=this._listeners[e];i.is_destroyed!==!0&&this._listeners[e].update(t)}},t}();t.global_pulse_clock=e,__reflect(e.prototype,"ns_sirius.global_pulse_clock"),t.pulse_clock=new e}(ns_sirius||(ns_sirius={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,r){function n(t){e.call(r,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(r))}var _=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(r,generateEUI2)},_)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var a=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(r,generateJSON.paths[t])},this):RES.getResByUrl(a,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(r,generateJSON.paths[t])},_)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ns_sirius;!function(t){var e=function(e){function i(t,i,r){void 0===t&&(t=null),void 0===i&&(i=0),void 0===r&&(r=null);var n=e.call(this)||this;return n._listener=t,n.timer_id=i,n._param=r,n}return __extends(i,e),i.prototype.init=function(t){return void 0===t&&(t=null),this.timer_active(),this},i.prototype.timer_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.timer_deactive=function(){this._clock&&this._clock.remove(this)},i.prototype._before_destroy=function(){this.stop(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._param=null},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tick_cursor",{get:function(){return this._tick_cursor},enumerable:!0,configurable:!0}),i.prototype.start=function(t,e,i,r){return void 0===i&&(i=0),void 0===r&&(r=!1),this._normalized_time=0,this._real_time=0,this._tick_cursor=0,this._is_animating=!0,this._anim_duration=t,this._loop_count=e,r?this._tick_once():i>0&&(this._real_time+=i),this},i.prototype.stop=function(){this._is_animating=!1},i.prototype.update=function(t){this._is_animating&&(this._real_time+=t,this._normalized_time=this._real_time/this._anim_duration,this._normalized_time<1||(this._tick_once(),this._loop_count<=0||this._tick_cursor>=this._loop_count&&(this.stop(),this._post_finish())))},i.prototype._tick_once=function(){this._normalized_time=0,this._real_time=0,this._listener.rtimer_tick(this),this._tick_cursor++},i.prototype._post_finish=function(){this._listener.rtimer_finish(this)},i}(t.sirius_base_object);t.timer_rtime_based=e,__reflect(e.prototype,"ns_sirius.timer_rtime_based",["ns_sirius.IAnimatable"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(e){function i(t,i,r,n){void 0===t&&(t=null),void 0===i&&(i=null),void 0===r&&(r=0),void 0===n&&(n=null);var o=e.call(this)||this;return o._is_destroyed=!1,o._listener=t,o.anim_id=r,o._init_param=n,o._target_view=i,o}return __extends(i,e),i.prototype._before_destroy=function(){this._is_destroyed=!0,this.stop(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._init_param=null,this._param=null,this._target_view=null},i.prototype.init=function(t){return void 0===t&&(t=null),this.anim_active(t),this},i.prototype.anim_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.anim_deactive=function(){this._clock&&this._clock.remove(this)},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!0,configurable:!0}),i.prototype.is_disposable=function(){return!1},Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!0,configurable:!0}),i.prototype.start=function(t){this._param=t,this._normalized_time=0,this._real_time=0,this._anim_duration=this.animation_duration(),this._is_animating=!0,this._reset_anim_properties()},i.prototype.stop=function(){this._is_animating=!1,this._normalized_time=0,this._real_time=0,this._reset_anim_properties()},i.prototype.update=function(t){this._is_animating&&(this._real_time+=t,this._normalized_time=this._real_time/this._anim_duration,this._normalized_time>1?this._anim_update(1):this._anim_update(this._normalized_time),this._normalized_time<1||(this.stop(),this._listener&&this._listener.anim_ft_comp(this),this.is_disposable()&&this.destroy()))},i.prototype.util_linear_interpolation=function(t,e,i){return t+(e-t)*i},i}(t.sirius_base_object);t.anim_fixed_time=e,__reflect(e.prototype,"ns_sirius.anim_fixed_time",["ns_sirius.IAnimatable"])}(ns_sirius||(ns_sirius={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function r(r){e.call(i,r,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?r(n):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var sirius_internal_type;!function(t){t[t["null"]=0]="null",t[t["boolean"]=1]="boolean",t[t.integer=2]="integer",t[t["float"]=3]="float",t[t.string=4]="string",t[t.array=5]="array",t[t.object=6]="object"}(sirius_internal_type||(sirius_internal_type={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.design_width=1136,e.design_height=640,e.stage_width=0,e.stage_height=0,e.safe_width=0,e.safe_height=0,e.popup_width=0,e.popup_height=0,e.popup_con_width=0,e.popup_con_height=0,e.initial_optimal_w=0,e}return __extends(e,t),e.prototype.syn_stage_size=function(t,e){this.stage_width=t,this.stage_height=e,this.safe_height=e,this.safe_width=t>this.design_width?this.design_width:t,this.popup_height=.637*this.safe_height,this.popup_width=.746*this.popup_height,this.popup_con_width=Math.floor(.691*this.popup_height),this.popup_con_height=Math.floor(.905*this.popup_height)},e.prototype.device_info_init=function(){var t=Math.ceil(1125*this.design_height/2436);this.stage_width>=this.design_width?this.initial_optimal_w=this.design_width:this.initial_optimal_w=t},e}(t.sirius_base_object);t.sirius_device_info=e,__reflect(e.prototype,"ns_sirius.sirius_device_info")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.after_state_init=function(){},e.prototype.state_enum=function(){return 0},e.prototype.state_str=function(){return"Default"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(t.GP_StateBase);t.GP_State_Default=e,__reflect(e.prototype,"ns_sirius.GP_State_Default")}(ns_sirius||(ns_sirius={}));var Anim_Drop_Param=function(){function t(){}return t}();__reflect(Anim_Drop_Param.prototype,"Anim_Drop_Param");var Anim_Drop=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.animation_duration=function(){var t=game_param.numerical.enemy_numerous.drop_anim_duration,e=ns_sirius.anim_clock.frame_to_ms(t);return e},e.prototype._anim_update=function(t){var e=this._target_view,i=this._param;e.pos.y=i.from+(i.to-i.from)*t},e.prototype._reset_anim_properties=function(){},e}(ns_sirius.single_animation);__reflect(Anim_Drop.prototype,"Anim_Drop");var ns_sirius;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._s_default=new t.GP_State_Default,i._current_state=new t.GP_State_Default,i._listener=null,i._ctx=null,i}return __extends(i,e),i.prototype._before_destroy=function(){this._ctx=null,this._listener=null,this._current_state=null,this._s_default.destroy(),this._s_default=null},i.prototype.get_current_state=function(){return this._current_state},i.prototype.get_current_state_str=function(){return this._current_state.state_str()},i.prototype.get_current_state_enum=function(){return this._current_state.state_enum()},i.prototype.machine_initialize=function(t,e,i){void 0===i&&(i=null),this._listener=t,this._ctx=e,this._s_default.state_init(this,e),this._states_init(e)},i.prototype._states_init=function(t){},i.prototype.get_state_by_enum=function(t){return null},i.prototype.state_change=function(t,e){void 0===e&&(e=null);var i=this.get_state_by_enum(t);i||console.log("invalid game machine enum "+t);var r=this._current_state;this._current_state=i,this._listener.sm_state_changed(r,i,e),r.state_leave(i,e),i.state_enter(r,e)},i.prototype.machine_update=function(){this._current_state.state_update()},i}(t.sirius_base_object);t.GP_StateMachine=e,__reflect(e.prototype,"ns_sirius.GP_StateMachine")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(){this.target=null,this.fun=null}return t}();__reflect(e.prototype,"NFC_signature");var i=function(){function t(){this._dic=Object.create(null)}return t.prototype.exists=function(t,e,i){var r=this._dic[t];if(!r)return!1;for(var n=r.length,o=0;n>o;o++){var _=r[o];if(_.target===e&&_.fun===i)return!0}return!1},t.prototype.add=function(t,i,r){if(!this.exists(t,i,r)){var n=this._dic[t];n||(this._dic[t]=[],n=this._dic[t]);var o=new e;o.target=i,o.fun=r,n.push(o)}},t.prototype.add_once=function(t,e,i){this.add(t,e,i)},t.prototype.remove=function(t,e){var i=this._dic[t];if(i)for(var r=i.length,n=0;r>n;n++){var o=i[n];if(o.target===e){i.splice(n,1),o.fun=null,o.target=null;break}}},t.prototype.remove_target=function(t){for(var e in this._dic){var i=this._dic[e];if(i)for(var r=i.length,n=0;r>n;n++){var o=i[n];o&&o.target===t&&(i.splice(n,1),o.fun=null,o.target=null)}}},t.prototype.debug_info=function(t){var e=this._dic[t],i=e.length;console.log(i)},t.prototype.post=function(t,e){void 0===e&&(e=void 0);var i=this._dic[t];if(i)for(var r=i.length,n=0;r>n;n++){var o=i[n];o&&o.fun.apply(o.target,[e])}},t.prototype.post_and_remove_global=function(t,e){void 0===e&&(e=void 0);var i=this._dic[t];if(i){for(var r=i.length,n=0;r>n;n++){var o=i[n];o&&(o.fun.apply(o.target,[e]),o.fun=null,o.target=null)}this._dic[t]=null}},t}();t.NFC=i,__reflect(i.prototype,"ns_sirius.NFC")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(){}return t.prototype.log=function(t){console.log(t)},t.prototype.throw_error=function(t){throw console.error(t),t},t.prototype.error=function(t){console.error(t)},t.prototype.throw_error_too_strict=function(t){console.log(t)},t.prototype.sh_exception=function(t){console.log("sh:> "+t)},t}();t.sirius_log=e,__reflect(e.prototype,"ns_sirius.sirius_log")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.establish_reflection_table(),e}return __extends(e,t),e.prototype.establish_reflection_table=function(){this._rtable=lk_rtable;for(var t=this._rtable.length,e=0;t>e;e++)this._rtable[e].index=e},e.prototype.register_sm=function(t,e){this._sm_1=t,this._sm_2=e},e.prototype._choose_sm=function(t){return 1===t?this._sm_2:this._sm_1},e.prototype.show_module=function(t,e,i,r,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=0),void 0===n&&(n=null);var o=this._find_module_by_name(t);if(!o)return void console.error("不存在模块 ： "+t);var _=new o.vm;_.register_module_key(o.module_name),_.register_layer_index(r);var s=new o.view;return this._choose_sm(r).show_module(s,_,e,i,n),s},e.prototype.remove_all_modules=function(t){this._choose_sm(t).clear_all()},e.prototype.remove_module=function(t,e){this._choose_sm(e).remove_module(t)},e.prototype.remove_module_by_key=function(t,e){this._choose_sm(e).remove_module_by_key(t)},e.prototype.pop_top_module=function(t){this._choose_sm(t).pop_top()},e.prototype.module_count=function(t){return this._choose_sm(t).module_count()},e.prototype.get_top_module=function(t){return this._choose_sm(t).top_module()},e.prototype._find_module_by_name=function(t){if(!this._rtable)return null;for(var e=this._rtable.length,i=0;e>i;i++){var r=this._rtable[i];if(r.module_name==t)return r}return null},e.prototype.module_manual_init=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null);var n=this._find_module_by_name(t);if(!n)return void console.error("不存在模块 ： "+t);var o=new n.vm;o.register_module_key(n.module_name);var _=new n.view;return this._sub_module_init(_,o,e,i),_},e.prototype._sub_module_init=function(t,e,i,r){void 0===i&&(i=null),void 0===r&&(r=null),e.vm_pre_init(r,t,this._sirius),t.view_pre_init(i,e,this._sirius),t.view_init(),e.vm_init()},e}(t.sirius_element_module);t.module_marshal=e,__reflect(e.prototype,"ns_sirius.module_marshal")}(ns_sirius||(ns_sirius={}));var EnemyCarN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.destroy=function(){this._anim_drop&&(this._anim_drop.destroy(),this._anim_drop=null),t.prototype.destroy.call(this)},e.prototype._create_status=function(){return new EnemyCarNStatus},e.prototype._status_init=function(e){t.prototype._status_init.call(this,e),this.s.sprite="enemy_n_png",this._anim_drop=new Anim_Drop(this,this.s,1,new Anim_Drop_Param),this._anim_drop.init(),this._dropping=!1},Object.defineProperty(e.prototype,"health_type",{set:function(t){this.s.health_type=t},enumerable:!0,configurable:!0}),e.prototype._regenerate_pos=function(t){this.s.pos.x=this._pos_x();var e=game_param.numerical.enemy_numerous.born_y_dispersion;if(e>0){var i=Math.round(ns_sirius.random_region(-e,e));this.s.pos.y+=i}},e.prototype._giveback_entity=function(){gp_core.factory.enemy_n.giveback(this)},e.prototype._update_position=function(){this._dropping||t.prototype._update_position.call(this)},e.prototype.pool_status_goto_idle=function(){t.prototype.pool_status_goto_idle.call(this),this._anim_drop.anim_deactive()},e.prototype.pool_status_goto_busy=function(){t.prototype.pool_status_goto_busy.call(this),this._anim_drop.anim_active()},e.prototype.reborn_from_column=function(e){t.prototype.reborn_from_column.call(this,e);var i=game_param.numerical.enemy_numerous.drop_area_len,r=this._anim_drop.get_param();r.from=this.s.pos.y,r.to=r.from+i,this._anim_drop.start(),this._dropping=!0},e.prototype.single_anim_comp=function(t){this._dropping=!1},e}(EnemyCar);__reflect(EnemyCarN.prototype,"EnemyCarN",["ns_sirius.Isingle_animation_listener"]);var ARE_PropertyType;!function(t){t[t["null"]=0]="null",t[t["boolean"]=1]="boolean",t[t.integer=2]="integer",t[t["float"]=3]="float",t[t.string=4]="string",t[t.array=5]="array",t[t.object=6]="object"}(ARE_PropertyType||(ARE_PropertyType={}));var ARE_PropertyPostPolicy;!function(t){t[t.no_same=0]="no_same",t[t.always=1]="always"}(ARE_PropertyPostPolicy||(ARE_PropertyPostPolicy={}));var ARE_MD=function(){function t(){}return t}();__reflect(ARE_MD.prototype,"ARE_MD");var AutomaticReflectEntityProperty=function(t){function e(){return null!==t&&t.apply(this,arguments)||this
}return __extends(e,t),e.prototype.init_by_md=function(t){this.p_name=t.p_name,this.json_path=t.json_path,this.p_type=t.p_type,this.p_value=null,void 0===t.post_policy?this.post_policy=ARE_PropertyPostPolicy.no_same:this.post_policy=t.post_policy,this.set_default_value(this.p_type)},e.prototype.reflect_from_json=function(t){var e=this._reflect_json_value(this.json_path,t);void 0!==e&&this.change_value_directly(e)},e.prototype.change_value_directly=function(t){var e=this.p_value;this.set_property(this.p_type,t),this.post_policy==ARE_PropertyPostPolicy.no_same?e!=this.p_value&&this._post_property_changed():this._post_property_changed()},e.prototype._post_property_changed=function(){var t=this.p_name+"Changed";sirius.nfc.post(t)},e.prototype.set_property=function(t,e){switch(t){case ARE_PropertyType["null"]:this.p_value=null;break;case ARE_PropertyType["boolean"]:"boolean"==typeof e?this.p_value=e:"string"==typeof e?this.p_value="true"===e?!0:!1:"number"==typeof e?this.p_value=1===e:this.p_value=!1;break;case ARE_PropertyType.string:this.p_value=e;break;case ARE_PropertyType.integer:this.p_value=parseInt(e);break;case ARE_PropertyType["float"]:this.p_value=parseFloat(e);break;case ARE_PropertyType.array:this.p_value=e;break;case ARE_PropertyType.object:this.p_value=e}},e.prototype.set_default_value=function(t){switch(t){case ARE_PropertyType["null"]:this.p_value=null;break;case ARE_PropertyType["boolean"]:this.p_value=!1;break;case ARE_PropertyType.string:this.p_value="";break;case ARE_PropertyType.integer:this.p_value=0;break;case ARE_PropertyType["float"]:this.p_value=0;break;case ARE_PropertyType.array:this.p_value=null;break;case ARE_PropertyType.object:this.p_value=null}},e.prototype._reflect_json_value=function(t,e){for(var i=e,r=0;r<t.length;r++){var n=t[r],o=i[n];if(void 0===o||null===o)return;if(r===this.json_path.length-1)return o;i=o}},e}(ARE_MD);__reflect(AutomaticReflectEntityProperty.prototype,"AutomaticReflectEntityProperty");var ns_sirius;!function(t){var e=function(){function t(){this._generate_pps()}return t.prototype.destroy=function(){console.log("ENTITY : [ "+this.constructor.name+" ] destroy"),this._pps=null,this._deconstructor()},t.prototype._deconstructor=function(){},t.prototype._generate_pps=function(){var t=this,e=this._get_md();if(!e||0==e.length)return void sirius.log.throw_error("应当定义属性列表");this._pps=new Array;for(var i=function(i){var n=new AutomaticReflectEntityProperty;r._pps.push(n),n.init_by_md(e[i]),r._property_inited(n);var o=n.p_name;Object.defineProperty(t,o,{get:function(){return t._pps[i].p_value},set:function(e){var r=t._pre_modification(t._pps[i],e);e=void 0===r?e:r,t._pps[i].change_value_directly(e),t._post_modification(t._pps[i],e)}})},r=this,n=0;n<e.length;n++)i(n)},t.prototype.update_automatic_pps=function(t){if(null!=t&&void 0!=t)for(var e=0;e<this._pps.length;e++)this._pps[e].reflect_from_json(t)},t.prototype._property_inited=function(t){},t.prototype._pre_modification=function(t,e){},t.prototype._post_modification=function(t,e){},t.prototype.serialization=function(){for(var t={},e=this._pps.length,i=0;e>i;i++){var r=this._pps[i];t[r.p_name]=r.p_value}return JSON.stringify(t)},t}();t.AutomaticReflectEntity=e,__reflect(e.prototype,"ns_sirius.AutomaticReflectEntity")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.mark_as_fullfill(),e.touchEnabled=!1,e.touchChildren=!0,e.touchThrough=!0,e}return __extends(e,t),e}(t.sirius_view_base);t.sirius_root_layer=e,__reflect(e.prototype,"ns_sirius.sirius_root_layer");var i=function(i){function r(){return i.call(this)||this}return __extends(r,i),r.prototype.view_hierarchy_establish=function(e){this._app_root_view=e;var i=t.app_layer_def,r=i.length;this.sms=new Array(r);for(var n=0;r>n;n++){var o=i[n],_=this._create_layer_by_def(o);this.sms[n]=_}},r.prototype._create_layer_by_def=function(i){var r=new e;this._app_root_view.addChild(r),r.update_visible(!1),i.disable_touch&&(r.touchEnabled=!1);var n=null;return n=i.exclusive?new t.layer_exclusive_manager:1==i.sm_type?new t.layer_module_sm:new t.layer_view_sm,n.manager_init(r,i.lid,this._sirius),n},r}(t.sirius_element_module);t.layer_partition=i,__reflect(i.prototype,"ns_sirius.layer_partition")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._is_visible=!1,e}return __extends(e,t),e.prototype.manager_init=function(t,e,i){this._root_view=t,this.layer_id=e,this._sirius=i},e.prototype.get_root_view=function(){return this._root_view},e.prototype.attach_target_view=function(t){this._target_view=t},e.prototype.show=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=null),this._is_visible=!0,this._root_view.addChild(this._target_view),this._target_view.attached_to_display_tree(t),this._update_container_visible(),this._target_view},e.prototype.hide=function(){this._is_visible=!1,this._target_view&&(this._target_view.detaching_from_display_tree(),this._target_view.remove_from_parent()),this._update_container_visible()},e.prototype.clear_all=function(){this.hide()},e.prototype._update_container_visible=function(){this._root_view.update_visible(this._is_visible)},e}(t.sirius_base_object);t.layer_exclusive_manager=e,__reflect(e.prototype,"ns_sirius.layer_exclusive_manager",["ns_sirius.Isirius_layer_manager"])}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._destroy_module=function(t){var e=t.pair_view;e.detaching_from_display_tree(),e.destroy(),t.destroy()},e.prototype.show_module=function(t,e,i,r,n){return void 0===i&&(i=null),void 0===r&&(r=null),void 0===n&&(n=null),this._root_view.addChild(t),t.attached_to_display_tree(i),e.vm_pre_init(r,t,this._sirius),t.view_pre_init(i,e,this._sirius),t.view_init(),e.vm_init(),this._s_push(e),this._update_container_visible(),t},e.prototype.clear_all=function(){if(!this._s_is_empty()){for(var t=0;t<=this._top;t++){var e=this._mstack[t];this._destroy_module(e)}this._s_clear(),this._update_container_visible()}},e.prototype.pop_top=function(){return this._s_is_empty()?void console.log("模块栈已经为空了"):(this._destroy_module(this._s_top()),this._s_pop(),this._update_container_visible(),void this._post_top_module_update())},e.prototype.shift_first=function(){return this._s_is_empty()?void console.log("模块栈已经为空了"):(this._destroy_module(this._s_bottom()),this._s_shift(),void this._update_container_visible())},e.prototype.remove_module=function(t){var e=this._mstack.indexOf(t);return 0>e?void this._sirius.sirius_public.log.throw_error("尝试移除不存在的模块"):(this._destroy_module(t),this._s_remove(e),this._update_container_visible(),void this._post_top_module_update())},e.prototype.is_empty=function(){return this._s_is_empty()},e.prototype.bring_view_to_top=function(t){var e=this._root_view.getChildIndex(t);0>e||this._root_view.addChild(t)},e.prototype.remove_module_by_key=function(t){var e=this._find_module_by_key(t);e&&this.remove_module(e)},e.prototype._find_module_by_key=function(t){if(this._s_is_empty())return null;for(var e=0;e<=this._top;e++){var i=this._mstack[e];if(i.mkey===t)return i}return null},e.prototype.top_module=function(){return this._mstack[this._top]},e.prototype.module_count=function(){return this._top+1},e.prototype._post_top_module_update=function(){if(!this._s_is_empty()){var t=this.top_module();t.update_when_hierarchy_changed&&t.update_when_hierarchy_changed()}},e}(t.layer_stack_manager);t.layer_module_sm=e,__reflect(e.prototype,"ns_sirius.layer_module_sm")}(ns_sirius||(ns_sirius={}));var EnemyCarNStatus=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._health_type=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"health_type",{set:function(t){this._health_type=t},enumerable:!0,configurable:!0}),e.prototype._reset_health=function(){var t=0;0===this._health_type?t=rand_region.rand_in_game(game_param.numerical.health.enemy_2_base,game_param.numerical.health.enemy_2_dispersion,game_param.numerical.health.enemy_2_progress_coe):1===this._health_type&&(t=rand_region.rand_in_game(game_param.numerical.health.enemy_3_base,game_param.numerical.health.enemy_3_dispersion,game_param.numerical.health.enemy_3_progress_coe)),this.health_total=this.health=t},e}(EnemyEntityStatus);__reflect(EnemyCarNStatus.prototype,"EnemyCarNStatus");var ns_sirius;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype._destroy_view=function(t){t.detaching_from_display_tree(null),t.destroy()},i.prototype.show_view=function(e,i,r){return void 0===i&&(i=null),void 0===r&&(r=null),this._root_view.addChild(e),e instanceof t.sirius_view_base?e.attached_to_display_tree(i):(e.view_pre_init(i,null,this._sirius),e.view_init()),this._s_push(e),this._update_container_visible(),e},i.prototype.clear_all=function(){if(!this._s_is_empty()){for(var t=0;t<=this._top;t++){var e=this._mstack[t];this._destroy_view(e)}this._s_clear(),this._update_container_visible()}},i.prototype.pop_top=function(){return this._s_is_empty()?void console.log("视图栈已经为空了"):(this._destroy_view(this._s_top()),this._s_pop(),void this._update_container_visible())},i.prototype.shift_first=function(){return this._s_is_empty()?void console.log("视图栈已经为空了"):(this._destroy_view(this._s_bottom()),this._s_shift(),void this._update_container_visible())},i.prototype.remove_view=function(t){var e=this._mstack.indexOf(t);return 0>e?void this._sirius.sirius_public.log.throw_error("尝试移除不存在的视图"):(this._destroy_view(t),this._s_remove(e),void this._update_container_visible())},i.prototype.is_empty=function(){return this._s_is_empty()},i.prototype.bring_view_to_top=function(t){var e=this._root_view.getChildIndex(t);0>e||this._root_view.addChild(t)},i}(t.layer_stack_manager);t.layer_view_sm=e,__reflect(e.prototype,"ns_sirius.layer_view_sm")}(ns_sirius||(ns_sirius={}));var ECWE_Status=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.reset_static_values=function(){this.sprite="car_w_emitter_png",this.move_speed_offset=rand_region.rand_in_game(game_param.numerical.enemy_with_bullet.speed_offset,0,game_param.numerical.enemy_with_bullet.speed_offset_progress_coe)},e.prototype._reset_health=function(){var t=0;t=rand_region.rand_in_game(game_param.numerical.enemy_with_bullet.health_base,game_param.numerical.enemy_with_bullet.health_dispersion,game_param.numerical.enemy_with_bullet.health_progress_coe),this.health_total=this.health=t},e}(EnemyEntityStatus);__reflect(ECWE_Status.prototype,"ECWE_Status");var egret_view_no_touch=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!0,e.touchThrough=!0,e}return __extends(e,t),e}(eui.Group);__reflect(egret_view_no_touch.prototype,"egret_view_no_touch");var EnemyCarWithEmitter=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._create_status=function(){return new ECWE_Status},e.prototype.actor_init=function(e,i){t.prototype.actor_init.call(this,e,i),this._emit_pos=new egret.Point,this._emitter=new EnemyBulletEmitter,this._emitter.emitter_init(this),this._update_position_info()},e.prototype._regenerate_pos=function(t){this.s.pos.x=this._pos_x();var e=game_param.numerical.enemy_with_bullet.born_y_dispersion;if(e>0){var i=Math.round(ns_sirius.random_region(-e,e));this.s.pos.y+=i}},e.prototype.frame_update=function(){t.prototype.frame_update.call(this),this._emitter.frame_update()},e.prototype._update_position=function(){var t=gp_core.inter_status.world_speed+this.s.move_speed_offset;this.s.pos.y+=t},e.prototype._update_position_info=function(){t.prototype._update_position_info.call(this),this._emit_pos.x=this.s.pos.x,this._emit_pos.y=this.s.pos.y+game_config.enemy_hh},e.prototype.pool_status_goto_idle=function(){t.prototype.pool_status_goto_idle.call(this),this._emitter.bullet_pool.pool_reset(),gp_core.scene_info.occupy_lane(this.column_index,LaneOccupyingStatus.idle),this._column_index=-1},e.prototype.pool_status_goto_busy=function(){t.prototype.pool_status_goto_busy.call(this)},e.prototype._giveback_entity=function(){gp_core.factory.enemy_with_emitter.giveback(this)},e.prototype.reborn_from_column=function(e){t.prototype.reborn_from_column.call(this,e),gp_core.scene_info.occupy_lane(e,LaneOccupyingStatus.enemy_with_bullet)},e}(EnemyCar);__reflect(EnemyCarWithEmitter.prototype,"EnemyCarWithEmitter");var PlayerEntity=function(t){function e(){var e=t.call(this)||this;return e._motion_sm=new PlayerMotionSM,e}return __extends(e,t),e.prototype._create_status=function(){return new PlayerEntityStatus},e.prototype._create_view=function(){return gp_core.playground.create_player_STATIC()},e.prototype.actor_init=function(e,i){t.prototype.actor_init.call(this,e,i);var r=this.view.display;this._motion_sm.attach_view(r),this._emit_pos=new egret.Point,this._emitter=new BulletEmitter,this._emitter.emitter_init(this),this._syn_player_pos(),this.view.visible=!0},e.prototype.frame_update=function(){this._syn_player_pos();var t=this._judge_contract_enemy();if(t)return t.prepare_to_die(),void this.receive_dmg(1);var e=this._judge_contract_enemy_we();if(e)return e.prepare_to_die(),void this.receive_dmg(1);var i=this._judge_contract_enemy_n();if(i)return i.prepare_to_die(),void this.receive_dmg(1);var r=this._judge_contract_block();return r?void gp_core.game_over():(this._emitter.frame_update(),void this._motion_sm.frame_update())},e.prototype._syn_player_pos=function(){var t=gp_core.ih.player_pos;this.s.pos.copyFrom(t),this.s.cal_rect(),this._syn_pos(),this._emit_pos.x=t.x,this._emit_pos.y=t.y-game_config.player_hh},e.prototype.receive_dmg=function(t){this.s.health-=t,this.view.syn_health(this.s.health),this.view.start_vibration_anim(),this.s.health<=0&&gp_core.game_over()},e.prototype.prepare_to_die=function(){this.s.health=0,gp_core.game_over()},e.prototype._judge_contract_enemy=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.enemy.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},e.prototype._judge_contract_enemy_we=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.enemy_with_emitter.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},e.prototype._judge_contract_enemy_n=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.enemy_n.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},e.prototype._judge_contract_block=function(){if(this.is_destroyed)return null;for(var t=gp_core.factory.barrier.pool_arr(),e=0;e<t.length;e++){var i=t[e];if(!ns_sirius.pool_data(i).is_free){var r=i.s.rec;if(this.s.rec.intersects(r))return i}}return null},e}(ActorEntity);__reflect(PlayerEntity.prototype,"PlayerEntity");var egret_comps;!function(t){var e=function(){function t(){this.scale_x=1,this.scale_y=1,this.scale=1}return t}();t.sync_mc_display_param=e,__reflect(e.prototype,"egret_comps.sync_mc_display_param");var i=function(t){function e(){var e=t.call(this)||this;return e._complete_callback=null,e}return __extends(e,t),e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this._mc&&this.removeChild(this._mc),this._mc_data=null,this._mc_texture=null,this._param=null},e.prototype.load=function(t,e,i){this._mc_data=RES.getRes(t),this._mc_texture=RES.getRes(e),this._param=i,this._create_mc()},e.prototype.play=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=1),this.visible=!0,this._complete_callback=t,this._mc.gotoAndPlay(e,i)},e.prototype._create_mc=function(){var t=this,e=new egret.MovieClipDataFactory(this._mc_data,this._mc_texture),i=new egret.MovieClip(e.generateMovieClipData("car_explosion"));this.addChild(i),i.scaleX=this._param.scale,i.scaleY=this._param.scale,this._mc=i,this.visible=!1,i.addEventListener(egret.Event.COMPLETE,function(e){t._complete_callback&&t._complete_callback(),t.visible=!1},this)},e}(egret.DisplayObjectContainer);t.sync_mc_display=i,__reflect(i.prototype,"egret_comps.sync_mc_display",["ns_sirius.Ipool_obj","ns_sirius.Isirius_base_object"])}(egret_comps||(egret_comps={}));var awt_network;!function(t){function e(t){var e="";switch(t){case 16:e="Your account is logged in elsewhere.";break;case 25:e="Cannot enter this level."}return e}function i(t){var e=!1;switch(t){case 16:e=!0}return e}t.error_str=e,t.is_fundamental=i}(awt_network||(awt_network={}));var ns_sirius;!function(t){var e=function(){function t(){}return t}();t.sirius_network_consts=e,__reflect(e.prototype,"ns_sirius.sirius_network_consts"),t.sirius_network_consts_debug={protocol:"http",host_address:"47.102.112.216:7002/game"},t.sirius_network_consts_release={protocol:"https",host_address:"awtserver.plusfuns.com/game"}}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(){this.parse_json=!0,this.disable_loading=!1,this.disable_user_update=!1}return t.prototype.copy_param=function(t){void 0!=t.parse_json&&(this.parse_json=t.parse_json),void 0!=t.disable_loading&&(this.disable_loading=t.disable_loading),void 0!=t.disable_user_update&&(this.disable_user_update=t.disable_user_update)},t}();t.common_req_param=e,__reflect(e.prototype,"ns_sirius.common_req_param");var i=function(i){function r(t){void 0===t&&(t=null);var r=i.call(this)||this;return r._req_param=null,r._req_param=new e,r._weak_context=null,r._cb_s=null,r._cb_f=null,t&&r._req_param.copy_param(t),r}return __extends(r,i),r.prototype._before_destroy=function(){this._weak_context=null,this._req_param=null,this._cb_s=null,this._cb_f=null},r.prototype._display_server_error=function(t){if(!(void 0===t||null===t||isNaN(t)||0>=t)){var e=awt_network.error_str(t);if(e){var i=awt_network.is_fundamental(t);sirius.view_manager.show_alert_d(e,null,null,{hide_confirm:i})}}},r.prototype._handle_error_code=function(t){this._display_server_error(t),this._callback_internal(this._cb_f,t),this.destroy()},r.prototype._handle_fail=function(t){this._callback_internal(this._cb_f,t),this.destroy()},r.prototype._handle_success=function(t){this._update_global_update(t),this._callback_internal(this._cb_s,t),this.destroy()},r.prototype._update_global_update=function(t){!this._req_param.disable_user_update,this._validate_map_info(t)},r.prototype._validate_map_info=function(t){t&&t.v&&!t.v.info},r.prototype.generate_expire=function(){this._expire_dis=new t.DelayDispatcher,this._expire_dis.dispatch(2e4,this,this.handle_req_expired)},r.prototype.handle_req_expired=function(){this._disable_loading(),this._handle_fail("expire")},r.prototype.clear_expire=function(){this._expire_dis&&(this._expire_dis.destroy(),this._expire_dis=null)},r.prototype._combine_url=function(e){var i=null;i=release_config.for_release?t.sirius_network_consts_release:t.sirius_network_consts_debug;var r=i.protocol+"://"+i.host_address+"/"+e;return r},r.prototype.post_fullurl=function(t,e){return void 0===e&&(e=void 0),__awaiter(this,void 0,void 0,function(){var i,r=this;return __generator(this,function(n){return t?(i=JSON.stringify(e),this._url_str=t,[2,new Promise(function(t,e){r._cb_s=t,r._cb_f=e,r._send_post(r._url_str,i)})]):[2,new Promise(function(t,e){e("url_error")})]})})},r.prototype.post=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=null),__awaiter(this,void 0,void 0,function(){var r,n=this;return __generator(this,function(o){return t?(this._weak_context=i,r=JSON.stringify(e),this._url_str=this._combine_url(t),this._url_relative=t,[2,new Promise(function(t,e){n._cb_s=t,n._cb_f=e,n._send_post(n._url_str,r)})]):[2,new Promise(function(t,e){e("url_error")})]})})},r.prototype._send_get=function(t){this.generate_expire();var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,this.comp,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.fail,this)},r.prototype._send_post=function(t,e){this._enable_loading(),this.generate_expire();var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(t,egret.HttpMethod.POST),i.setRequestHeader("Content-Type","application/json"),e?i.send(e):i.send(),i.addEventListener(egret.Event.COMPLETE,this.comp,this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,this.fail,this)},r.prototype.comp=function(t){if(this._disable_loading(),!this._is_destroyed){this.clear_expire();var e=(this._url_str,t.currentTarget),i=e.response;if(this._req_param.parse_json){var r=JSON.parse(i);if(r.m){var n=parseInt(r.m);this._handle_error_code(n)}else r.v?this._handle_success(r):this._handle_fail(r)}else this._handle_success(i)}},r.prototype.fail=function(t){if(this._disable_loading(),!this._is_destroyed){this.clear_expire();var e=t.currentTarget,i=e.response;this._handle_fail(i)}},r.prototype._callback_internal=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t)if(this._weak_context){if(this._weak_context._is_destroyed===!0)return;t.apply(void 0,e)}else t.apply(void 0,e)},r.prototype._enable_loading=function(){this._req_param&&this._req_param.disable_loading||sirius.view_manager.switch_global_loading(!0)},r.prototype._disable_loading=function(){this._req_param&&this._req_param.disable_loading||sirius.view_manager.switch_global_loading(!1)},r}(t.sirius_base_object);t.common_req=i,__reflect(i.prototype,"ns_sirius.common_req")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(){}return t.prototype.clear=function(){egret.localStorage.clear()},t.prototype.get_item=function(t,e){var i=egret.localStorage.getItem(t);return this._reflect(e,i)},t.prototype.set_item=function(t,e,i){var r=this._serialization(e,i);egret.localStorage.setItem(t,r)},t.prototype.delete_item=function(t){egret.localStorage.removeItem(t)},t.prototype._reflect=function(t,e){var i=null;switch(t){case sirius_internal_type["null"]:i=null;break;case sirius_internal_type["boolean"]:i="true"===e?!0:!1;break;case sirius_internal_type.string:i=e;break;case sirius_internal_type.integer:i=parseInt(e);break;case sirius_internal_type["float"]:i=parseFloat(e);break;case sirius_internal_type.array:i=JSON.parse(e);break;case sirius_internal_type.object:i=JSON.parse(e)}return i},t.prototype._serialization=function(t,e){var i=null;switch(t){case sirius_internal_type["null"]:i=null;break;case sirius_internal_type["boolean"]:i=e?"true":"false";break;case sirius_internal_type.string:i=e;break;case sirius_internal_type.integer:i=e+"";break;case sirius_internal_type["float"]:i=e+"";break;case sirius_internal_type.array:i=JSON.stringify(e);break;case sirius_internal_type.object:i=JSON.stringify(e)}return i},t}();t.sirius_web_serialization=e,__reflect(e.prototype,"ns_sirius.sirius_web_serialization",["ns_sirius.Iweb_serialization"])}(ns_sirius||(ns_sirius={}));var ns_sirius_egret;!function(t){var e=function(){function t(t){this.timer=t,this._is_destroyed=!1}return Object.defineProperty(t.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._is_destroyed=!0,ns_sirius.timer_clock.remove(this),this.timer=null},t.prototype.launch=function(){ns_sirius.timer_clock.add(this)},t.prototype.update=function(t){this.timer&&this.timer.update()},t}();__reflect(e.prototype,"JSTimerRealActuator",["ns_sirius.IAnimatable"]);var i=function(){function t(){this._is_destroyed=!1,this._actuator=new e(this),this._actuator.launch(),this._is_running=!1,this._is_paused=!1,this._end_interval=0}return Object.defineProperty(t.prototype,"is_running",{get:function(){return this._is_running},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"is_paused",{get:function(){return this._is_paused},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._actuator&&(this._actuator.destroy(),this._actuator=null),this._listener=null,this._is_destroyed=!0,this._user_param=null},t.prototype.timer_init_1=function(t,e,i,r){return void 0===r&&(r=null),this._listener=t,this._interval=e,this._interval<16&&(this._interval=16),this._end_interval=i,this._user_param=r,this},t.prototype._check_time_when_start=function(){return this._end_interval<=0?(this._is_running=!1,this._post_finish(1),!0):!1},t.prototype.start=function(t){return this._check_time_when_start()?this:(this._start_time=(new Date).getTime(),this._is_running=!0,this._is_paused=!1,this._t_generate(t),this)},t.prototype.stop=function(){this._is_running=!1,this._is_paused=!0,this._post_finish(2)},t.prototype.resume=function(t){return this._is_running?(this._is_paused=!1,void this._t_generate(t)):void console.log("timer 已经停止了")},t.prototype.pause=function(){return this._is_running?void(this._is_paused=!0):void console.log("timer 已经停止了")},t.prototype._t_generate=function(t){this._previous_time=(new Date).getTime(),t&&this.update()},t.prototype.update=function(){if(!this._is_destroyed&&this._is_running&&!this._is_paused){var t=16,e=(new Date).getTime(),i=e-this._previous_time,r=e-this._start_time;i>this._interval-t&&(this._previous_time=(new Date).getTime(),this._post_tick(r)),r>this._end_interval-t&&(this._is_running=!1,this._post_finish(1))}},t.prototype._post_tick=function(t){this._listener.on_timer_tick(t,this._user_param)},t.prototype._post_finish=function(t){this._listener.on_timer_finish(t,this._user_param)},t}();t.egret_timer_real_time=i,__reflect(i.prototype,"ns_sirius_egret.egret_timer_real_time")}(ns_sirius_egret||(ns_sirius_egret={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.mark_as_fullfill(),e.set_bg_color(0,.4),e}return __extends(e,t),e.prototype.start_anim=function(){},e.prototype.stop_anim=function(){},e}(t.sirius_view_base);t.sirius_default_loading_view=e,__reflect(e.prototype,"ns_sirius.sirius_default_loading_view")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(e){var i,r=t.call(this)||this;return i=e?r.set_bg_color(16646144,.4):r.set_bg_color(0,.4),i.ellipseWidth=40,i.ellipseHeight=40,r.left=20,r.right=20,r.height=40,r.verticalCenter=100,r._txt=new eui.Label,r.addChild(r._txt),r._txt.textColor=16777215,r._txt.left=10,r._txt.right=10,r._txt.size=26,r._txt.percentHeight=100,r._txt.textAlign=egret.HorizontalAlign.CENTER,r._txt.verticalAlign=egret.VerticalAlign.MIDDLE,r}return __extends(e,t),e.prototype.show=function(t){this._txt.text=t,egret.Tween.get(this).to({verticalCenter:0},2e3,egret.Ease.cubicOut).to({alpha:0},1e3,egret.Ease.cubicOut)},e}(t.sirius_view_base);t.popup_text_msg=e,__reflect(e.prototype,"ns_sirius.popup_text_msg")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){function e(t,e){for(var i=Object.keys(t),r=i.length,n=0;r>n;n++){var o=i[n],_=t[o],s=e(_);if(s===!0)break}}function i(t,e){for(var i=Object.keys(t),r=i.length,n=0;r>n;n++){var o=i[n],_=t[o],s=e(o,_);if(s===!0)break}}function r(t,e){var i=t.indexOf(e);0>i||t.splice(i,1)}function n(t,e){if(t>=e)return e;var i=Math.floor(Math.random()*(e-t))+t;return i}function o(t,e){var i=1e3*t,r=1e3*e,n=Math.floor(Math.random()*(r-i))+i;return n/=1e3}function _(t,e,i){return void 0===i&&(i=0),0===i?Math.round(n(t,e)):1===i?Math.floor(n(t,e)):2===i?Math.ceil(n(t,e)):void 0}t.loop_values=e,t.loop_pps=i,t.arr_robj=r,t.random_region=n,t.random_region_float=o,t.random_region_int=_}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.width=t,this.height=e}return t.prototype.copy_from=function(t){this.width=t.width,this.height=t.height},t}();t.Size=e,__reflect(e.prototype,"ns_sirius.Size")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),Object.defineProperty(i.prototype,"fs_cover_sm",{get:function(){return this._fs_cover_sm},enumerable:!0,configurable:!0}),i.prototype.view_hierarchy_establish=function(e){this._sirius.layes.view_hierarchy_establish(e),this._module_sm_1=this._sirius.layes.sms[0],this._module_sm_2=this._sirius.layes.sms[1],this._global_anim_sm=this._sirius.layes.sms[2],this._alert_sm=this._sirius.layes.sms[3],this._fs_cover_sm=this._sirius.layes.sms[4],this._message_sm=this._sirius.layes.sms[5],this._loading_sm=this._sirius.layes.sms[6],this._global_loading_view=new t.mwn_loading_view,this._loading_sm.attach_target_view(this._global_loading_view),this._sirius.mm.register_sm(this._module_sm_1,this._module_sm_2)},i.prototype.module_manual_destroy=function(t){var e=t.pair_view;e.detaching_from_display_tree(),e.destroy(),t.destroy()},i.prototype.module_manual_init=function(t,e,i,r){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this._sirius.mm.module_manual_init(t,e,i,r)},i.prototype.show_module=function(t,e,i,r,n){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=0),void 0===n&&(n=null),this._sirius.mm.show_module(t,e,i,r,n)},i.prototype.remove_all_modules=function(t){void 0===t&&(t=0),this._sirius.mm.remove_all_modules(t)},i.prototype.remove_module=function(t,e){void 0===e&&(e=0),this._sirius.mm.remove_module(t,e)},i.prototype.remove_module_by_key=function(t,e){void 0===e&&(e=0),this._sirius.mm.remove_module_by_key(t,e)},i.prototype.pop_top_module=function(t){void 0===t&&(t=0),this._sirius.mm.pop_top_module(t)},i.prototype.module_count=function(t){return void 0===t&&(t=0),this._sirius.mm.module_count(t)},i.prototype.get_top_module=function(t){return void 0===t&&(t=0),this._sirius.mm.get_top_module(t)},i.prototype.show_fsv=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this._fs_cover_sm.show_view(t,e,i)},i.prototype.clear_fsv=function(){this._fs_cover_sm.clear_all()},i.prototype.remove_fsv=function(t){this._fs_cover_sm.remove_view(t)},i.prototype.switch_global_loading=function(t){this._global_loading_view&&(t?(this._loading_sm.show(),this._global_loading_view.start_anim()):(this._global_loading_view.stop_anim(),this._loading_sm.hide()))},i.prototype.show_popup_text_msg=function(t){release_config.for_release||this.show_popup_text_msg_release(t,!0)},i.prototype.show_popup_text_msg_release=function(e,i){var r=this;void 0===i&&(i=!1);var n=!1;release_config.for_release||(n=i?!0:!1);var o=new t.popup_text_msg(n);this._message_sm.show_view(o),o.show(e),setTimeout(function(){r._message_sm.shift_first()},3500)},i.prototype.show_anim_view=function(t){this._global_anim_sm.clear_all(),this._global_anim_sm.attach_target_view(t),this._global_anim_sm.show()},i.prototype.clear_anim_view=function(){this._global_anim_sm.clear_all()},i.prototype.show_alert=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this._alert_sm.show_view(t,e,i)},i.prototype.clear_alert=function(){this._alert_sm.clear_all()},i.prototype.show_alert_d=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.show_alert((new default_alert_view).show(t,e,i,r),r)},i.prototype.show_network_fail_alert=function(t){this.show_alert((new default_alert_view).show("network_fail",t,null,null),null)},i.prototype.show_network_fail_alert_cancel=function(t,e){this.show_alert((new default_alert_view).show("network_fail",t,e,null),null)},i}(t.sirius_element_module);t.app_vh_manager=e,__reflect(e.prototype,"ns_sirius.app_vh_manager")}(ns_sirius||(ns_sirius={}));var AppReleaseConfig=function(){function t(){this.for_release=!0}return t}();__reflect(AppReleaseConfig.prototype,"AppReleaseConfig");var default_confirm_btn=function(t){function e(){var e=t.call(this)||this,i=new eui.Image;i.percentWidth=100,i.percentHeight=100,i.verticalCenter=0,i.horizontalCenter=0,i.source="Button_Red_png",e.addChild(i);var r=new eui.Label;return r.verticalCenter=0,r.horizontalCenter=0,r.size=18,r.textColor=16777215,r.textAlign=egret.HorizontalAlign.CENTER,r.verticalAlign=egret.VerticalAlign.MIDDLE,r.text="confirm",e.addChild(r),e.lbl=r,e
}return __extends(e,t),e.prototype.change_txt=function(t){this.lbl.text=t},e}(eui.Group);__reflect(default_confirm_btn.prototype,"default_confirm_btn");var default_cancel_btn=function(t){function e(){var e=t.call(this)||this,i=new eui.Image;i.percentWidth=100,i.percentHeight=100,i.verticalCenter=0,i.horizontalCenter=0,i.source="Button_Ochre_png",e.addChild(i);var r=new eui.Label;return r.verticalCenter=0,r.horizontalCenter=0,r.size=18,r.textColor=16777215,r.textAlign=egret.HorizontalAlign.CENTER,r.verticalAlign=egret.VerticalAlign.MIDDLE,r.text="cancel",e.addChild(r),e}return __extends(e,t),e}(eui.Group);__reflect(default_cancel_btn.prototype,"default_cancel_btn");var default_alert_view=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e._init(),e}return __extends(e,t),e.prototype._view_before_destroy=function(){this._cancel_callback=null,this._confirm_callback=null},e.prototype._init=function(){this._cont_container=new eui.Group,this._cont_container.width=610,this.addChild(this._cont_container),this._cont_container.minHeight=262,this._cont_container.horizontalCenter=0,this._cont_container.verticalCenter=0;var t=new eui.Image;this._cont_container.addChild(t),t.percentWidth=100,t.percentHeight=100,t.horizontalCenter=0,t.verticalCenter=0,t.scale9Grid=new egret.Rectangle(90,90,30,30),t.source="Common_Panel_Comfirm_png";var e=new eui.Image;this._cont_container.addChild(e),e.width=194,e.height=11,e.horizontalCenter=0,e.top=25,e.source="Common_Pic_Line_01_png",this._info=new eui.Label,this._info.width=440,this._info.horizontalCenter=0,this._info.top=75,this._info.size=18,this._info.textColor=7755857,this._info.textAlign=egret.HorizontalAlign.CENTER,this._cont_container.addChild(this._info);var i=new default_confirm_btn;this._btn_confirm=i,i.width=184,i.height=42,i.bottom=30,i.horizontalCenter=0,this._cont_container.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this._handle_confirm,this)},e.prototype._update_confirm_and_cancel_btn=function(){if(this._cancel_callback){this._btn_confirm.horizontalCenter=120;var t=new default_cancel_btn;this._btn_cancel=t,t.width=184,t.height=42,t.bottom=30,t.horizontalCenter=-120,this._cont_container.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this._handle_cancel,this)}},e.prototype._handle_cancel=function(){this._cancel_callback&&this._cancel_callback(),sirius.view_manager.clear_alert()},e.prototype._handle_confirm=function(){this._confirm_callback&&this._confirm_callback(),sirius.view_manager.clear_alert()},e.prototype.show=function(t,e,i,r){return void 0===r&&(r=null),this._confirm_callback=e,this._cancel_callback=i,this._update_confirm_and_cancel_btn(),r&&r.hide_confirm&&(this._btn_confirm.visible=!1),r&&1==r.align&&(this._info.textAlign=egret.HorizontalAlign.LEFT),this._info.text=t,this._cal_height(),this},e.prototype._cal_height=function(){var t=this;setTimeout(function(){t._cont_container.height=t._info.height+210},0)},e}(ns_sirius.sirius_view_base);__reflect(default_alert_view.prototype,"default_alert_view");var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.mark_as_fullfill(),e.set_bg_color(0,.4);var i=new eui.Rect;return e.addChild(i),i.fillColor=16777215*Math.random(),i.percentWidth=60,i.percentHeight=60,e}return __extends(e,t),e.prototype.start_anim=function(){this.visible=!0},e.prototype.stop_anim=function(){this.visible=!1},e}(t.sirius_view_base);t.mwn_loading_view=e,__reflect(e.prototype,"ns_sirius.mwn_loading_view")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){t.app_layer_def=[{lid:"modules1",index:0,exclusive:!1,sm_type:1},{lid:"modules2",index:1,exclusive:!1,sm_type:1},{lid:"global_anim",index:2,exclusive:!0},{lid:"alert_panel",index:3,exclusive:!1,sm_type:0},{lid:"fullscreen_cover",index:4,exclusive:!1,sm_type:0},{lid:"messages",index:5,exclusive:!1,sm_type:0,disable_touch:!0},{lid:"loading",index:6,exclusive:!0}]}(ns_sirius||(ns_sirius={}));var PlayerEntityStatus=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.sinit=function(e){t.prototype.sinit.call(this,e);var i=game_param.internal.coefficient.player_collide_coin_coe;this.coin_collide_half_size=new ns_sirius.Size(this.half_size.width*i,this.half_size.height*i),this.coin_collide_rect=new egret.Rectangle,this.coin_collide_rect.width=this.size.width*i,this.coin_collide_rect.height=this.size.height*i},e.prototype.cal_rect=function(){t.prototype.cal_rect.call(this),this.coin_collide_rect.x=this.pos.x-this.coin_collide_half_size.width,this.coin_collide_rect.y=this.pos.y-this.coin_collide_half_size.height},e.prototype.reset_static_values=function(){this.sprite=Math.random()>.5?"car_11_png":"car_5_png"},e.prototype.reset_dynamic_values=function(){this.health=game_param.internal.health.player_health},e}(ActorEntityStatus);__reflect(PlayerEntityStatus.prototype,"PlayerEntityStatus");var player_motion_status;!function(t){t[t.still=0]="still",t[t.left=1]="left",t[t.right=2]="right"}(player_motion_status||(player_motion_status={}));var PlayerMotionSM=function(t){function e(){var e=t.call(this)||this;return e._anim_count=15,e._cur_t=0,e._anim_cursor=-1,e._cur_state=player_motion_status.still,e}return __extends(e,t),e.prototype.change_state=function(t){if(game_param.internal.sensitivity.player_head_rotation<=0)return this._cur_t=0,void(this._anim_cursor=-1);var e=t;if(this._cur_state!==e){this._cur_state=e;var i=game_param.internal.sensitivity.player_head_rotation;i>30&&(i=30),e===player_motion_status.left?(this._target_t=-i,this._anim_count=5):e===player_motion_status.right?(this._target_t=i,this._anim_count=5):(this._target_t=0,this._anim_count=20),this._anim_cursor=0,this._start_t=this._cur_t}},e.prototype.attach_view=function(t){this._focus_view=t},e.prototype.frame_update=function(){this._focus_view&&(this._anim_t(),this._focus_view.rotation=this._cur_t)},e.prototype._anim_t=function(){if(!(this._anim_cursor<0)){if(this._anim_cursor>=this._anim_count)return this._cur_t=this._target_t,void(this._anim_cursor=-1);var t=this._anim_cursor/this._anim_count;this._cur_t=(this._target_t-this._start_t)*t+this._start_t,this._anim_cursor++}},e}(ns_sirius.sirius_base_object);__reflect(PlayerMotionSM.prototype,"PlayerMotionSM");var lk_rtable=[{module_name:"Test",view:TestModuleView,vm:TestModuleVM}],CoinAnim=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._after_init=function(){this._rect=new egret.Rectangle,this._rect.width=2*game_config.coin_radius,this._rect.height=2*game_config.coin_radius},e.prototype.start=function(e){t.prototype.start.call(this,e);var i=this._param.speed_vector.x;0===i?this._x_flag=0:0>i?this._x_flag=1:this._x_flag=2,this._x_magnitude=Math.abs(this._param.speed_vector.x)/1e3,this._syn_view_pos()},e.prototype._before_update=function(t){this._cur_pos.y>=game_config.dead_line_bottom&&this._giveback_anim()},e.prototype._giveback_anim=function(){game_view.core.coin_layer.giveback(this._target_view)},e.prototype._update_position=function(e){t.prototype._update_position.call(this,e),1===this._x_flag?this._cur_pos.x-=this._x_magnitude*e:2===this._x_flag&&(this._cur_pos.x+=this._x_magnitude*e);var i=0;this._cur_pos.x<i&&(this._cur_pos.x=i,this._x_flag=2),this._cur_pos.x>game_config.playground_w-i&&(this._cur_pos.x=game_config.playground_w-i,this._x_flag=1),this._judge_collide_player()},e.prototype._judge_collide_player=function(){this._rect.x=this._cur_pos.x-game_config.coin_radius,this._rect.y=this._cur_pos.y-game_config.coin_radius;var t=gp_core.player.s.coin_collide_rect;t.intersects(this._rect)&&(gp_core.inter_status.coin_increase(1),this._giveback_anim())},e.prototype._anim_update=function(t){this._syn_view_pos(),this._target_view.rotation+=3},e.prototype._reset_anim_properties=function(){},e}(ns_sirius.anim_gravity);__reflect(CoinAnim.prototype,"CoinAnim");var CoinAnimView=function(t){function e(){var e=t.call(this)||this,i=new egret.Bitmap;return e.addChild(i),i.texture=RES.getRes("coin_png"),i.x=.5*-i.width,i.y=.5*-i.height,e._anim=new CoinAnim(e,e).init(),e.visible=!1,e}return __extends(e,t),e.prototype.start_anim=function(t){this._anim.start(t),this.visible=!0},e.prototype.pool_status_goto_idle=function(){this._anim.stop(),this.visible=!1},e.prototype.pool_status_goto_busy=function(){},e.prototype.anim_gravity_comp=function(t){},e}(ns_sirius.sirius_game_view_base);__reflect(CoinAnimView.prototype,"CoinAnimView",["ns_sirius.Ianim_anim_gravity_listener"]);var ns_sirius;!function(t){var e=function(){function t(t){void 0===t&&(t=0),this._node_type=0,this._node_type=t}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},set:function(t){this._element=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pre",{get:function(){return this._pre},set:function(t){this._pre=t},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){1==this._node_type||2==this._node_type,this._element=null,this._next=null,this._pre=null},t.prototype.is_head=function(){return 1==this._node_type},t.prototype.is_tail=function(){return 2==this._node_type},t}();t.dll_node=e,__reflect(e.prototype,"ns_sirius.dll_node");var i=function(){function t(t){void 0===t&&(t=0),this.list_id=0,this.list_id=t,this._tail=new e(2),this._tail.next=null,this._tail.element=null,this._head=new e(1),this._head.pre=null,this._head.element=null,this._tail.pre=this._head,this._head.next=this._tail,this._length=0}return Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){for(var t=this._head,e=null;t&&!t.is_tail();)e=t.next,t.destroy(),t=e;this._head=null,this._tail=null,this._length=0},t.prototype.is_empty=function(){return this._head.next==this._tail},t.prototype.push=function(t){var i=new e;i.element=t,i.next=this._tail,i.pre=this._tail.pre,this._tail.pre.next=i,this._tail.pre=i,this._length++},t.prototype.pop=function(){if(!this.is_empty()){this._length--;var t=this._tail.pre,e=t.element;return t.pre.next=this._tail,this._tail.pre=t.pre,t.destroy(),t=null,e}},t.prototype.remove=function(t){if(!this.is_empty()){var e=this.find(t);if(e){this._length--;var i=e.pre,r=e.next;i.next=r,r.pre=i,e.destroy(),e=null}}},t.prototype.find=function(t){if(!t)return null;for(var e=this._head.next;e&&!e.is_tail();){if(e.element==t)return e;e=e.next}return null},t.prototype.find_element_by_property=function(t,e){if(!t)return null;for(var i=this._head.next;i&&!i.is_tail();){if(i.element[t]===e)return i.element;i=i.next}return null},t.prototype.get_head=function(){return this._head},t.prototype.get_tail=function(){return this._tail},t.prototype.loop_breakable=function(t){for(var e=this.get_head().next;e&&!e.is_tail();){var i=t(e.element);if(!i)break;e=e.next}},t.prototype.loop_node=function(t){for(var e=this.get_head().next;e&&!e.is_tail();)t(e),e=e.next},t.prototype.loop_element=function(t){for(var e=this.get_head().next;e&&!e.is_tail();)t(e.element),e=e.next},t.prototype.loop_element_by_property=function(t,e,i){if(!t)return null;for(var r=this._head.next;r&&!r.is_tail();)r.element[t]===e&&i(r.element),r=r.next;return null},t.prototype.remove_element_by_property=function(t,e){if(!t)return null;for(var i=this._head.next;i&&!i.is_tail();)if(i.element[t]===e){var r=i;r.pre.next=i.next,r.next.pre=i.pre,i=r.next,r.destroy(),r=null}else i=i.next;return null},t}();t.doubly_linked_list=i,__reflect(i.prototype,"ns_sirius.doubly_linked_list")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.ddid=0,e}return __extends(e,t),e.prototype._before_destroy=function(){this._target=null,this._fun=null,this._param=null},e.prototype.dispatch=function(t,e,i,r){var n=this;void 0===r&&(r=null),this._is_destroyed=!1,this._delay_time=t,this._target=e,this._fun=i,this._param=r,setTimeout(function(){n.execute_fun()},t)},e.prototype.execute_fun=function(){this._is_destroyed||(this._target&&this._fun&&this._fun.apply(this._target,[this._param]),this.destroy())},e}(t.sirius_base_object);t.DelayDispatcher=e,__reflect(e.prototype,"ns_sirius.DelayDispatcher")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.ddid=0,e}return __extends(e,t),e.prototype._before_destroy=function(){this._target=null,this._fun_repeat=null,this._fun_end=null,this._param=null,this._timeout_obj&&clearTimeout(this._timeout_obj)},e.prototype.dispatch=function(t,e,i,r,n,o){var _=this;void 0===o&&(o=null),this._is_destroyed=!1,this._delay_time=t,this._target=i,this._fun_repeat=r,this._fun_end=n,this._param=o,this._repeat_count=e,this._repeat_cursor=0,this._timeout_obj=setTimeout(function(){_._execute_step()},this._delay_time)},e.prototype._execute_step=function(){var t=this;return this._execute_repeat(this._repeat_cursor),this._repeat_cursor++,this._repeat_cursor>=this._repeat_count?void this._execute_fun():void(this._timeout_obj=setTimeout(function(){t._execute_step()},this._delay_time))},e.prototype._execute_repeat=function(t){this._is_destroyed||this._target&&this._fun_repeat&&this._fun_repeat.apply(this._target,[t,this._param])},e.prototype._execute_fun=function(){this._is_destroyed||(this._target&&this._fun_end&&this._fun_end.apply(this._target,[this._param]),this.destroy())},e}(t.sirius_base_object);t.RepeatDispatcher=e,__reflect(e.prototype,"ns_sirius.RepeatDispatcher")}(ns_sirius||(ns_sirius={}));var ns_sirius_math;!function(t){function e(t,e,i,r){var n=t-i,o=e-r;return Math.sqrt(n*n+o*o)}t.points_distance=e}(ns_sirius_math||(ns_sirius_math={}));var ns_sirius_math;!function(t){function e(t){return t=(9301*t+49297)%233280,t/233280}function i(t,i){var r=(t+1)*(i+1),n=Math.ceil(1e4*e(r))/1e4;return n}t.random=i}(ns_sirius_math||(ns_sirius_math={}));var sirius_str_util;!function(t){}(sirius_str_util||(sirius_str_util={}));var ns_sirius;!function(t){function e(t){return t.pool_data}t.pool_data=e;var i=function(){function t(){this.is_free=!0}return t}();t.pool_obj_data=i,__reflect(i.prototype,"ns_sirius.pool_obj_data");var r=function(){function t(t){this._size=t,this._stack=new Array(t),this._flags=new Array(t)}return Object.defineProperty(t.prototype,"empty",{get:function(){return this._find_free_index()<0},enumerable:!0,configurable:!0}),t.prototype.pool_init=function(t,e){for(var r=0;r<this._size;r++)this._stack[r]=new t,this._stack[r].pool_data=new i,this._flags[r]=0,e(this._stack[r])},t.prototype.borrow=function(){var t=this._find_free_index();if(0>t)return null;this._flags[t]=1;var e=this._stack[t];return e.pool_data.is_free=!1,e.pool_status_goto_busy&&e.pool_status_goto_busy(),this._stack[t]},t.prototype.giveback=function(t){var e=this._stack.indexOf(t);if(!(0>e)){this._flags[e]=0;var i=this._stack[e];i.pool_data.is_free=!0,i.pool_status_goto_idle&&i.pool_status_goto_idle()}},t.prototype.get_array=function(){return this._stack},t.prototype.destroy=function(){for(var t=0;t<this._size;t++){var e=this._stack[t];e.destroy()}this._stack=null,this._flags=null},t.prototype.pool_reset=function(){for(var t=0;t<this._size;t++){var e=this._stack[t];e.pool_data.is_free=!0,this._flags[t]=0,e.pool_status_goto_idle&&e.pool_status_goto_idle()}},t.prototype.enumerate_all_busy=function(t){for(var i=0;i<this._size;i++){var r=this._stack[i];e(r).is_free||r.is_destroyed||t(r)}},t.prototype._find_free_index=function(){for(var t=0;t<this._size;t++)if(0===this._flags[t])return t;return-1},t}();t.dynamic_pool=r,__reflect(r.prototype,"ns_sirius.dynamic_pool")}(ns_sirius||(ns_sirius={}));var ns_sirius;!function(t){var e=function(){function t(t){this._stack=new Array(t),this._size=t,this._cursor=0}return t.prototype.pool_init=function(t){for(var e=0;e<this._size;e++)this._stack[e]=new t},t.prototype.borrow=function(){var t=this._stack[this._cursor];return this._cursor++,this._cursor>=this._size&&(this._cursor=0),t},t.prototype.get_stack=function(){return this._stack},t.prototype.destroy=function(){this._stack=null},t}();t.rotational_deprived_fixed_pool=e,__reflect(e.prototype,"ns_sirius.rotational_deprived_fixed_pool")}(ns_sirius||(ns_sirius={}));var sirius_str_util;!function(t){function e(t,e){var i=t.toFixed(e);return parseFloat(i)}function i(t,e){return t.toFixed(e)}function r(t){var e="";return e=10>t?"0"+t:t+""}function n(t){var e="";return e=10>t?"00"+t:100>t?"0"+t:t+""}t.float_fixed=e,t.float_fixed_str=i,t.add_zero_2=r,t.add_zero_3=n}(sirius_str_util||(sirius_str_util={}));