var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},__extends=function(t,e){function i(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;n>i;i++){e=arguments[i];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},__rest=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i},__decorate=function(t,e,i,n){var r,o=arguments.length,a=3>o?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var _=t.length-1;_>=0;_--)(r=t[_])&&(a=(3>o?r(a):o>3?r(e,i,a):r(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},__param=function(t,e){return function(i,n){e(i,n,t)}},__metadata=function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},__awaiter=function(t,e,i,n){function r(t){return t instanceof i?t:new i(function(e){e(t)})}return new(i||(i=Promise))(function(i,o){function a(t){try{s(n.next(t))}catch(e){o(e)}}function _(t){try{s(n["throw"](t))}catch(e){o(e)}}function s(t){t.done?i(t.value):r(t.value).then(a,_)}s((n=n.apply(t,e||[])).next())})},__generator=function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=2&i[0]?o["return"]:i[0]?o["throw"]||((a=o["return"])&&a.call(o),0):o.next)&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(n){i=[6,n],o=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,a,_,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return _={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_},__exportStar=function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||__createBinding(e,t,i)},__createBinding=Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]},__values=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),a=[];try{for(;(void 0===e||e-->0)&&!(n=o.next()).done;)a.push(n.value)}catch(_){r={error:_}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return a},__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;i>e;e++)t+=arguments[e].length;for(var n=Array(t),r=0,e=0;i>e;e++)for(var o=arguments[e],a=0,_=o.length;_>a;a++,r++)n[r]=o[a];return n},__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},__asyncGenerator=function(t,e,i){function n(t){l[t]&&(c[t]=function(e){return new Promise(function(i,n){u.push([t,e,i,n])>1||r(t,e)})})}function r(t,e){try{o(l[t](e))}catch(i){s(u[0][3],i)}}function o(t){t.value instanceof __await?Promise.resolve(t.value.v).then(a,_):s(u[0][2],t)}function a(t){r("next",t)}function _(t){r("throw",t)}function s(t,e){t(e),u.shift(),u.length&&r(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,l=i.apply(t,e||[]),u=[];return c={},n("next"),n("throw"),n("return"),c[Symbol.asyncIterator]=function(){return this},c},__asyncDelegator=function(t){function e(e,r){i[e]=t[e]?function(i){return(n=!n)?{value:__await(t[e](i)),done:"return"===e}:r?r(i):i}:r}var i,n;return i={},e("next"),e("throw",function(t){throw t}),e("return"),i[Symbol.iterator]=function(){return this},i},__asyncValues=function(t){function e(e){n[e]=t[e]&&function(n){return new Promise(function(r,o){n=t[e](n),i(r,o,n.done,n.value)})}}function i(t,e,i,n){Promise.resolve(n).then(function(e){t({value:e,done:i})},e)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),n={},e("next"),e("throw"),e("return"),n[Symbol.asyncIterator]=function(){return this},n)},__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t["default"]=e},__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&__createBinding(e,t,i);return __setModuleDefault(e,t),e},__importDefault=function(t){return t&&t.__esModule?t:{"default":t}},__classPrivateFieldGet=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i},__reflect=function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i};!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)e.d(n,r,function(e){return t[e]}.bind(null,r));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){i(1),i(2),i(3),i(4),i(5),i(6),i(7),i(8),i(9),i(10),i(11),i(12),i(13),i(14),i(15),i(16),i(17),i(18),i(19),i(20),i(21),i(22),i(23),i(24),i(25),i(26),i(27),i(28),i(29),i(30),i(31),i(32),i(33),i(34),i(35),i(36),i(37),i(38),i(39),i(40),i(41),i(42),i(43),i(44),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68);var n=function(t){function e(){var e=t.call(this)||this;return AppG.GlobalInit(),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()["catch"](function(t){console.log(t)})];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),[4,RES.loadGroup("characters",0,t)];case 4:return i.sent(),this.stage.removeChild(t),[3,6];case 5:return e=i.sent(),console.error(e),[3,6];case 6:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e(!0)},t)})},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.createGameScene=function(){GameGlobalConfig.CONFIG_INIT(),AppG.DEBUG_INIT_RES_LIST();var t=this.stage.stageWidth,e=this.stage.stageHeight;GameCore.STATIC_INIT();var i=new GameCoreView;this.addChild(i),i.width=t,i.height=e,GameCore.core.core_init(i),setTimeout(function(){GameCore.core.start_game()},1e3)},e}(eui.UILayer);window.Main=n,__reflect(n.prototype,"Main",[])},function(t,e){var i=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();window.AssetAdapter=i,__reflect(i.prototype,"AssetAdapter",["eui.IAssetAdapter"])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);window.LoadingUI=i,__reflect(i.prototype,"LoadingUI",["RES.PromiseTaskReporter"])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/MyEUITestView/MyEUITestView.exml",e}return __extends(e,t),e}(eui.Component);window.MyEUITestView=i,__reflect(i.prototype,"MyEUITestView",[])},function(t,e){var i=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();window.DebugPlatform=i,__reflect(i.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new i)},function(t,e){var i=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var _=t.split("/");_.pop();var s=_.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(s,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();window.ThemeAdapter=i,__reflect(i.prototype,"ThemeAdapter",["eui.IThemeAdapter"])},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function e(){this.log=new t.sirius_log}return e}();t.SiriusPublic=e,__reflect(e.prototype,"ns_sirius.SiriusPublic",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function t(){}return t.prototype.log=function(t){console.log(t)},t.prototype.throw_error=function(t){throw console.error(t),t},t.prototype.error=function(t){console.error(t)},t.prototype.throw_error_too_strict=function(t){console.log(t)},t.prototype.sh_exception=function(t){console.log("sh:> "+t)},t}();t.sirius_log=e,__reflect(e.prototype,"ns_sirius.sirius_log",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function t(){this._animatebles=new Array,this._timeScale=1}return t.frame_to_ms=function(t){return Math.round(1e3*t/60)},Object.defineProperty(t.prototype,"time_scale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!1,configurable:!0}),t.prototype.update=function(t){if(1!==this._timeScale&&(t*=this._timeScale),0!=t&&!(0>t)){for(var e=0,i=0,n=this._animatebles.length;n>e;++e){var r=this._animatebles[e];null!==r?(i>0&&(this._animatebles[e-i]=r,this._animatebles[e]=null),r.update(t)):i++}if(i>0){for(n=this._animatebles.length;n>e;++e){var o=this._animatebles[e];null!==o?this._animatebles[e-i]=o:i++}this._animatebles.length-=i}}},t.prototype.add=function(t){t&&this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null,t.clock=null)},t.prototype.removeAt=function(t){t>=0&&(this._animatebles[t].clock=null,this._animatebles[t]=null)},t}();t.anim_clock=e,__reflect(e.prototype,"ns_sirius.anim_clock",[]),t.world_clock=new e,t.timer_clock=new e}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function t(){this._timeScale=1,this._listeners=new Array}return Object.defineProperty(t.prototype,"time_scale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!1,configurable:!0}),t.prototype.register_listener=function(t){this._listeners.indexOf(t)>=0||this._listeners.push(t)},t.prototype.remove_listener=function(t){var e=this._listeners.indexOf(t);0>e||this._listeners.splice(e,1)},t.prototype.update=function(t){if(1!==this._timeScale&&(t*=this._timeScale),0!=t&&!(0>t))for(var e=0;e<this._listeners.length;e++){var i=this._listeners[e];i.is_destroyed!==!0&&this._listeners[e].update(t)}},t}();t.global_pulse_clock=e,__reflect(e.prototype,"ns_sirius.global_pulse_clock",[]),t.pulse_clock=new e}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function t(){this._is_destroyed=!1}return Object.defineProperty(t.prototype,"is_destroyed",{get:function(){return this._is_destroyed},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.destructor(),this._before_destroy(),this._is_destroyed=!0},t.prototype._before_destroy=function(){},t.prototype.destructor=function(){},t.prototype._destroy_component=function(t){if(t&&null!==this[t]){if(void 0===this[t])throw new TypeError(t+" does not exists on "+this.constructor.name);this[t].destroy(),this[t]=null}},t}();t.sirius_base_object=e,__reflect(e.prototype,"ns_sirius.sirius_base_object",["Isirius_base_object"])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(e){function i(t,i,n,r){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=0),void 0===r&&(r=null);var o=e.call(this)||this;return o._is_destroyed=!1,o._listener=t,o.anim_id=n,o._param=r,o._target_view=i,o}return __extends(i,e),i.prototype.target_view=function(){return this._target_view},i.prototype.init=function(t){return void 0===t&&(t=null),this.anim_active(t),this},i.prototype.anim_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.anim_deactive=function(){this._clock&&this._clock.remove(this)},i.prototype._clear_status=function(){this._anim_finish_cb=null,this._is_animating=!1,this._normalized_time=0,this._real_time=0},i.prototype._before_destroy=function(){this._is_destroyed=!0,this._clear_status(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._param=null,this._target_view=null},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!1,configurable:!0}),i.prototype.is_disposable=function(){return!1},Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!1,configurable:!0}),i.prototype.start=function(t){void 0===t&&(t=null),this._normalized_time=0,this._real_time=0,this._anim_duration=this.animation_duration(),this._is_animating=!0,this._anim_finish_cb=t,this._reset_anim_properties(),this._after_start()},i.prototype.stop=function(){this._clear_status(),this._reset_anim_properties()},i.prototype._after_start=function(){},i.prototype._before_stop=function(){},i.prototype.update=function(t){this._is_animating&&(this._real_time+=t,this._normalized_time=this._real_time/this._anim_duration,this._normalized_time>1?this._anim_update(1):this._anim_update(this._normalized_time),this._normalized_time<1||(this._before_stop(),this._listener&&this._listener.single_anim_comp(this),this._anim_finish_cb&&this._anim_finish_cb(),this.stop(),this.is_disposable()&&this.destroy()))},i.prototype.util_linear_interpolation=function(t,e,i){return t+(e-t)*i},i}(t.sirius_base_object);t.single_animation=e,__reflect(e.prototype,"ns_sirius.single_animation",["IAnimatable"])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(e){function i(t,i,n){void 0===t&&(t=null),void 0===i&&(i=0),void 0===n&&(n=null);var r=e.call(this)||this;return r._listener=t,r.timer_id=i,r._param=n,r}return __extends(i,e),i.prototype.init=function(t){return void 0===t&&(t=null),this.timer_active(),this},i.prototype.timer_active=function(e){void 0===e&&(e=null),e?e.add(this):t.world_clock.add(this)},i.prototype.timer_deactive=function(){this._clock&&this._clock.remove(this)},i.prototype._before_destroy=function(){this.stop(),this._clock&&this._clock.remove(this),this._clock=null,this._listener=null,this._param=null},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"is_animating",{get:function(){return this._is_animating},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tick_cursor",{get:function(){return this._tick_cursor},enumerable:!1,configurable:!0}),i.prototype.start=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=!1),this._normalized_time=0,this._real_time=0,this._tick_cursor=0,this._is_animating=!0,this._anim_duration=t,this._loop_count=e,n?this._tick_once():i>0&&(this._real_time+=i),this},i.prototype.stop=function(){this._is_animating=!1},i.prototype.update=function(t){this._is_animating&&(this._real_time+=t,this._normalized_time=this._real_time/this._anim_duration,this._normalized_time<1||(this._tick_once(),this._loop_count<=0||this._tick_cursor>=this._loop_count&&(this.stop(),this._post_finish())))},i.prototype._tick_once=function(){this._normalized_time=0,this._real_time=0,this._listener.rtimer_tick(this),this._tick_cursor++},i.prototype._post_finish=function(){this._listener.rtimer_finish(this)},i}(t.sirius_base_object);t.timer_rtime_based=e,__reflect(e.prototype,"ns_sirius.timer_rtime_based",["IAnimatable"])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._machine=null,e}return __extends(e,t),e.prototype._before_destroy=function(){this._machine=null},e.prototype.state_init=function(t,e){this._machine=t,this._convert_context(e),this._behaviors_init(),this._after_state_init()},e.prototype._convert_context=function(t){},e.prototype._behaviors_init=function(){},e.prototype._after_state_init=function(){},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e.prototype.state_update=function(t){},e}(t.sirius_base_object);t.GP_StateBase=e,__reflect(e.prototype,"ns_sirius.GP_StateBase",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._s_default=new t.GP_State_Default,i._current_state=new t.GP_State_Default,i._listener=null,i._ctx=null,i}return __extends(i,e),i.prototype.destructor=function(){this._ctx=null,this._listener=null,this._current_state=null,this._s_default.destroy(),this._s_default=null},i.prototype.get_current_state=function(){return this._current_state},i.prototype.get_current_state_str=function(){return this._current_state.state_str()},i.prototype.get_current_state_enum=function(){return this._current_state.state_enum()},i.prototype.machine_initialize=function(t,e,i){void 0===i&&(i=null),this._listener=t,this._ctx=e,this._s_default.state_init(this,e),this._states_init(e)},i.prototype.state_change=function(t,e){void 0===e&&(e=null);var i=this.get_state_by_enum(t);i||console.log("invalid game machine enum "+t);var n=this._current_state;this._current_state=i,this._listener.sm_state_changed(n,i,e),n.state_leave(i,e),i.state_enter(n,e)},i.prototype.machine_update=function(t){this._current_state.state_update(t)},i}(t.sirius_base_object);t.GP_StateMachine=e,__reflect(e.prototype,"ns_sirius.GP_StateMachine",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.after_state_init=function(){},e.prototype.state_enum=function(){return 0},e.prototype.state_str=function(){return"Default"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null)},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e}(t.GP_StateBase);t.GP_State_Default=e,__reflect(e.prototype,"ns_sirius.GP_State_Default",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e}return __extends(e,t),e.prototype.destroy=function(){this._before_destroy(),this._is_destroyed=!0},e.prototype._before_destroy=function(){this._view_before_destroy(),this.remove_all_children(),this.remove_from_parent()},e.prototype.attached_to_display_tree=function(t){},e.prototype.detaching_from_display_tree=function(t){void 0===t&&(t=null)},e.prototype._view_before_destroy=function(){},e.prototype.remove_all_children=function(){this.removeChildren()},e.prototype.remove_from_parent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.update_visible=function(t){this.visible=t},e.prototype.mark_as_fullfill=function(){this.percentWidth=100,this.percentHeight=100,this.x=0,this.y=0},e.prototype.set_bg_color=function(t,e){void 0===e&&(e=1);var i=new eui.Rect;return this.addChildAt(i,0),i.fillColor=t,i.percentWidth=100,i.percentHeight=100,i.alpha=e,i},e}(eui.Group);t.sirius_view_base=e,__reflect(e.prototype,"ns_sirius.sirius_view_base",["Isirius_view_base"])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function t(t){void 0===t&&(t=0),this._node_type=0,this._node_type=t}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},set:function(t){this._element=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pre",{get:function(){return this._pre},set:function(t){this._pre=t},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){1==this._node_type||2==this._node_type,this._element=null,this._next=null,this._pre=null},t.prototype.is_head=function(){return 1==this._node_type},t.prototype.is_tail=function(){return 2==this._node_type},t}();t.dll_node=e,__reflect(e.prototype,"ns_sirius.dll_node",[]);var i=function(){function t(t){void 0===t&&(t=0),this.list_id=0,this.list_id=t,this._tail=new e(2),this._tail.next=null,this._tail.element=null,this._head=new e(1),this._head.pre=null,this._head.element=null,this._tail.pre=this._head,this._head.next=this._tail,this._length=0}return Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){for(var t=this._head,e=null;t&&!t.is_tail();)e=t.next,t.destroy(),t=e;this._head=null,this._tail=null,this._length=0},t.prototype.is_empty=function(){return this._head.next==this._tail},t.prototype.push=function(t){var i=new e;i.element=t,i.next=this._tail,i.pre=this._tail.pre,this._tail.pre.next=i,this._tail.pre=i,this._length++},t.prototype.pop=function(){if(!this.is_empty()){this._length--;var t=this._tail.pre,e=t.element;return t.pre.next=this._tail,this._tail.pre=t.pre,t.destroy(),t=null,e}},t.prototype.remove=function(t){if(!this.is_empty()){var e=this.find(t);if(!e)return void console.log("!!! NODE DO NOT Exists !!!");this._length--;var i=e.pre,n=e.next;i.next=n,n.pre=i,e.destroy(),e=null}},t.prototype.find=function(t){if(!t)return null;for(var e=this._head.next;e&&!e.is_tail();){if(e.element==t)return e;e=e.next}return null},t.prototype.find_element_by_property=function(t,e){if(!t)return null;for(var i=this._head.next;i&&!i.is_tail();){if(i.element[t]===e)return i.element;i=i.next}return null},t.prototype.get_head=function(){return this._head},t.prototype.get_tail=function(){return this._tail},t.prototype.loop_breakable=function(t){for(var e=this.get_head().next;e&&!e.is_tail();){var i=t(e.element);if(!i)break;e=e.next}},t.prototype.loop_node=function(t){for(var e=this.get_head().next;e&&!e.is_tail();)t(e),e=e.next},t.prototype.loop_element=function(t){for(var e=this.get_head().next;e&&!e.is_tail();)t(e.element),e=e.next},t.prototype.loop_element_by_property=function(t,e,i){if(!t)return null;for(var n=this._head.next;n&&!n.is_tail();)n.element[t]===e&&i(n.element),n=n.next;return null},t.prototype.remove_element_by_property=function(t,e){if(!t)return null;for(var i=this._head.next;i&&!i.is_tail();)if(i.element[t]===e){var n=i;n.pre.next=i.next,n.next.pre=i.pre,i=n.next,n.destroy(),n=null}else i=i.next;return null},t}();t.doubly_linked_list=i,__reflect(i.prototype,"ns_sirius.doubly_linked_list",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function t(t){this._stack=new Array(t),this._size=t}return t.prototype.pool_init=function(t){for(var e=0;e<this._size;e++){var i=new t;(void 0===i.po_is_busy||null===i.po_is_busy)&&this._default_pool_object(i),this._stack[e]=i}},t.prototype.borrow=function(){var t=this._find_next_available();return t?(t.po_borrowed(),t):null},t.prototype.give_back=function(t){t&&(t.po_is_busy()||t.po_givenback())},t.prototype.destroy=function(){this._stack&&(this._stack.forEach(function(t){t.po_is_busy()&&t.po_givenback(),t.destroy()}),this._stack=null)},t.prototype._find_next_available=function(){for(var t=0;t<this._stack.length;t++){var e=this._stack[t];if(!e.po_is_busy())return e}return null},t.prototype._default_pool_object=function(t){t._po_is_busy=!1,t.po_is_busy=function(){return this._po_is_busy}.bind(t),t.po_borrowed=function(){this._po_is_busy=!0}.bind(t),t.po_givenback=function(){this._po_is_busy=!1}.bind(t)},t}();t.common_object_cache_pool=e,__reflect(e.prototype,"ns_sirius.common_object_cache_pool",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i,i=window.ns_sirius;!function(t){var e=function(){function t(t){this._stack=new Array(t),this._size=t,this._cursor=0}return t.prototype.pool_init=function(t){for(var e=0;e<this._size;e++)this._stack[e]=new t},t.prototype.borrow=function(){var t=this._stack[this._cursor];return this._cursor++,this._cursor==this._size&&(this._cursor=0),t},t.prototype.get_stack=function(){return this._stack},t.prototype.destroy=function(){this._stack=null},t}();t.rotational_deprived_fixed_pool=e,__reflect(e.prototype,"ns_sirius.rotational_deprived_fixed_pool",[])}(i||(i={})),window.ns_sirius=i},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.anim_end="anim_end",e.anim_frame_event="anim_frame_event",e.display_loaded="display_loaded",e.display_failed="display_failed",e}(egret.Event);window.db_res_display_view_event=i,__reflect(i.prototype,"db_res_display_view_event",[]);var n=function(){function t(){this.horizontal_layout=0,this.vertical_layout=0}return t}();window.db_res_layout_param=n,__reflect(n.prototype,"db_res_layout_param",[]);var r=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;i._fixed_init_scale_x=.75,i._fixed_init_scale_y=.75,i._attached=!1,i._is_freezing=!1,i._inner_scale_x=i._fixed_init_scale_x,i._inner_scale_y=i._fixed_init_scale_y;var r=40,o=80,a=new eui.Rect;i.addChildAt(a,0),a.fillColor=3355443,a.width=r,a.height=o,a.x=.5*-r,a.y=-o;var _=new eui.Image("C00000_png");return i.addChildAt(_,0),_.fillMode=egret.BitmapFillMode.SCALE,_.x=.5*-r,_.y=-o,i._black_mask=_,e?i._layout_param=e:i._layout_param=new n,i._effect_container=new eui.Group,i.addChild(i._effect_container),i._bbox=new egret.Rectangle(0,0,0,0),i}return __extends(e,t),e.prototype.$hitTest=function(t,e){return null},Object.defineProperty(e.prototype,"bbox",{get:function(){return this._bbox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inner_scale_x",{get:function(){return this._inner_scale_x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inner_scale_y",{get:function(){return this._inner_scale_y},enumerable:!1,configurable:!0}),e.prototype._destroy_character_display=function(){this._character_display&&(this.removeChild(this._character_display),this._character_display.animation.stop(),this._character_display.removeEventListener(dragonBones.EventObject.COMPLETE,this._animation_play_end,this),this._character_display.removeEventListener(dragonBones.EventObject.FRAME_EVENT,this._ANIM_FRAME_EVENT,this),this._character_display.armature.dispose(),this._character_display.dispose(),this._character_display=null)},e.prototype._unregister_from_res=function(){},e.prototype._before_destroy=function(){this._effect_container.removeChildren(),this.removeChild(this._effect_container),this._effect_container=null,this._unregister_from_res(),this._weak_res=null,this._layout_param=null,this._destroy_character_display(),t.prototype._before_destroy.call(this)},e.prototype._goto_attached_mode=function(){this._attached=!0,this._black_mask.visible=!1},e.prototype.set_layout_param=function(t){this._layout_param=t},e.prototype.bind_entity=function(t){this._weak_res=t,this._weak_res.can_display&&this._init_character_anim(this._weak_res)},e.prototype.play_anim=function(t,e){var i=this;if(!this._is_destroyed&&!this._is_freezing)return this._character_display?void this._character_display.animation.play(t,e):void(t.indexOf("attack")>=0&&(this._attached||setTimeout(function(){i._dispatch_attack_trigger_null()},500)))},e.prototype.play_attack=function(t,e){var i=this;if(!this._is_destroyed&&!this._is_freezing){if(!this._character_display)return void(t.indexOf("attack")>=0&&(this._attached||setTimeout(function(){i._dispatch_attack_trigger_null()
},500)));if(!this._character_display.animation.hasAnimation(t))return void setTimeout(function(){i._dispatch_attack_trigger_null()},500);var n=this._character_display.animation.animations[t],r=1e3*n.duration,o=300,a=e-o;0>a&&(a=r);var _=r/a;this._character_display.animation.timeScale=_,this._character_display.animation.play(t,1)}},e.prototype.character_play_frame_1=function(){this._is_freezing=!0,this._character_display&&this._character_display.animation.gotoAndStopByFrame("standby",1)},e.prototype.last_anim_state_name=function(){return this._character_display&&this._character_display.animation?this._character_display.animation.lastAnimationName:null},e.prototype._get_factory=function(){return AppG.appm.art_factory},e.prototype._get_res_name=function(t){return t.res_name()},e.prototype._init_character_anim=function(t){if(!this._is_destroyed){this._character_display&&this._destroy_character_display();var e=this._get_factory(),n=this._get_res_name(t);if(e){var r=e.buildArmatureDisplay("Armature",n);if(!r)return void AppG.sirius.log.error("RES LOAD ERROR : SyncDBDisplay "+n);this.addChild(r),this._character_display=r,this._character_display.addEventListener(dragonBones.EventObject.COMPLETE,this._animation_play_end,this),this._character_display.addEventListener(dragonBones.EventObject.FRAME_EVENT,this._ANIM_FRAME_EVENT,this),t.default_anim_name?this._character_display.animation.play(t.default_anim_name):this._is_freezing?this._character_display.animation.gotoAndStopByFrame("standby",1):this._character_display.animation.play("standby"),this._character_display.touchEnabled=!1,this._character_display.touchChildren=!1,this._character_display.scaleX=this._inner_scale_x,this._character_display.scaleY=this._inner_scale_y,this._bbox_display&&this.addChild(this._bbox_display),this._mark_rect&&this.addChild(this._mark_rect),this.addChild(this._effect_container),this._goto_attached_mode(),this._calculate_bbox_area(),this._layout_character(),this.dispatchEvent(new i(i.display_loaded))}}},e.prototype.modify_inner_scale=function(t){this._inner_scale_x=this._fixed_init_scale_x*t,this._inner_scale_y=this._fixed_init_scale_x*t,this._character_display&&(this._character_display.scaleX=this._inner_scale_x,this._character_display.scaleY=this._inner_scale_y,this._calculate_bbox_area(),this._layout_character())},e.prototype._calculate_bbox_area=function(){},e.prototype._layout_character=function(){this._layout_display(this._character_display,this._bbox,this._layout_param),this._layout_display(this._black_mask,this._bbox,this._layout_param),this._bbox_display&&(this._layout_bbox_area(this._bbox_display,this._bbox,this._layout_param),this._bbox_display.width=this._bbox.width,this._bbox_display.height=this._bbox.height)},e.prototype._layout_display=function(t,e,i){t&&(0===i.horizontal_layout?t.x=0:1===i.horizontal_layout&&(t.x=.5*-e.width-e.x),0===i.vertical_layout?t.y=0:1===i.vertical_layout&&(t.y=.5*-e.height-e.y))},e.prototype._layout_bbox_area=function(t,e,i){t&&(0===i.horizontal_layout?t.x=e.x:1===i.horizontal_layout&&(t.x=.5*-e.width),0===i.vertical_layout?t.y=e.y:1===i.vertical_layout&&(t.y=.5*-e.height))},e.prototype._animation_play_end=function(t){if(!this._is_destroyed){var e=new i(i.anim_end);if(e.last_anim=this._character_display.animation.lastAnimationName,this.dispatchEvent(e),!this._is_freezing){var n=null;this._weak_res&&this._weak_res.default_anim_name&&(n=this._weak_res.default_anim_name),n?this._character_display.animation.play(n):this._character_display.animation.play("standby")}}},e.prototype._ANIM_FRAME_EVENT=function(t){if(!this._is_destroyed){var e=new i(i.anim_frame_event);e.last_anim=this._character_display.animation.lastAnimationState.name,this.dispatchEvent(e)}},e.prototype._dispatch_attack_trigger_null=function(){if(!this._is_destroyed){var t=new i(i.anim_frame_event);t.last_anim="attack_null",this.dispatchEvent(t)}},e.prototype.attach_effect=function(t){for(var e=this._effect_container.numChildren,i=0;e>i;i++){var n=this._effect_container.getChildAt(i);n.destroy()}this._effect_container.removeChildren(),this._effect_container.addChild(t)},e.prototype._get_root_slot=function(){return this._character_display?this._character_display.armature.getSlot("root_boundingBox"):null},e.prototype.update_status=function(){this._weak_res.can_display&&this._res_loaded_explicit()},e.prototype.res_loaded_explicit=function(){this._res_loaded_explicit()},e.prototype._res_loaded_explicit=function(){this._character_display&&this._destroy_character_display(),this._weak_res.can_display?this._init_character_anim(this._weak_res):this.dispatchEvent(new i(i.display_failed))},e}(ns_sirius.sirius_view_base);window.db_res_display_view=r,__reflect(r.prototype,"db_res_display_view",["Idb_res_entity_display_view"])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(ns_sirius.sirius_base_object);window.res_entity_base=i,__reflect(i.prototype,"res_entity_base",[])},function(t,e){var i;!function(t){t[t.nil=0]="nil",t[t.ske=1]="ske",t[t.tex=2]="tex",t[t.png=3]="png"}(i||(i={})),window.db_res_slot=i;var n;!function(t){t[t.idle=0]="idle",t[t.loading=1]="loading",t[t.ready=2]="ready",t[t.error=3]="error"}(n||(n={})),window.res_loading_status=n;var r=function(t){function e(){var e=t.call(this)||this;return e._anim_data_established=!1,e}return __extends(e,t),e.prototype.res_init=function(t){this.uuid=t,this.ske_key=t+"_ske_json",this.tex_key=t+"_tex_json",this.png_key=t+"_tex_png",this._ske_status=n.idle,this._tex_status=n.idle,this._png_status=n.idle,this._total_status=n.idle},e.prototype.set_all_ready_immediately=function(){this._total_status=n.ready,this.establish_anim_data()},e.prototype.establish_anim_data=function(){if(!this._anim_data_established){this._anim_data_established=!0;var t=RES.getRes(this.ske_key),e=RES.getRes(this.tex_key),i=RES.getRes(this.png_key),n=AppG.appm.art_factory;n.parseDragonBonesData(t),n.parseTextureAtlasData(e,i)}},e.prototype.update_status=function(t,e){switch(t){case i.ske:this._ske_status=e;break;case i.tex:this._tex_status=e;break;case i.png:this._png_status=e}this._ske_status==n.error||this._tex_status==n.error||this._png_status==n.error?this._total_status=n.error:this._ske_status==n.ready&&this._tex_status==n.ready&&this._png_status==n.ready?(this._total_status=n.ready,this.establish_anim_data()):this._total_status=n.loading},e.prototype.reset_to_idle=function(){this.is_finish()||(this._total_status=n.idle)},e.prototype.reset_to_run=function(){this.is_finish()||(this.update_status(i.ske,n.loading),this.update_status(i.tex,n.loading),this.update_status(i.png,n.loading))},e.prototype.res_name=function(){return this.uuid},e.prototype.ske_status=function(){return this._ske_status},e.prototype.tex_status=function(){return this._tex_status},e.prototype.png_status=function(){return this._png_status},e.prototype.total_status=function(){return this._total_status},e.prototype.is_finish=function(){return this._total_status===n.ready||this._total_status===n.error?!0:!1},Object.defineProperty(e.prototype,"can_display",{get:function(){return this._total_status===n.ready},enumerable:!1,configurable:!0}),e}(res_entity_base);window.db_res_entity=r,__reflect(r.prototype,"db_res_entity",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e._fixed_init_scale_x=.6,e._fixed_init_scale_y=.6,e._inner_scale_x=e._fixed_init_scale_x,e._inner_scale_y=e._fixed_init_scale_y,e}return __extends(e,t),e.prototype.$hitTest=function(t,e){return null},Object.defineProperty(e.prototype,"inner_scale_x",{get:function(){return this._inner_scale_x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inner_scale_y",{get:function(){return this._inner_scale_y},enumerable:!1,configurable:!0}),e.prototype._destroy_character_display=function(){this._character_display&&(this.removeChild(this._character_display),this._character_display.animation.stop(),this._character_display.removeEventListener(dragonBones.EventObject.COMPLETE,this._animation_play_end,this),this._character_display.removeEventListener(dragonBones.EventObject.FRAME_EVENT,this._ANIM_FRAME_EVENT,this),this._character_display.armature.dispose(),this._character_display.dispose(),this._character_display=null)},e.prototype._before_destroy=function(){this._weak_res=null,this._finish_callback=null,this._event_callback=null,this._destroy_character_display(),t.prototype._before_destroy.call(this)},e.prototype.bind_entity=function(t){if(this._weak_res=t,!this._weak_res.can_display)throw new Error("res can not display : "+t.res_name);this._init_character_anim(this._weak_res)},e.prototype.play_anim_once=function(t,e,i){this._finish_callback=e,this._event_callback=i,this._character_display.animation.play(t,1)},e.prototype.play_anim_loop=function(t){this._finish_callback=null,this._event_callback=null,this._character_display.animation.play(t,0)},e.prototype._get_factory=function(){return AppG.appm.art_factory},e.prototype._get_res_name=function(t){return t.res_name()},e.prototype._init_character_anim=function(t){if(!this._is_destroyed){if(this._character_display)throw new Error("_character_display already created");var e=this._get_factory(),i=this._get_res_name(t),n=e.buildArmatureDisplay("Armature",i);if(!n)throw new Error("buildArmatureDisplay failed : "+i);this.addChild(n),this._character_display=n,this._character_display.addEventListener(dragonBones.EventObject.COMPLETE,this._animation_play_end,this),this._character_display.addEventListener(dragonBones.EventObject.FRAME_EVENT,this._ANIM_FRAME_EVENT,this),this._character_display.touchEnabled=!1,this._character_display.touchChildren=!1,this._character_display.scaleX=this._inner_scale_x,this._character_display.scaleY=this._inner_scale_y,this._layout_character(),this.dispatchEvent(new db_res_display_view_event(db_res_display_view_event.display_loaded))}},e.prototype.modify_inner_scale=function(t){this._inner_scale_x=this._fixed_init_scale_x*t,this._inner_scale_y=this._fixed_init_scale_x*t,this._character_display&&(this._character_display.scaleX=this._inner_scale_x,this._character_display.scaleY=this._inner_scale_y,this._layout_character())},e.prototype._layout_character=function(){this._character_display.x=0,this._character_display.y=0},e.prototype._animation_play_end=function(t){if(!this._is_destroyed){var e=new db_res_display_view_event(db_res_display_view_event.anim_end);e.last_anim=this._character_display.animation.lastAnimationName,this.dispatchEvent(e),this._finish_callback&&(this._finish_callback(e.last_anim),this._finish_callback=null)}},e.prototype._ANIM_FRAME_EVENT=function(t){if(!this._is_destroyed){var e=new db_res_display_view_event(db_res_display_view_event.anim_frame_event);e.last_anim=this._character_display.animation.lastAnimationName,this.dispatchEvent(e),this._event_callback&&(this._event_callback(e.last_anim),this._event_callback=null)}},e}(ns_sirius.sirius_view_base);window.db_res_view=i,__reflect(i.prototype,"db_res_view",[])},function(t,e){var i=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._create_metadata(e),i._children=new ns_sirius.doubly_linked_list,i._init_components(),i}return __extends(e,t),Object.defineProperty(e.prototype,"role",{get:function(){return this._role},set:function(t){this._role=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"display",{get:function(){return this._display},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._children&&(this._children.loop_element(function(t){t.destroy()}),this._children.destroy(),this._children=null),t.prototype.destroy.call(this)},e.prototype.destructor=function(){this._destroy_component("_display"),t.prototype.destructor.call(this)},e.prototype._init_components=function(){this._display=this._new_component(GameActor2DVisualComponent)},e.prototype._create_metadata=function(t){},e.prototype.attachChild=function(t){return t?(t._parent=this,this._children.push(t),this._display.attachChild(t.display),t):void 0},e.prototype.detachChild=function(t){return t?(this._children.remove(t),this._display.detachChild(t.display),t._parent=null,t):void 0},e.prototype.detach_from_parent=function(){return this._parent&&(this._parent.detachChild(this),this._parent=null),this},e.prototype._new_component=function(t){var e=new t;return e.attached(this),e},e}(ns_sirius.sirius_base_object);window.GameActor2D=i,__reflect(i.prototype,"GameActor2D",[])},function(t,e){var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.get_actor=function(){return this._actor},e.prototype.destructor=function(){this._actor=null},e.prototype.attached=function(t){this._actor=t},e.prototype.detached=function(){this._actor=null},e.prototype.mesh=function(){return this._actor.display.component_content},e.prototype.actor=function(){return this._actor},e}(ns_sirius.sirius_base_object);window.GameActor2DComponent=i,__reflect(i.prototype,"GameActor2DComponent",["IGameActor2DComponent"])},function(t,e){},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"is_destroyed",{get:function(){return this._is_destroyed},enumerable:!1,configurable:!0}),e.prototype.get_actor=function(){return this._actor},Object.defineProperty(e.prototype,"component_content",{get:function(){return this._component_content},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._content_animations&&(this._content_animations.forEach(function(t){t.destroy()}),this._content_animations=null),this._component_content&&(this._component_content.destroy(),this._component_content=null),this._bg_solid&&(this.removeChild(this._bg_solid),this._bg_solid=null),this.destructor(),this.parent&&this.parent.removeChild(this),this._actor=null,this._is_destroyed=!0},e.prototype.destructor=function(){},e.prototype.show_solid_bg=function(){if(this._bg_solid)return void(this._bg_solid.visible=!0);var t=new eui.Rect;this.addChildAt(t,0),t.percentWidth=100,t.percentHeight=100,t.fillColor=16777215*Math.random(),this._bg_solid=t},e.prototype.hide_solid_bg=function(){this._bg_solid&&(this._bg_solid.visible=!1)},e.prototype.attached=function(t){this._actor=t},e.prototype.detached=function(){this._actor=null},e.prototype.attachContent=function(t){t&&(this._component_content=t,this.addChildAt(t,1))},e.prototype.attachChild=function(t){t&&this.addChild(t)},e.prototype.detachChild=function(t){t&&this.removeChild(t)},e}(eui.Group);window.GameActor2DVisualComponent=i,__reflect(i.prototype,"GameActor2DVisualComponent",["ns_sirius.Isirius_base_object","IGameActor2DComponent"])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.component_init=function(e){return t.prototype.init.call(this),this._view=e,this},e}(ns_sirius.single_animation);window.GameActor2DVisualComponentAnimation=i,__reflect(i.prototype,"GameActor2DVisualComponentAnimation",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e._is_destroyed=!1,e._cached_anims=new Map,e}return __extends(e,t),Object.defineProperty(e.prototype,"is_destroyed",{get:function(){return this._is_destroyed},enumerable:!1,configurable:!0}),e.prototype.cached_anim=function(t){var e=this._cached_anims.get(t);if(!e)throw new Error("no anim : "+t);return e},e.prototype.get_actor=function(){return this._actor},e.prototype.destroy=function(){this._cached_anims&&(this._cached_anims.forEach(function(t,e){t.destroy()}),this._cached_anims=null),this.parent&&this.parent.removeChild(this),this.destructor(),this._actor=null,this._is_destroyed=!0},e.prototype.destructor=function(){},e.prototype.attached=function(t){this._actor=t},e.prototype.detached=function(){this._actor=null},e.prototype._init_cached_anim=function(t,e){var i=new e;return i.component_init(this),this._cached_anims.set(t,i),i},e}(eui.Group);window.GameActor2DVisualComponentContent=i,__reflect(i.prototype,"GameActor2DVisualComponentContent",["ns_sirius.Isirius_base_object"])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._init_components=function(){t.prototype._init_components.call(this)},e.prototype.update=function(t){this._children.loop_element(function(e){e.update(t)})},e}(GameActor2D);window.GroupActor=i,__reflect(i.prototype,"GroupActor",[])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"skeletal_mesh",{get:function(){return this._display.component_content},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skeletal_res",{get:function(){return this._skeletal_res},enumerable:!1,configurable:!0}),e.prototype.destructor=function(){this._destroy_component("_skeletal_res"),t.prototype.destructor.call(this)},e.prototype.bind_res=function(t){t&&(this._skeletal_res=t,this._display.attachContent(this._create_mesh(t)))},e.prototype._create_mesh=function(t){return new SkeletalMeshContent(t)},e}(GameActor2D);window.SkeletalMeshActor=i,__reflect(i.prototype,"SkeletalMeshActor",[])},function(t,e){var i=function(t){function e(e){var i=t.call(this)||this;return i._mesh=new db_res_view,i.addChild(i._mesh),i._mesh.bind_entity(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"mesh",{get:function(){return this._mesh},enumerable:!1,configurable:!0}),e.prototype.destructor=function(){this._mesh&&(this._mesh.destroy(),this._mesh=null),t.prototype.destructor.call(this)},e.prototype.play_anim_once=function(t,e,i){void 0===i&&(i=null),this._mesh.play_anim_once(t,e,i)},e.prototype.play_anim_loop=function(t){this._mesh.play_anim_loop(t)},e}(GameActor2DVisualComponentContent);window.SkeletalMeshContent=i,__reflect(i.prototype,"SkeletalMeshContent",[])},function(t,e){var i;!function(t){t[t.idle=1]="idle",t[t.walk=2]="walk",t[t.freeze=3]="freeze"}(i||(i={})),window.CharacterActorStatus=i;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"machine",{get:function(){return this._machine},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"md",{get:function(){return this._md},enumerable:!1,configurable:!0}),e.prototype._create_metadata=function(t){this._md=t},Object.defineProperty(e.prototype,"damage",{get:function(){return this._damage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"character_mesh",{get:function(){return this._display.component_content},enumerable:!1,configurable:!0}),e.prototype.destructor=function(){this._md=null,this._destroy_component("_machine"),this._destroy_component("_damage"),t.prototype.destructor.call(this)},e.prototype._init_components=function(){t.prototype._init_components.call(this),this._machine=new CharacterSM,this._machine.machine_initialize(this,this,null),this._damage=this._new_component(DamageComponent)},e.prototype.sm_state_changed=function(t,e,i){},e.prototype.update=function(t){if(!this._machine)throw new Error("no machine ? ");this._machine.machine_update(t)},e.prototype._create_mesh=function(t){return new CharacterDisplay(t)},e.prototype.attack_1=function(t){this.machine.state_change(CharacterSMState.attack1,t)},e.prototype.attack_2=function(t){this.machine.state_change(CharacterSMState.attack2)},e}(SkeletalMeshActor);window.CharacterActor=n,__reflect(n.prototype,"CharacterActor",["ns_sirius.IGP_StateMachineListener"])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ANIM_RESET=function(t,e){return this._from=t,this._to=e,this},e.prototype.animation_duration=function(){return e.duration},e.prototype._reset_anim_properties=function(){},e.prototype._after_start=function(){this._view&&(this._view.x=this._from.x,this._view.y=this._from.y)},e.prototype._before_stop=function(){if(this._is_destroyed)throw new Error(" _is_destroyed ??");this._view&&(this._view.x=this._to.x,this._view.y=this._to.y)},e.prototype._anim_update=function(t){if(this._view){var e=t,i=this._from.x+(this._to.x-this._from.x)*e,n=this._from.y+(this._to.y-this._from.y)*e;this._view.x=i,this._view.y=n}},e.duration=200,e}(GameActor2DVisualComponentAnimation);window.Anim_Attack_Move=i,__reflect(i.prototype,"Anim_Attack_Move",[])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.animation_duration=function(){return e.duration},e.prototype._reset_anim_properties=function(){this._view&&(this._view.x=0)},e.prototype._anim_update=function(t){if(this._view){var e=t,i=500*(1-e);0>i&&(i=0),this._view.x=i}},e.duration=2e3,e}(GameActor2DVisualComponentAnimation);window.ANIM_EnemyEnter=i,__reflect(i.prototype,"ANIM_EnemyEnter",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this,i=[1,0,0,0,0,0,.6,0,0,0,0,0,.6,0,0,0,0,0,1,0];return e._vibration_filter=new egret.ColorMatrixFilter(i),e}return __extends(e,t),e.prototype.animation_duration=function(){var t=ns_sirius.anim_clock.frame_to_ms(15);return t},e.prototype._after_start=function(){this._view&&(this._view.filters=[this._vibration_filter])},e.prototype._before_stop=function(){this._view&&(this._view.filters=null)},e.prototype._anim_update=function(t){var e=35,i=t,n=e-i*e,r=4*Math.PI*i,o=n*Math.sin(r);this._view.x=o},e.prototype._reset_anim_properties=function(){},e}(GameActor2DVisualComponentAnimation);window.Anim_Vibration=i,__reflect(i.prototype,"Anim_Vibration",[])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.update=function(t){},e.prototype.receive_damage=function(t){var e=this.actor().md;if(e.health<t)return void GameCore.core.destroy_actor(this._actor);this.actor().character_mesh.cached_anim("vibration").start(),e.health-=t;var i=e.health/e.max_health;0>i&&(i=0),this.mesh().health.update_prog(i)},e}(GameActor2DComponent);window.DamageComponent=i,__reflect(i.prototype,"DamageComponent",[])},function(t,e){var i=function(t){function e(e){var i=t.call(this,e)||this;return i._is_right=!0,i.health=new CharacterHealthView(!1,-90),i.addChild(i.health),i._init_cached_anim("enemy_enter",ANIM_EnemyEnter),i._init_cached_anim("attack_move",Anim_Attack_Move),i._init_cached_anim("vibration",Anim_Vibration),i}return __extends(e,t),e.prototype.set_side=function(t){this._is_right=t,this._mesh.scaleX=this._is_right?1:-1},e}(SkeletalMeshContent);window.CharacterDisplay=i,__reflect(i.prototype,"CharacterDisplay",[])},function(t,e){var i=function(t){function e(e,i){var n=t.call(this)||this;n._is_boss_view=e;var r=null,o=null;e?(n.x=-50,n.y=i-25,r="Common_Pic_Battle_BloodStrip_01_png",o="Common_Pic_Battle_BloodStrip_02_png"):(n.x=-25,n.y=i-8,r="Battle_SmallBloodStick_01_png",o="Battle_SmallBloodStick_02_png");var a=RES.getRes(o),_=new egret.Bitmap(a);n.addChild(_);var s=new egret.Bitmap(RES.getRes(r));return n.addChild(s),n.raw_width=s.width,n.front=s,s.fillMode=egret.BitmapFillMode.CLIP,n}return __extends(e,t),e.prototype.update_y=function(t){this._is_boss_view?this.y=t-25:this.y=t-8},e.prototype.update_prog=function(t){this.front.width=this.raw_width*t,this.visible=!0},e}(egret.DisplayObjectContainer);window.CharacterHealthView=i,__reflect(i.prototype,"CharacterHealthView",[])},function(t,e){var i;!function(t){t[t.attack1=1]="attack1",t[t.attack2=2]="attack2",t[t.idle=3]="idle",t[t.walking=4]="walking"}(i||(i={})),window.CharacterSMState=i;var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destructor=function(){this._destroy_component("_s_attack1"),this._destroy_component("_s_attack2"),this._destroy_component("_s_idle"),this._destroy_component("_s_walking"),t.prototype.destructor.call(this)},e.prototype._states_init=function(t){this._s_attack1=new CharacterSMAttack1,this._s_attack1.state_init(this,t),this._s_attack2=new CharacterSMAttack2,this._s_attack2.state_init(this,t),this._s_idle=new CharacterSMIdle,this._s_idle.state_init(this,t),this._s_walking=new CharacterSMWalking,this._s_walking.state_init(this,t)},e.prototype.get_state_by_enum=function(t){return t===i.attack1?this._s_attack1:t===i.attack2?this._s_attack2:t===i.idle?this._s_idle:t===i.walking?this._s_walking:null},e}(ns_sirius.GP_StateMachine);window.CharacterSM=n,__reflect(n.prototype,"CharacterSM",[])},function(t,e){var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._convert_context=function(t){this._character=t},e}(ns_sirius.GP_StateBase);window.CharacterSMStateBase=i,__reflect(i.prototype,"CharacterSMStateBase",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e._from_pos=new egret.Point(0,0),e._to_pos=new egret.Point(0,0),e}return __extends(e,t),e.prototype.state_enum=function(){return CharacterSMState.attack1},e.prototype.state_str=function(){return"Attack1"},e.prototype.state_enter=function(t,e){if(void 0===e&&(e=null),AppG.appm._debug_attacking=!0,!e)throw new Error("I need a target!");var i=e,n=i.character_mesh.localToGlobal(0,0),r=this._character.character_mesh.globalToLocal(n.x,n.y);this._to_pos.y=r.y,this._character.role===ActorRoles.Friend?this._to_pos.x=r.x-50:this._to_pos.x=r.x+50,this._phase_1_forward(e)},e.prototype._phase_1_forward=function(t){var e=this;this._character.character_mesh.cached_anim("attack_move").ANIM_RESET(this._from_pos,this._to_pos).start(function(){e._phase_2_attack(t)})},e.prototype._phase_2_attack=function(t){var e=this;this._character.character_mesh.play_anim_once("attack_1",function(t){e._machine.state_change(CharacterSMState.idle),e._phase_3_back()},function(i){t.damage.receive_damage(e._character.md.attack)})},e.prototype._phase_3_back=function(){this._character.character_mesh.cached_anim("attack_move").ANIM_RESET(this._to_pos,this._from_pos).start(function(){AppG.appm._debug_attacking=!1})},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e.prototype.state_update=function(t){},e}(CharacterSMStateBase);window.CharacterSMAttack1=i,__reflect(i.prototype,"CharacterSMAttack1",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e._from_pos=new egret.Point(0,0),e._to_pos=new egret.Point(0,0),e}return __extends(e,t),e.prototype.state_enum=function(){return CharacterSMState.attack2},e.prototype.state_str=function(){return"Attack2"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),AppG.appm._debug_attacking=!0;var i=new egret.Point(.5*GameGlobalConfig.SW,GameGlobalConfig.PERFORM_POS_Y),n=this._character.character_mesh.globalToLocal(i.x,i.y);this._to_pos.y=n.y,this._to_pos.x=n.x,this._phase_1_forward()},e.prototype._phase_1_forward=function(){var t=this;this._character.character_mesh.cached_anim("attack_move").ANIM_RESET(this._from_pos,this._to_pos).start(function(){t._phase_2_attack()}),GameCore.core.core_view.light_to_dark()},e.prototype._phase_2_attack=function(){var t=this;AppG.appm.art_factory.clock.timeScale=.5,this._character.character_mesh.play_anim_once("attack_2",function(e){t._machine.state_change(CharacterSMState.idle),t._phase_3_back()},function(e){t._character.role===ActorRoles.Enemy?GameCore.core.m_characters.left_characters.forEach(function(e){e.damage.receive_damage(2*t._character.md.attack)}):t._character.role===ActorRoles.Friend&&GameCore.core.m_characters.right_characters.forEach(function(e){e.damage.receive_damage(2*t._character.md.attack)})})},e.prototype._phase_3_back=function(){AppG.appm.art_factory.clock.timeScale=1.5,this._character.character_mesh.cached_anim("attack_move").ANIM_RESET(this._to_pos,this._from_pos).start(function(){AppG.appm._debug_attacking=!1}),GameCore.core.core_view.dark_to_light()},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e.prototype.state_update=function(t){},e}(CharacterSMStateBase);window.CharacterSMAttack2=i,__reflect(i.prototype,"CharacterSMAttack2",[])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.state_enum=function(){return CharacterSMState.idle},e.prototype.state_str=function(){return"Idle"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._character.skeletal_mesh.play_anim_loop("standby")},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e.prototype.state_update=function(t){},e}(CharacterSMStateBase);window.CharacterSMIdle=i,__reflect(i.prototype,"CharacterSMIdle",[])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.state_enum=function(){return CharacterSMState.walking},e.prototype.state_str=function(){return"Walking"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._character.skeletal_mesh.play_anim_loop("run")},e.prototype.state_leave=function(t,e){void 0===e&&(e=null)},e.prototype.state_update=function(t){},e}(CharacterSMStateBase);window.CharacterSMWalking=i,__reflect(i.prototype,"CharacterSMWalking",[])},function(t,e){var i=function(){function t(){this.attack=1,this.interval=Math.round(ns_sirius_math.random_region(1e3,3e3)),this.health=this.max_health=Math.round(ns_sirius_math.random_region(100,200))}return t.friend_template=function(){var e=new t;return e.interval=Math.round(ns_sirius_math.random_region(1e3,3e3)),e.health=e.max_health=Math.round(ns_sirius_math.random_region(500,1e3)),e.attack=60,e},t.enemy_template=function(){var e=new t;return e.interval=Math.round(ns_sirius_math.random_region(1e3,3e3)),e.health=e.max_health=Math.round(ns_sirius_math.random_region(100,120)),e.attack=15,e},t.boss_template=function(){var e=new t;return e.interval=Math.round(ns_sirius_math.random_region(1e3,3e3)),e.health=e.max_health=Math.round(ns_sirius_math.random_region(300,350)),e.attack=30,e},t}();window.CharacterMetadata=i,__reflect(i.prototype,"CharacterMetadata",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e.row_index=-1,e.column_index=-1,e}return __extends(e,t),e.prototype.destructor=function(){t.prototype.destructor.call(this)},e}(GroupActor);window.StaticSlotActor=i,__reflect(i.prototype,"StaticSlotActor",[])},function(t,e){var i=function(){function t(){}return t.CONFIG_INIT=function(){this.CROWD_WIDTH=this.COLUMN_COUNT*(this.SLOT_WIDTH+this.SLOT_GAP_HORIZONTAL)-this.SLOT_GAP_HORIZONTAL,this.CROWD_HEIGHT=this.ROW_COUNT*(this.SLOT_HEIGHT+this.SLOT_GAP_VERTICAL)-this.SLOT_GAP_VERTICAL,this.SLOT_ORIGIN_Y=this.SH-this.CROWD_HEIGHT-80,this.PERFORM_POS_Y=this.SLOT_ORIGIN_Y+Math.round(2*this.SLOT_HEIGHT)},t.SW=1136,t.SH=640,t.ROW_COUNT=3,t.COLUMN_COUNT=2,t.SLOT_WIDTH=80,t.SLOT_HEIGHT=70,t.SLOT_GAP_HORIZONTAL=100,t.SLOT_GAP_VERTICAL=10,t.SLOT_ORIGIN_X_FROM_CENTER=90,t}();window.GameGlobalConfig=i,__reflect(i.prototype,"GameGlobalConfig",[])},function(t,e){var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"core_view",{get:function(){return this._core_view},enumerable:!1,configurable:!0}),e.prototype.destructor=function(){this._destroy_component("pulse"),this._destroy_component("machine"),this._destroy_component("root"),this._destroy_component("m_slots"),this._destroy_component("m_characters"),this._core_view&&(this._core_view.parent.removeChild(this._core_view),this._core_view=null),t.prototype.destructor.call(this)},e.prototype.core_init=function(t){this._core_view=t,egret.Ticker.getInstance().register(function(t){ns_sirius.world_clock.update(t),ns_sirius.timer_clock.update(t),ns_sirius.pulse_clock.update(t)},this),this.pulse=new GamePlayPulse(this),this.machine=new GameCoreMachine,this.machine.machine_initialize(this,this,null),this.root=new GameCoreRootActor,this._core_view.attach_game_root_view(this.root.display),this.root.display.x=0,this.root.display.y=0,this.root.display.width=GameGlobalConfig.SW,this.root.display.height=GameGlobalConfig.SH,this.m_slots=new GCM_SlotManager,this.m_characters=new GCM_Characters
},e.prototype.game_pulse=function(t){this.machine.machine_update(t),this._core_view.update(t),this.root.update(t)},e.prototype.start_game=function(){this.m_slots.manager_init(this),this.m_characters.manager_init(this),this.pulse.start_pulse(),this.machine.state_change(GameCoreMachineState.walking)},e.prototype.sm_state_changed=function(t,e,i){},e.prototype.spawn_actor=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=new t(e);return i?i.attachChild(n):this.root.attachChild(n),n},e.prototype.destroy_actor=function(t){t.detach_from_parent().destroy()},Object.defineProperty(e,"core",{get:function(){return this._shared_instance},enumerable:!1,configurable:!0}),e.STATIC_INIT=function(){var t=new e;return e._shared_instance=t,t},e.filter_by_role=function(t,e,i){var n=this;t.role===i&&e.push(t),t.children&&0!==t.children.length&&t.children.loop_element(function(t){n.filter_by_role(t,e,i)})},e}(ns_sirius.sirius_base_object);window.GameCore=i,__reflect(i.prototype,"GameCore",["IGamePlayPulseListener","ns_sirius.IGP_StateMachineListener"])},function(t,e){var i;!function(t){t[t.Default=0]="Default",t[t.Friend=1]="Friend",t[t.Enemy=2]="Enemy"}(i||(i={})),window.ActorRoles=i},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._init_components=function(){t.prototype._init_components.call(this),this._display.hide_solid_bg()},e}(GroupActor);window.GameCoreRootActor=i,__reflect(i.prototype,"GameCoreRootActor",[])},function(t,e){var i;!function(t){t[t.battle=1]="battle",t[t.walking=2]="walking"}(i||(i={})),window.GameCoreMachineState=i;var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._states_init=function(t){this._s_battle=new GameCoreMachineBattle,this._s_battle.state_init(this,t),this._s_walking=new GameCoreMachineWalking,this._s_walking.state_init(this,t)},e.prototype.get_state_by_enum=function(t){return t===i.battle?this._s_battle:t===i.walking?this._s_walking:null},e}(ns_sirius.GP_StateMachine);window.GameCoreMachine=n,__reflect(n.prototype,"GameCoreMachine",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e._wave_count=1,e}return __extends(e,t),e.prototype._convert_context=function(t){this._gc=t},e.prototype.state_enum=function(){return GameCoreMachineState.battle},e.prototype.state_str=function(){return"Battle"},e.prototype.state_enter=function(t,e){void 0===e&&(e=null),this._elapsed=0,this._round_time_min=100,this._left_round=!0;var i=this._gc.m_characters.left_characters;i&&0!==i.length&&i.forEach(function(t){t.machine.state_change(CharacterSMState.idle)})},e.prototype.state_leave=function(t,e){void 0===e&&(e=null),this._wave_count++,this._gc.core_view._wave_lbl.text=this._wave_count+""},e.prototype.state_update=function(t){if(this._elapsed+=t,this._elapsed>=this._round_time_min){if(AppG.appm._debug_attacking)return;if(this._judge_win_lose(this._gc.m_characters.left_characters.length,this._gc.m_characters.right_characters.length))return;this._left_round?this._execute_attack(this._gc.m_characters.left_characters,this._gc.m_characters.right_characters):this._execute_attack(this._gc.m_characters.right_characters,this._gc.m_characters.left_characters),this._elapsed=0,this._left_round=!this._left_round}},e.prototype._judge_win_lose=function(t,e){var i=!1;return 0===t?(i=!0,this._gc.core_view.show_lose_view(),GameCore.core.pulse.stop_pulse()):0===e&&(i=!0,this._machine.state_change(GameCoreMachineState.walking)),i},e.prototype._execute_attack=function(t,e){var i=t.length,n=e.length,r=ns_sirius_math.random_int_bounded(0,i-1),o=ns_sirius_math.random_int_bounded(0,n-1),a=t[r],_=e[o],s=ns_sirius_math.random_int_bounded(0,1e3);800>s?a.attack_1(_):a.attack_2(_)},e}(ns_sirius.GP_StateBase);window.GameCoreMachineBattle=i,__reflect(i.prototype,"GameCoreMachineBattle",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e._spawn_cursor=0,e}return __extends(e,t),e.prototype._convert_context=function(t){this._gc=t},e.prototype.state_enum=function(){return GameCoreMachineState.walking},e.prototype.state_str=function(){return"Walking"},e.prototype.state_enter=function(t,i){var n=this;void 0===i&&(i=null),this._elapsed=0,this._gc.core_view.bg.walk_start();var r=this._gc.m_characters.left_characters;r&&0!==r.length&&(r.forEach(function(t){t.machine.state_change(CharacterSMState.walking)}),this._spawn_cursor++,setTimeout(function(){var t=n._spawn_cursor%4===0;n._gc.m_characters.spawn_enemies(t)},e.only_walking_time))},e.prototype.state_leave=function(t,e){void 0===e&&(e=null),this._gc.core_view.bg.walk_end()},e.prototype.state_update=function(t){this._elapsed+=t,this._elapsed>=ANIM_EnemyEnter.duration+e.only_walking_time+10&&this._machine.state_change(GameCoreMachineState.battle,null)},e.only_walking_time=1e3,e}(ns_sirius.GP_StateBase);window.GameCoreMachineWalking=i,__reflect(i.prototype,"GameCoreMachineWalking",[])},function(t,e){var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.destructor=function(){this._gc=null,t.prototype.destructor.call(this)},e.prototype.manager_init=function(t){this._gc=t,this._init()},e}(ns_sirius.sirius_base_object);window.GCM_Base=i,__reflect(i.prototype,"GCM_Base",[])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"left_characters",{get:function(){var t=new Array;return GameCore.filter_by_role(this._gc.root,t,ActorRoles.Friend),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right_characters",{get:function(){var t=new Array;return GameCore.filter_by_role(this._gc.root,t,ActorRoles.Enemy),t},enumerable:!1,configurable:!0}),e.prototype.destructor=function(){t.prototype.destructor.call(this)},e.prototype._init=function(){for(var t=0;3>t;t++){var e="C50710",i=2*t+1,n=GameCore.core.m_slots.left_slots[i],r=CharacterMetadata.friend_template(),o=GameCore.core.spawn_actor(CharacterActor,r,n);o.role=ActorRoles.Friend,o.bind_res(AppG.debug_res_list[e]),o.display.x=Math.round(.5*GameGlobalConfig.SLOT_WIDTH),o.display.y=Math.round(.9*GameGlobalConfig.SLOT_HEIGHT),o.character_mesh.set_side(!1)}},e.prototype.spawn_enemies=function(t){for(var e=function(e){var i="C50810",n=CharacterMetadata.enemy_template();t&&2===e&&(i="C51910",n=CharacterMetadata.boss_template());var r=e,o=GameCore.core.m_slots.right_slots[r],a=GameCore.core.spawn_actor(CharacterActor,n,o);a.role=ActorRoles.Enemy,a.bind_res(AppG.debug_res_list[i]),a.display.x=Math.round(.5*GameGlobalConfig.SLOT_WIDTH),a.display.y=Math.round(.9*GameGlobalConfig.SLOT_HEIGHT),a.character_mesh.set_side(!0),a.machine.state_change(CharacterSMState.walking),a.character_mesh.cached_anim("enemy_enter").start(function(){a.machine.state_change(CharacterSMState.idle)})},i=0;6>i;i++)e(i)},e}(GCM_Base);window.GCM_Characters=i,__reflect(i.prototype,"GCM_Characters",[])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"left_slots",{get:function(){return this._left_slots},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right_slots",{get:function(){return this._right_slots},enumerable:!1,configurable:!0}),e.prototype.destructor=function(){this._left_slots=null,this._right_slots=null,t.prototype.destructor.call(this)},e.prototype._init=function(){var t=Math.round(.5*GameGlobalConfig.SW-GameGlobalConfig.CROWD_WIDTH-GameGlobalConfig.SLOT_ORIGIN_X_FROM_CENTER),e=GameGlobalConfig.SLOT_ORIGIN_Y;this._left_slots=new Array;for(var i=0;i<GameGlobalConfig.ROW_COUNT;i++)for(var n=0;n<GameGlobalConfig.COLUMN_COUNT;n++){var r=GameCore.core.spawn_actor(StaticSlotActor);this._left_slots.push(r),r.row_index=i,r.column_index=n;var o=n*(GameGlobalConfig.SLOT_WIDTH+GameGlobalConfig.SLOT_GAP_HORIZONTAL),a=i*(GameGlobalConfig.SLOT_HEIGHT+GameGlobalConfig.SLOT_GAP_VERTICAL);r.display.x=t+o,r.display.y=e+a,r.display.width=GameGlobalConfig.SLOT_WIDTH,r.display.height=GameGlobalConfig.SLOT_HEIGHT}var _=Math.round(.5*GameGlobalConfig.SW+GameGlobalConfig.SLOT_ORIGIN_X_FROM_CENTER),s=GameGlobalConfig.SLOT_ORIGIN_Y;this._right_slots=new Array;for(var i=0;i<GameGlobalConfig.ROW_COUNT;i++)for(var n=0;n<GameGlobalConfig.COLUMN_COUNT;n++){var r=GameCore.core.spawn_actor(StaticSlotActor);this._right_slots.push(r),r.row_index=i,r.column_index=n;var o=n*(GameGlobalConfig.SLOT_WIDTH+GameGlobalConfig.SLOT_GAP_HORIZONTAL),a=i*(GameGlobalConfig.SLOT_HEIGHT+GameGlobalConfig.SLOT_GAP_VERTICAL);r.display.x=_+o,r.display.y=s+a,r.display.width=GameGlobalConfig.SLOT_WIDTH,r.display.height=GameGlobalConfig.SLOT_HEIGHT}},e}(GCM_Base);window.GCM_SlotManager=i,__reflect(i.prototype,"GCM_SlotManager",[])},function(t,e){var i=function(t){function e(e){var i=t.call(this)||this;return i._lis=e,i}return __extends(e,t),e.prototype.update=function(t){this._lis.game_pulse(t)},e.prototype._before_destroy=function(){this._lis=null,ns_sirius.pulse_clock.remove_listener(this)},e.prototype.start_pulse=function(){ns_sirius.pulse_clock.register_listener(this)},e.prototype.stop_pulse=function(){ns_sirius.pulse_clock.remove_listener(this)},e}(ns_sirius.sirius_base_object);window.GamePlayPulse=i,__reflect(i.prototype,"GamePlayPulse",["ns_sirius.Ipulse_clock_listener"])},function(t,e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ANIM_RESET=function(t,e){return this._from=t,this._to=e,this},e.prototype.animation_duration=function(){return Anim_Attack_Move.duration},e.prototype._reset_anim_properties=function(){},e.prototype._after_start=function(){this.target_view()&&(this.target_view().alpha=this._from)},e.prototype._before_stop=function(){this.target_view()&&(this.target_view().alpha=this._to)},e.prototype._anim_update=function(t){if(this.target_view()){var e=t,i=this._from+(this._to-this._from)*e;this.target_view()&&(this.target_view().alpha=i)}},e.duration=200,e}(ns_sirius.single_animation);window.Anim_Mask_Fade=i,__reflect(i.prototype,"Anim_Mask_Fade",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;return e.x=0,e.y=0,e.width=GameGlobalConfig.SW,e.height=GameGlobalConfig.SH,e._sky=new SkyBGView,e.addChild(e._sky),e._sky.width=GameGlobalConfig.SW,e._sky.height=GameGlobalConfig.SH,e._bg=new GameBGView,e.addChild(e._bg),e._bg.width=GameGlobalConfig.SW,e._bg.height=GameGlobalConfig.SH,e._wave_lbl=new eui.Label,e.addChild(e._wave_lbl),e._wave_lbl.text="1",e._wave_lbl.x=10,e._wave_lbl.y=10,e._wave_lbl.size=12,e._wave_lbl.textColor=16711680,e._mask_view=new eui.Rect,e.addChild(e._mask_view),e._mask_view.percentWidth=100,e._mask_view.percentHeight=100,e._mask_view.alpha=0,e._mask_view.fillColor=0,e._anim_mask=new Anim_Mask_Fade(null,e._mask_view),e._anim_mask.init(),e._lose_view=new LoseView,e.addChild(e._lose_view),e._lose_view.width=GameGlobalConfig.SW,e._lose_view.height=GameGlobalConfig.SH,e._lose_view.visible=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"bg",{get:function(){return this._bg},enumerable:!1,configurable:!0}),e.prototype.show_lose_view=function(){this._lose_view.visible=!0},e.prototype.update=function(t){this._bg.update(t),this._sky.update(t)},e.prototype.dark_to_light=function(){this._anim_mask.ANIM_RESET(.6,0).start()},e.prototype.light_to_dark=function(){this._anim_mask.ANIM_RESET(0,.6).start()},e.prototype.attach_game_root_view=function(t){var e=this.getChildIndex(this._lose_view);this.addChildAt(t,e)},e}(eui.Group);window.GameCoreView=i,__reflect(i.prototype,"GameCoreView",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this,i=200,n=100;return e._mask_view=new eui.Rect,e.addChild(e._mask_view),e._mask_view.percentWidth=100,e._mask_view.percentHeight=100,e._mask_view.alpha=.8,e._mask_view.fillColor=0,e._lose_lbl=new eui.Label,e.addChild(e._lose_lbl),e._lose_lbl.text="Lose",e._lose_lbl.size=50,e._lose_lbl.textColor=16711680,e._lose_lbl.width=i,e._lose_lbl.height=n,e._lose_lbl.horizontalCenter=0,e._lose_lbl.verticalCenter=-20,e._lose_lbl.textAlign="center",e._lose_lbl.verticalAlign="middle",e._retry=new eui.Button,e.addChild(e._retry),e._retry.label="Restart",e._retry.horizontalCenter=0,e._retry.verticalCenter=100,e._retry.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.location.reload()},e),e}return __extends(e,t),e}(eui.Group);window.LoseView=i,__reflect(i.prototype,"LoseView",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;e._speed=4,e._dead_zone=20;var i=1400,n=200;return e._bgh=.7*GameGlobalConfig.SH,e._bgw=Math.round(i*e._bgh/n),e._bg_1=e._generate_bg("ground_bg_png"),e._bg_2=e._generate_bg("ground_bg_png"),e._cur=e._bg_1,e._next=e._bg_2,e.reset_layout(),e._is_walking=!1,e}return __extends(e,t),e.prototype._generate_bg=function(t){var e=this.createBitmapByName(t);return this.addChild(e),e.width=this._bgw,e.height=this._bgh,e.y=GameGlobalConfig.SH-e.height,e},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.reset_layout=function(){this._cur.x=0,this._next.x=this._bgw},e.prototype.walk_start=function(){this._is_walking=!0},e.prototype.walk_end=function(){this._is_walking=!1},e.prototype.update=function(t){if(this._is_walking){this._cur.x-=this._speed,this._next.x-=this._speed;var e=-this._bgw+GameGlobalConfig.SW+this._dead_zone;if(this._next.x<=e){this._next.x=e;var i=this._cur;this._cur=this._next,this._next=i,this._next.x=GameGlobalConfig.SW+this._dead_zone}}},e}(eui.Group);window.GameBGView=i,__reflect(i.prototype,"GameBGView",[])},function(t,e){var i=function(t){function e(){var e=t.call(this)||this;e._speed=.3,e._dead_zone=20;var i=1440,n=226;return e._bgh=.5*GameGlobalConfig.SH,e._bgw=Math.round(i*e._bgh/n),e._bg_1=e._generate_bg("sky_png"),e._bg_2=e._generate_bg("sky_png"),e._cur=e._bg_1,e._next=e._bg_2,e.reset_layout(),e._is_walking=!1,setTimeout(function(){e.walk_start()},500),e}return __extends(e,t),e.prototype._generate_bg=function(t){var e=this.createBitmapByName(t);return this.addChild(e),e.width=this._bgw,e.height=this._bgh,e},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.reset_layout=function(){this._cur.x=0,this._next.x=this._bgw},e.prototype.walk_start=function(){this._is_walking=!0},e.prototype.walk_end=function(){this._is_walking=!1},e.prototype.update=function(t){if(this._is_walking){this._cur.x-=this._speed,this._next.x-=this._speed;var e=-this._bgw+GameGlobalConfig.SW+this._dead_zone;if(this._next.x<=e){this._next.x=e;var i=this._cur;this._cur=this._next,this._next=i,this._next.x=GameGlobalConfig.SW+this._dead_zone}}},e}(eui.Group);window.SkyBGView=i,__reflect(i.prototype,"SkyBGView",[])},function(t,e){var i=function(){function t(){}return t.GlobalInit=function(){this.appm=new AppModel,this.sirius=new ns_sirius.SiriusPublic},t.DEBUG_INIT_RES_LIST=function(){var t=new db_res_entity;t.res_init("C50710"),t.set_all_ready_immediately();var e=new db_res_entity;e.res_init("C50810"),e.set_all_ready_immediately();var i=new db_res_entity;i.res_init("C51910"),i.set_all_ready_immediately(),this.debug_res_list={},this.debug_res_list.C50710=t,this.debug_res_list.C50810=e,this.debug_res_list.C51910=i},t}();window.AppG=i,__reflect(i.prototype,"AppG",[])},function(t,e){var i=function(){function t(){this._debug_attacking=!1,this._factory=new dragonBones.EgretFactory,this._factory.clock.timeScale=1.5}return Object.defineProperty(t.prototype,"art_factory",{get:function(){return this._factory},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this._factory&&(this._factory.clear(!0),this._factory=null)},t}();window.AppModel=i,__reflect(i.prototype,"AppModel",[])},function(t,e){},function(t,e){var i,i=window.ns_sirius_math;!function(t){function e(t,e,i,n){var r=t-i,o=e-n;return Math.sqrt(r*r+o*o)}t.points_distance=e}(i||(i={})),window.ns_sirius_math=i},function(t,e){var i,i=window.ns_sirius_math;!function(t){function e(t){return t=(9301*t+49297)%233280,t/233280}function i(t,i){var n=(t+1)*(i+1),r=Math.ceil(1e4*e(n))/1e4;return r}function n(t,e){return t+(e-t)*Math.random()}function r(t,e){return Math.floor(t+(e-t+1)*Math.random())}t.fiexed_random=i,t.random_region=n,t.random_int_bounded=r}(i||(i={})),window.ns_sirius_math=i}]);